var qs=Object.defineProperty;var zs=(n,e,t)=>e in n?qs(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var B=(n,e,t)=>zs(n,typeof e!="symbol"?e+"":e,t);var Bs=require("siyuan");var In="asri-enhance-",Rn=["amber","sakura","wilderness","midnight","salt","rosepine","topaz","oxygen","shade","gruvbox","glitch","nostalgia"];async function k(n,e,t){if(!n.saveData)throw new Error("Plugin saveData method is not available");try{await n.saveData(e,t)}catch(a){throw a}}async function p(n,e){if(!n.loadData)return null;try{return await n.loadData(e)||null}catch(t){return null}}async function $r(n,e,t="config.json"){let a=document.documentElement;if(!a)return;let r=a.getAttribute("data-theme-mode")||"light";a.getAttribute("data-asri-palette")===e&&a.removeAttribute("data-asri-palette");let o=await p(n,t);if(!o)return;let i=`${In}${e}`,s=o[i];s!==void 0&&(typeof s=="boolean"?delete o[i]:s&&typeof s=="object"&&(s[r]=!1,o[i]=s),await k(n,t,o))}async function Fr(n,e="config.json"){let t=await p(n,e);if(!t)return;let a=!1;Object.keys(t).forEach(r=>{r.startsWith(In)&&(delete t[r],a=!0)}),a&&await k(n,e,t)}async function Or(n,e="config.json"){let t=document.documentElement;if(!t)return;let a=t.getAttribute("data-theme-mode")||"light",r=await p(n,e);if(!r)return;let o=!1;Rn.forEach(i=>{let s=`${In}${i}`,l=r[s];l!==void 0&&(typeof l=="boolean"?(delete r[s],o=!0):l&&typeof l=="object"&&l[a]===!0&&(l[a]=!1,r[s]=l,o=!0))}),o&&await k(n,e,r)}var ft="config.json",qe="asri-enhance-follow-time",Nn="asri-enhance-follow-time-base-color",ve="data-asri-enhance-follow-time",Dr="data-asri-enhance-follow-time-base-color";async function Br(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t||t.hasAttribute(ve))return;let r=t.getAttribute("data-theme-mode")||"light",o=await p(n,ft)||{},i=o[qe]||{light:!1,dark:!1},s=()=>{t.setAttribute(ve,"true"),t.removeAttribute("data-asri-palette"),i[r]=!0,o[qe]=i};document.startViewTransition?await document.startViewTransition(()=>{s()}).finished.catch(()=>{}):s(),await k(n,ft,o).catch(()=>{})}async function qr(n,e){let t=document.documentElement;if(!t)return;let a=t.getAttribute("data-theme-mode")||"light",r=e!==void 0?e:await p(n,ft);if(r&&r[qe]){let o=r[qe];(typeof o=="boolean"?o:o[a]===!0)?(t.setAttribute(ve,"true"),t.removeAttribute("data-asri-palette")):t.removeAttribute(ve)}else t.removeAttribute(ve);if(r&&r[Nn]){let o=r[Nn];t.style.setProperty("--asri-enhance-follow-time-base-color",o),t.setAttribute(Dr,o)}}async function gt(n,e="config.json"){let t=document.documentElement;t&&t.removeAttribute(ve);let a=await p(n,e);a&&a[qe]!==void 0&&(delete a[qe],await k(n,e,a))}async function zr(n,e){let t=await p(n,ft)||{};t[Nn]=e,await k(n,ft,t);let a=document.documentElement;a&&(a.style.setProperty("--asri-enhance-follow-time-base-color",e),a.setAttribute(Dr,e),a.hasAttribute(ve)&&(a.removeAttribute(ve),a.offsetWidth,a.setAttribute(ve,"true")))}var en="config.json";async function K(n,e,t){let a=document.documentElement;if(!a)return;let r=a.getAttribute("data-theme-mode")||"light";if(a.getAttribute("data-asri-palette")===e.name)return;let i=await p(n,en)||{},s=i[e.configKey]||{light:!1,dark:!1},l=()=>{a.removeAttribute("data-asri-palette"),a.setAttribute("data-asri-palette",e.name),s[r]=!0;for(let c of e.otherConfigKeys)if(i[c]){let m=i[c];typeof m=="object"&&(m[r]=!1,i[c]=m)}if(i[e.configKey]=s,i["asri-enhance-follow-time"]){let c=i["asri-enhance-follow-time"];typeof c=="object"&&(c[r]=!1,i["asri-enhance-follow-time"]=c),a.removeAttribute("data-asri-enhance-follow-time"),gt(n,en).catch(()=>{})}};document.startViewTransition?await document.startViewTransition(()=>{l()}).finished.catch(()=>{}):l(),await k(n,en,i).catch(()=>{})}async function j(n,e,t){let a=document.documentElement;if(!a)return;let r=a.getAttribute("data-theme-mode")||"light",o=t!==void 0?t:await p(n,en);if(o&&o[e.configKey]){let i=o[e.configKey];(typeof i=="boolean"?i:i[r]===!0)?(a.removeAttribute("data-asri-palette"),a.setAttribute("data-asri-palette",e.name),a.removeAttribute("data-asri-enhance-follow-time")):a.getAttribute("data-asri-palette")===e.name&&a.removeAttribute("data-asri-palette")}}var Gr={name:"amber",configKey:"asri-enhance-amber",otherConfigKeys:["asri-enhance-sakura","asri-enhance-wilderness","asri-enhance-midnight","asri-enhance-salt","asri-enhance-rosepine","asri-enhance-topaz","asri-enhance-oxygen","asri-enhance-shade","asri-enhance-gruvbox","asri-enhance-glitch","asri-enhance-nostalgia"]};async function Kr(n,e){return K(n,Gr,e)}async function jr(n,e){return j(n,Gr,e)}var Vr={name:"sakura",configKey:"asri-enhance-sakura",otherConfigKeys:["asri-enhance-amber","asri-enhance-wilderness","asri-enhance-midnight","asri-enhance-salt","asri-enhance-rosepine","asri-enhance-topaz","asri-enhance-oxygen","asri-enhance-shade","asri-enhance-gruvbox","asri-enhance-glitch","asri-enhance-nostalgia"]};async function Wr(n,e){return K(n,Vr,e)}async function Yr(n,e){return j(n,Vr,e)}var Ur={name:"wilderness",configKey:"asri-enhance-wilderness",otherConfigKeys:["asri-enhance-sakura","asri-enhance-amber","asri-enhance-midnight","asri-enhance-salt","asri-enhance-rosepine","asri-enhance-topaz","asri-enhance-oxygen","asri-enhance-shade","asri-enhance-gruvbox","asri-enhance-glitch","asri-enhance-nostalgia"]};async function Xr(n,e){return K(n,Ur,e)}async function Zr(n,e){return j(n,Ur,e)}var Qr={name:"midnight",configKey:"asri-enhance-midnight",otherConfigKeys:["asri-enhance-sakura","asri-enhance-amber","asri-enhance-wilderness","asri-enhance-salt","asri-enhance-rosepine","asri-enhance-topaz","asri-enhance-oxygen","asri-enhance-shade","asri-enhance-gruvbox","asri-enhance-glitch","asri-enhance-nostalgia"]};async function Jr(n,e){return K(n,Qr,e)}async function eo(n,e){return j(n,Qr,e)}var to={name:"salt",configKey:"asri-enhance-salt",otherConfigKeys:["asri-enhance-sakura","asri-enhance-amber","asri-enhance-wilderness","asri-enhance-midnight","asri-enhance-rosepine","asri-enhance-topaz","asri-enhance-oxygen","asri-enhance-shade","asri-enhance-gruvbox","asri-enhance-glitch","asri-enhance-nostalgia"]};async function no(n,e){return K(n,to,e)}async function ao(n,e){return j(n,to,e)}var ro={name:"rosepine",configKey:"asri-enhance-rosepine",otherConfigKeys:["asri-enhance-sakura","asri-enhance-amber","asri-enhance-wilderness","asri-enhance-midnight","asri-enhance-salt","asri-enhance-topaz","asri-enhance-oxygen","asri-enhance-shade","asri-enhance-gruvbox","asri-enhance-glitch","asri-enhance-nostalgia"]};async function oo(n,e){return K(n,ro,e)}async function io(n,e){return j(n,ro,e)}var so={name:"topaz",configKey:"asri-enhance-topaz",otherConfigKeys:["asri-enhance-sakura","asri-enhance-amber","asri-enhance-wilderness","asri-enhance-midnight","asri-enhance-salt","asri-enhance-rosepine","asri-enhance-oxygen","asri-enhance-shade","asri-enhance-gruvbox","asri-enhance-glitch","asri-enhance-nostalgia"]};async function lo(n,e){return K(n,so,e)}async function co(n,e){return j(n,so,e)}var uo={name:"oxygen",configKey:"asri-enhance-oxygen",otherConfigKeys:["asri-enhance-sakura","asri-enhance-amber","asri-enhance-wilderness","asri-enhance-midnight","asri-enhance-salt","asri-enhance-rosepine","asri-enhance-topaz","asri-enhance-shade","asri-enhance-gruvbox","asri-enhance-glitch","asri-enhance-nostalgia"]};async function mo(n,e){return K(n,uo,e)}async function ho(n,e){return j(n,uo,e)}var po={name:"shade",configKey:"asri-enhance-shade",otherConfigKeys:["asri-enhance-sakura","asri-enhance-amber","asri-enhance-wilderness","asri-enhance-midnight","asri-enhance-salt","asri-enhance-rosepine","asri-enhance-topaz","asri-enhance-oxygen","asri-enhance-gruvbox","asri-enhance-glitch","asri-enhance-nostalgia"]};async function fo(n,e){return K(n,po,e)}async function go(n,e){return j(n,po,e)}var bo={name:"gruvbox",configKey:"asri-enhance-gruvbox",otherConfigKeys:["asri-enhance-sakura","asri-enhance-amber","asri-enhance-wilderness","asri-enhance-midnight","asri-enhance-salt","asri-enhance-rosepine","asri-enhance-topaz","asri-enhance-oxygen","asri-enhance-shade","asri-enhance-glitch","asri-enhance-nostalgia"]};async function yo(n,e){return K(n,bo,e)}async function vo(n,e){return j(n,bo,e)}var Eo={name:"glitch",configKey:"asri-enhance-glitch",otherConfigKeys:["asri-enhance-sakura","asri-enhance-amber","asri-enhance-wilderness","asri-enhance-midnight","asri-enhance-salt","asri-enhance-rosepine","asri-enhance-topaz","asri-enhance-oxygen","asri-enhance-shade","asri-enhance-gruvbox","asri-enhance-nostalgia"]};async function ko(n,e){return K(n,Eo,e)}async function wo(n,e){return j(n,Eo,e)}var Co={name:"nostalgia",configKey:"asri-enhance-nostalgia",otherConfigKeys:["asri-enhance-amber","asri-enhance-sakura","asri-enhance-wilderness","asri-enhance-midnight","asri-enhance-salt","asri-enhance-rosepine","asri-enhance-topaz","asri-enhance-oxygen","asri-enhance-shade","asri-enhance-gruvbox","asri-enhance-glitch"]};async function To(n,e){return K(n,Co,e)}async function xo(n,e){return j(n,Co,e)}var $n="config.json",Fn="asri-enhance-coloredheading";async function _o(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t)return;let a=t.hasAttribute("data-asri-enhance-coloredheading"),r=await p(n,$n)||{};a?(t.removeAttribute("data-asri-enhance-coloredheading"),r[Fn]=!1):(t.setAttribute("data-asri-enhance-coloredheading","true"),r[Fn]=!0),await k(n,$n,r).catch(()=>{})}async function Ao(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await p(n,$n);a&&a[Fn]===!0?t.setAttribute("data-asri-enhance-coloredheading","true"):t.removeAttribute("data-asri-enhance-coloredheading")}var On="config.json",Dn="asri-enhance-headinglevelhint",bt="data-asri-enhance-headinglevelhint";async function Lo(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t)return;let a=t.hasAttribute(bt),r=await p(n,On)||{};a?(t.removeAttribute(bt),r[Dn]=!1):(t.setAttribute(bt,"true"),r[Dn]=!0),await k(n,On,r).catch(()=>{})}async function Mo(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await p(n,On);a&&a[Dn]===!0?t.setAttribute(bt,"true"):t.removeAttribute(bt)}var Bn="config.json",qn="asri-enhance-colored-tree";async function Po(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t)return;let a=t.hasAttribute("data-asri-enhance-colored-tree"),r=await p(n,Bn)||{};a?(t.removeAttribute("data-asri-enhance-colored-tree"),r[qn]=!1):(t.setAttribute("data-asri-enhance-colored-tree","true"),r[qn]=!0),await k(n,Bn,r).catch(()=>{})}async function So(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await p(n,Bn);a&&a[qn]===!0?t.setAttribute("data-asri-enhance-colored-tree","true"):t.removeAttribute("data-asri-enhance-colored-tree")}var zn="config.json",Gn="asri-enhance-colored-list";async function Ho(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t)return;let a=t.hasAttribute("data-asri-enhance-colored-list"),r=await p(n,zn)||{};a?(t.removeAttribute("data-asri-enhance-colored-list"),r[Gn]=!1):(t.setAttribute("data-asri-enhance-colored-list","true"),r[Gn]=!0),await k(n,zn,r).catch(()=>{})}async function Io(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await p(n,zn);a&&a[Gn]===!0?t.setAttribute("data-asri-enhance-colored-list","true"):t.removeAttribute("data-asri-enhance-colored-list")}var jn="config.json",Vn="asri-enhance-listbulletline",Gs=".asri-enhance-bullet-highlight,.asri-enhance-bullet-line",Wn="asri-enhance-bullet-highlight",He="asri-enhance-bullet-line",ze="--asri-enhance-bullet-line-height",Ge=null,yt=null,me=null,tn=new Set,Ro=()=>{document.querySelectorAll(Gs).forEach(n=>{n.classList.remove(Wn,He),n.style.removeProperty(ze)}),tn.clear()},Ks=n=>{n.classList.remove(Wn,He),n.style.removeProperty(ze)},js=(n,e,t)=>{if(n.classList.add(Wn),e&&t){let a=n.getBoundingClientRect(),r=t.getBoundingClientRect();n.style.setProperty(ze,`${a.top-r.top}px`),n.classList.add(He)}},Kn=n=>{var r,o,i,s;let e=window.getSelection(),t=[];if(n){let l=n;for(;l;){let c=l;if(((r=c.dataset)==null?void 0:r.type)==="NodeListItem"&&t.push(c),(o=c.classList)!=null&&o.contains("protyle-wysiwyg"))break;l=c.parentElement}}else if(e&&e.rangeCount){let l=e.getRangeAt(0).startContainer;for(;l&&l.nodeType!==Node.ELEMENT_NODE;)l=l.parentElement;for(;l;){let c=l;if(((i=c.dataset)==null?void 0:i.type)==="NodeListItem"&&t.push(c),(s=c.classList)!=null&&s.contains("protyle-wysiwyg"))break;l=c.parentElement}}let a=new Set(t);tn.forEach(l=>{a.has(l)||Ks(l)}),t.forEach((l,c)=>{let m=c<t.length-1,b=m?t[c+1]:void 0;if(!tn.has(l))js(l,m,b);else if(m&&b){let d=l.getBoundingClientRect(),C=b.getBoundingClientRect(),g=`${d.top-C.top}px`;l.style.getPropertyValue(ze)!==g&&l.style.setProperty(ze,g),l.classList.contains(He)||l.classList.add(He)}else l.classList.contains(He)&&(l.classList.remove(He),l.style.removeProperty(ze))}),tn=a},No=()=>{Ge||(Ge=()=>{me&&clearTimeout(me),me=setTimeout(()=>{Kn(),me=null},50)},yt=n=>{var t;let e=n.composedPath()[0];(t=e.closest)!=null&&t.call(e,".protyle-action")&&(me&&clearTimeout(me),me=setTimeout(()=>{Kn(e),me=null},50))},document.addEventListener("selectionchange",Ge),document.addEventListener("click",yt,{capture:!0}),Kn())},Yn=()=>{if(!Ge){Ro();return}me&&(clearTimeout(me),me=null),document.removeEventListener("selectionchange",Ge),yt&&(document.removeEventListener("click",yt,{capture:!0}),yt=null),Ge=null,Ro()};async function $o(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t)return;let a=t.hasAttribute("data-asri-enhance-listbulletline"),r=await p(n,jn)||{};a?(t.removeAttribute("data-asri-enhance-listbulletline"),r[Vn]=!1,Yn()):(t.setAttribute("data-asri-enhance-listbulletline","true"),r[Vn]=!0,No()),await k(n,jn,r).catch(()=>{})}async function Fo(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await p(n,jn);a&&a[Vn]===!0?(t.setAttribute("data-asri-enhance-listbulletline","true"),No()):(t.removeAttribute("data-asri-enhance-listbulletline"),Yn())}var Oo=()=>{Yn()};var Ke=[],Do=window.fetch,nn=!1;function Vs(){if(nn)return;let n=Do,e=new Proxy(n,{apply(t,a,r){try{let[o,i]=r,s=o instanceof URL?o.href:String(o),l=null;try{if(i&&typeof i=="object"){let c=i.body;if(typeof c=="string")l=c;else if(c instanceof URLSearchParams)l=c.toString();else if(c&&typeof c=="object")try{l=JSON.stringify(c)}catch(m){l=null}}}catch(c){l=null}Ke.forEach(c=>{try{let m=c.pattern.test(s),b=l?c.pattern.test(l):!1;(m||b)&&queueMicrotask(()=>{try{c.callback(s,i)}catch(d){}})}catch(m){}})}catch(o){}return Reflect.apply(n,a,r)}});try{window.fetch=e,nn=!0}catch(t){}try{let t=XMLHttpRequest.prototype.open,a=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.open=function(r,o,i,s,l){try{this.__asri_intercept_url=o instanceof URL?o.href:String(o)}catch(c){}return t.apply(this,arguments)},XMLHttpRequest.prototype.send=function(r){try{let o=this.__asri_intercept_url||"",i=null;try{if(typeof r=="string")i=r;else if(r instanceof URLSearchParams)i=r.toString();else if(r&&typeof r=="object")try{i=JSON.stringify(r)}catch(s){i=null}}catch(s){i=null}(o||i)&&Ke.forEach(s=>{try{let l=o?s.pattern.test(o):!1,c=i?s.pattern.test(i):!1;(l||c)&&queueMicrotask(()=>{try{s.callback(o,r)}catch(m){}})}catch(l){}})}catch(o){}return a.apply(this,arguments)}}catch(t){}}function an(n,e){let a={pattern:n instanceof RegExp?n:new RegExp(String(n)),callback:e};return Ke.push(a),Vs(),{disconnect:()=>{let o=Ke.indexOf(a);if(o!==-1&&Ke.splice(o,1),Ke.length===0&&nn){try{window.fetch=Do}catch(i){}nn=!1}}}}var Un="config.json",Xn="asri-enhance-vertical-tab",sn=150,Go=null,on=!1,vt=!1,Bo=0,qo=0,xe=null,_e=null,fe=null,Te=null,Ee=null,rn=null,je=null;function Ws(n=10,e=100){return new Promise(t=>{let a=0,r=()=>{let o=document.querySelector(".layout__center");if(o){t(o);return}if(a++,a>=n){t(null);return}setTimeout(r,e)};r()})}function Ys(){let n=Ee!=null?Ee:document.documentElement,e=getComputedStyle(n).getPropertyValue("--asri-enhance-vertical-tab-width").trim();if(e){let t=parseFloat(e);return isNaN(t)?sn:t}return sn}function ln(n){(Ee!=null?Ee:document.documentElement).style.setProperty("--asri-enhance-vertical-tab-width",`${n}px`)}function Us(){ln(sn)}function Xs(){fe!==null&&(cancelAnimationFrame(fe),fe=null),Te=null,xe&&(document.removeEventListener("mousemove",xe),xe=null),_e&&(document.removeEventListener("mouseup",_e),_e=null),vt=!1}function Zs(n){let e=()=>n.previousElementSibling,t=()=>{let l=e();l&&l.classList.contains("fn__flex")&&l.classList.add("asri-enhance-verticaltab-resizing")},a=()=>{let l=e();l&&l.classList.contains("fn__flex")&&l.classList.remove("asri-enhance-verticaltab-resizing")},r=l=>{l.preventDefault(),l.stopPropagation(),vt=!0,Bo=l.clientX,qo=Ys(),document.body.style.userSelect="none",document.body.style.cursor="col-resize",t(),xe=c=>{if(!vt)return;c.preventDefault();let m=c.clientX-Bo;Te=Math.max(100,Math.min(300,qo+m)),fe!==null&&cancelAnimationFrame(fe),fe=requestAnimationFrame(()=>{Te!==null&&(ln(Te),Te=null),fe=null})},_e=()=>{vt&&(vt=!1,document.body.style.userSelect="",document.body.style.cursor="",a(),fe!==null&&(cancelAnimationFrame(fe),fe=null),Te!==null&&(ln(Te),Te=null),xe&&(document.removeEventListener("mousemove",xe),xe=null),_e&&(document.removeEventListener("mouseup",_e),_e=null))},document.addEventListener("mousemove",xe),document.addEventListener("mouseup",_e)},o=l=>{l.preventDefault(),l.stopPropagation(),Us()},i=n.__asriMousedownHandler,s=n.__asriDblclickHandler;i&&n.removeEventListener("mousedown",i),s&&n.removeEventListener("dblclick",s),n.__asriMousedownHandler=r,n.__asriDblclickHandler=o,n.addEventListener("mousedown",r),n.addEventListener("dblclick",o)}function zo(n){if(on)return;let e=n.querySelectorAll('[data-type="wnd"]');if(e.length===0)return;let t=null,a=1/0,r=1/0;if(e.forEach(o=>{let i=o.getBoundingClientRect(),s=i.top,l=i.left;(s<a||s===a&&l<r)&&(a=s,r=l,t=o)}),on=!0,e.forEach(o=>{if(o!==t){o.classList.remove("asri-enhance-verticaltab"),o.classList.remove("asri-enhance-verticaltab-toponly"),o.classList.remove("asri-enhance-verticaltab-dockr-expand-spacing");let i=o.querySelector(".layout__resize.layout__resize--lr.asri-enhance-verticaltab-resize");i&&i.remove()}}),t){!t.classList.contains("asri-enhance-verticaltab")&&t.classList.add("asri-enhance-verticaltab"),Ee=t;let s=t.getBoundingClientRect().top,l=1,c=!1;e.forEach(b=>{if(b!==t){let d=b.getBoundingClientRect();Math.abs(d.top-s)<=l&&(c=!0)}}),c?t.classList.remove("asri-enhance-verticaltab-toponly"):t.classList.add("asri-enhance-verticaltab-toponly");let m=Array.from(t.children).find(b=>b.classList.contains("fn__flex"));if(m&&m.parentElement){let b=m.parentElement.querySelector(".layout__resize.layout__resize--lr.asri-enhance-verticaltab-resize");b||(b=document.createElement("div"),b.className="layout__resize layout__resize--lr asri-enhance-verticaltab-resize",m.parentElement.insertBefore(b,m.nextSibling)),Zs(b)}Ko(t)}on=!1}function Qs(){let n=rn!=null?rn:document.querySelector("#toolbar");if(!n)return 0;rn=n;let e=getComputedStyle(n).getPropertyValue("--topbar-right-spacing");if(!e)return 0;let t=parseFloat(e);return isNaN(t)?0:t}function Ko(n){let e=n!=null?n:Ee;if(!e)return;let t=document.querySelector(".layout__center");if(!t)return;document.querySelector(".layout__dockr > .fn__flex:not(.fn__none)")!==null?t.classList.remove("asri-enhance-dockr-fold"):t.classList.add("asri-enhance-dockr-fold"),Qs()>0?e.classList.add("asri-enhance-verticaltab-dockr-expand-spacing"):e.classList.remove("asri-enhance-verticaltab-dockr-expand-spacing")}async function jo(){let n=await Ws();if(n&&(zo(n),ln(sn),!je))try{let e=an("setUILayout",()=>{let t=document.querySelector(".layout__center");t&&queueMicrotask(()=>{try{zo(t),Ko()}catch(a){}})});je=()=>{try{e.disconnect()}catch(t){}je=null}}catch(e){}}function cn(){if(Xs(),je){try{je()}catch(a){}je=null}let n=document.querySelector(".layout__center");n&&n.classList.remove("asri-enhance-dockr-fold"),document.querySelectorAll('[data-type="wnd"]').forEach(a=>{a.classList.remove("asri-enhance-verticaltab"),a.classList.remove("asri-enhance-verticaltab-toponly"),a.classList.remove("asri-enhance-verticaltab-dockr-expand-spacing");let r=a.querySelector(".layout__resize.layout__resize--lr.asri-enhance-verticaltab-resize");if(r){let o=r.__asriMousedownHandler,i=r.__asriDblclickHandler;o&&(r.removeEventListener("mousedown",o),delete r.__asriMousedownHandler),i&&(r.removeEventListener("dblclick",i),delete r.__asriDblclickHandler),r.remove()}});let t=document.documentElement;t&&t.style.removeProperty("--asri-enhance-vertical-tab-width"),on=!1,Ee=null}async function Vo(n,e){e&&(e.preventDefault(),e.stopPropagation()),Go=n;let t=document.documentElement;if(!t)return;let a=t.hasAttribute("data-asri-enhance-vertical-tab"),r=await p(n,Un)||{};a?(t.removeAttribute("data-asri-enhance-vertical-tab"),r[Xn]=!1,cn()):(t.setAttribute("data-asri-enhance-vertical-tab","true"),r[Xn]=!0,jo().catch(()=>{})),await k(n,Un,r).catch(()=>{})}async function Wo(n,e){Go=n;let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await p(n,Un);a&&a[Xn]===!0?(t.setAttribute("data-asri-enhance-vertical-tab","true"),jo().catch(()=>{})):(t.removeAttribute("data-asri-enhance-vertical-tab"),cn())}function ea(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var Re=ea();function ei(n){Re=n}var Ct={exec:()=>null};function R(n,e=""){let t=typeof n=="string"?n:n.source,a={replace:(r,o)=>{let i=typeof o=="string"?o:o.source;return i=i.replace(J.caret,"$1"),t=t.replace(r,i),a},getRegex:()=>new RegExp(t,e)};return a}var Js=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch(n){return!1}})(),J={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:n=>new RegExp(`^( {0,3}${n})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}#`),htmlBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}<(?:[a-z].*>|!--)`,"i")},el=/^(?:[ \t]*(?:\n|$))+/,tl=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,nl=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Tt=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,al=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,ta=/(?:[*+-]|\d{1,9}[.)])/,ti=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,ni=R(ti).replace(/bull/g,ta).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),rl=R(ti).replace(/bull/g,ta).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),na=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,ol=/^[^\n]+/,aa=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,il=R(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",aa).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),sl=R(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,ta).getRegex(),fn="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",ra=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,ll=R("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",ra).replace("tag",fn).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),ai=R(na).replace("hr",Tt).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",fn).getRegex(),cl=R(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",ai).getRegex(),oa={blockquote:cl,code:tl,def:il,fences:nl,heading:al,hr:Tt,html:ll,lheading:ni,list:sl,newline:el,paragraph:ai,table:Ct,text:ol},Yo=R("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Tt).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",fn).getRegex(),ul={...oa,lheading:rl,table:Yo,paragraph:R(na).replace("hr",Tt).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Yo).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",fn).getRegex()},ml={...oa,html:R(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",ra).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Ct,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:R(na).replace("hr",Tt).replace("heading",` *#{1,6} *[^
]`).replace("lheading",ni).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},dl=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,hl=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,ri=/^( {2,}|\\)\n(?!\s*$)/,pl=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,gn=/[\p{P}\p{S}]/u,ia=/[\s\p{P}\p{S}]/u,oi=/[^\s\p{P}\p{S}]/u,fl=R(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,ia).getRegex(),ii=/(?!~)[\p{P}\p{S}]/u,gl=/(?!~)[\s\p{P}\p{S}]/u,bl=/(?:[^\s\p{P}\p{S}]|~)/u,yl=R(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",Js?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),si=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,vl=R(si,"u").replace(/punct/g,gn).getRegex(),El=R(si,"u").replace(/punct/g,ii).getRegex(),li="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",kl=R(li,"gu").replace(/notPunctSpace/g,oi).replace(/punctSpace/g,ia).replace(/punct/g,gn).getRegex(),wl=R(li,"gu").replace(/notPunctSpace/g,bl).replace(/punctSpace/g,gl).replace(/punct/g,ii).getRegex(),Cl=R("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,oi).replace(/punctSpace/g,ia).replace(/punct/g,gn).getRegex(),Tl=R(/\\(punct)/,"gu").replace(/punct/g,gn).getRegex(),xl=R(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),_l=R(ra).replace("(?:-->|$)","-->").getRegex(),Al=R("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",_l).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),dn=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,Ll=R(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",dn).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),ci=R(/^!?\[(label)\]\[(ref)\]/).replace("label",dn).replace("ref",aa).getRegex(),ui=R(/^!?\[(ref)\](?:\[\])?/).replace("ref",aa).getRegex(),Ml=R("reflink|nolink(?!\\()","g").replace("reflink",ci).replace("nolink",ui).getRegex(),Uo=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,sa={_backpedal:Ct,anyPunctuation:Tl,autolink:xl,blockSkip:yl,br:ri,code:hl,del:Ct,emStrongLDelim:vl,emStrongRDelimAst:kl,emStrongRDelimUnd:Cl,escape:dl,link:Ll,nolink:ui,punctuation:fl,reflink:ci,reflinkSearch:Ml,tag:Al,text:pl,url:Ct},Pl={...sa,link:R(/^!?\[(label)\]\((.*?)\)/).replace("label",dn).getRegex(),reflink:R(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",dn).getRegex()},Zn={...sa,emStrongRDelimAst:wl,emStrongLDelim:El,url:R(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",Uo).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:R(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",Uo).getRegex()},Sl={...Zn,br:R(ri).replace("{2,}","*").getRegex(),text:R(Zn.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},un={normal:oa,gfm:ul,pedantic:ml},Et={normal:sa,gfm:Zn,breaks:Sl,pedantic:Pl},Hl={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Xo=n=>Hl[n];function ke(n,e){if(e){if(J.escapeTest.test(n))return n.replace(J.escapeReplace,Xo)}else if(J.escapeTestNoEncode.test(n))return n.replace(J.escapeReplaceNoEncode,Xo);return n}function Zo(n){try{n=encodeURI(n).replace(J.percentDecode,"%")}catch(e){return null}return n}function Qo(n,e){var o;let t=n.replace(J.findPipe,(i,s,l)=>{let c=!1,m=s;for(;--m>=0&&l[m]==="\\";)c=!c;return c?"|":" |"}),a=t.split(J.splitPipe),r=0;if(a[0].trim()||a.shift(),a.length>0&&!((o=a.at(-1))!=null&&o.trim())&&a.pop(),e)if(a.length>e)a.splice(e);else for(;a.length<e;)a.push("");for(;r<a.length;r++)a[r]=a[r].trim().replace(J.slashPipe,"|");return a}function kt(n,e,t){let a=n.length;if(a===0)return"";let r=0;for(;r<a;){let o=n.charAt(a-r-1);if(o===e&&!t)r++;else if(o!==e&&t)r++;else break}return n.slice(0,a-r)}function Il(n,e){if(n.indexOf(e[1])===-1)return-1;let t=0;for(let a=0;a<n.length;a++)if(n[a]==="\\")a++;else if(n[a]===e[0])t++;else if(n[a]===e[1]&&(t--,t<0))return a;return t>0?-2:-1}function Jo(n,e,t,a,r){let o=e.href,i=e.title||null,s=n[1].replace(r.other.outputLinkReplace,"$1");a.state.inLink=!0;let l={type:n[0].charAt(0)==="!"?"image":"link",raw:t,href:o,title:i,text:s,tokens:a.inlineTokens(s)};return a.state.inLink=!1,l}function Rl(n,e,t){let a=n.match(t.other.indentCodeCompensation);if(a===null)return e;let r=a[1];return e.split(`
`).map(o=>{let i=o.match(t.other.beginningSpace);if(i===null)return o;let[s]=i;return s.length>=r.length?o.slice(r.length):o}).join(`
`)}var hn=class{constructor(n){B(this,"options");B(this,"rules");B(this,"lexer");this.options=n||Re}space(n){let e=this.rules.block.newline.exec(n);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(n){let e=this.rules.block.code.exec(n);if(e){let t=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?t:kt(t,`
`)}}}fences(n){let e=this.rules.block.fences.exec(n);if(e){let t=e[0],a=Rl(t,e[3]||"",this.rules);return{type:"code",raw:t,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:a}}}heading(n){let e=this.rules.block.heading.exec(n);if(e){let t=e[2].trim();if(this.rules.other.endingHash.test(t)){let a=kt(t,"#");(this.options.pedantic||!a||this.rules.other.endingSpaceChar.test(a))&&(t=a.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:t,tokens:this.lexer.inline(t)}}}hr(n){let e=this.rules.block.hr.exec(n);if(e)return{type:"hr",raw:kt(e[0],`
`)}}blockquote(n){let e=this.rules.block.blockquote.exec(n);if(e){let t=kt(e[0],`
`).split(`
`),a="",r="",o=[];for(;t.length>0;){let i=!1,s=[],l;for(l=0;l<t.length;l++)if(this.rules.other.blockquoteStart.test(t[l]))s.push(t[l]),i=!0;else if(!i)s.push(t[l]);else break;t=t.slice(l);let c=s.join(`
`),m=c.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");a=a?`${a}
${c}`:c,r=r?`${r}
${m}`:m;let b=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(m,o,!0),this.lexer.state.top=b,t.length===0)break;let d=o.at(-1);if((d==null?void 0:d.type)==="code")break;if((d==null?void 0:d.type)==="blockquote"){let C=d,g=C.raw+`
`+t.join(`
`),_=this.blockquote(g);o[o.length-1]=_,a=a.substring(0,a.length-C.raw.length)+_.raw,r=r.substring(0,r.length-C.text.length)+_.text;break}else if((d==null?void 0:d.type)==="list"){let C=d,g=C.raw+`
`+t.join(`
`),_=this.list(g);o[o.length-1]=_,a=a.substring(0,a.length-d.raw.length)+_.raw,r=r.substring(0,r.length-C.raw.length)+_.raw,t=g.substring(o.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:a,tokens:o,text:r}}}list(n){var t,a;let e=this.rules.block.list.exec(n);if(e){let r=e[1].trim(),o=r.length>1,i={type:"list",raw:"",ordered:o,start:o?+r.slice(0,-1):"",loose:!1,items:[]};r=o?`\\d{1,9}\\${r.slice(-1)}`:`\\${r}`,this.options.pedantic&&(r=o?r:"[*+-]");let s=this.rules.other.listItemRegex(r),l=!1;for(;n;){let m=!1,b="",d="";if(!(e=s.exec(n))||this.rules.block.hr.test(n))break;b=e[0],n=n.substring(b.length);let C=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,h=>" ".repeat(3*h.length)),g=n.split(`
`,1)[0],_=!C.trim(),w=0;if(this.options.pedantic?(w=2,d=C.trimStart()):_?w=e[1].length+1:(w=e[2].search(this.rules.other.nonSpaceChar),w=w>4?1:w,d=C.slice(w),w+=e[1].length),_&&this.rules.other.blankLine.test(g)&&(b+=g+`
`,n=n.substring(g.length+1),m=!0),!m){let h=this.rules.other.nextBulletRegex(w),y=this.rules.other.hrRegex(w),A=this.rules.other.fencesBeginRegex(w),N=this.rules.other.headingBeginRegex(w),q=this.rules.other.htmlBeginRegex(w);for(;n;){let D=n.split(`
`,1)[0],z;if(g=D,this.options.pedantic?(g=g.replace(this.rules.other.listReplaceNesting,"  "),z=g):z=g.replace(this.rules.other.tabCharGlobal,"    "),A.test(g)||N.test(g)||q.test(g)||h.test(g)||y.test(g))break;if(z.search(this.rules.other.nonSpaceChar)>=w||!g.trim())d+=`
`+z.slice(w);else{if(_||C.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||A.test(C)||N.test(C)||y.test(C))break;d+=`
`+g}!_&&!g.trim()&&(_=!0),b+=D+`
`,n=n.substring(D.length+1),C=z.slice(w)}}i.loose||(l?i.loose=!0:this.rules.other.doubleBlankLine.test(b)&&(l=!0)),i.items.push({type:"list_item",raw:b,task:!!this.options.gfm&&this.rules.other.listIsTask.test(d),loose:!1,text:d,tokens:[]}),i.raw+=b}let c=i.items.at(-1);if(c)c.raw=c.raw.trimEnd(),c.text=c.text.trimEnd();else return;i.raw=i.raw.trimEnd();for(let m of i.items){if(this.lexer.state.top=!1,m.tokens=this.lexer.blockTokens(m.text,[]),m.task){if(m.text=m.text.replace(this.rules.other.listReplaceTask,""),((t=m.tokens[0])==null?void 0:t.type)==="text"||((a=m.tokens[0])==null?void 0:a.type)==="paragraph"){m.tokens[0].raw=m.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),m.tokens[0].text=m.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let d=this.lexer.inlineQueue.length-1;d>=0;d--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[d].src)){this.lexer.inlineQueue[d].src=this.lexer.inlineQueue[d].src.replace(this.rules.other.listReplaceTask,"");break}}let b=this.rules.other.listTaskCheckbox.exec(m.raw);if(b){let d={type:"checkbox",raw:b[0]+" ",checked:b[0]!=="[ ]"};m.checked=d.checked,i.loose?m.tokens[0]&&["paragraph","text"].includes(m.tokens[0].type)&&"tokens"in m.tokens[0]&&m.tokens[0].tokens?(m.tokens[0].raw=d.raw+m.tokens[0].raw,m.tokens[0].text=d.raw+m.tokens[0].text,m.tokens[0].tokens.unshift(d)):m.tokens.unshift({type:"paragraph",raw:d.raw,text:d.raw,tokens:[d]}):m.tokens.unshift(d)}}if(!i.loose){let b=m.tokens.filter(C=>C.type==="space"),d=b.length>0&&b.some(C=>this.rules.other.anyLine.test(C.raw));i.loose=d}}if(i.loose)for(let m of i.items){m.loose=!0;for(let b of m.tokens)b.type==="text"&&(b.type="paragraph")}return i}}html(n){let e=this.rules.block.html.exec(n);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(n){let e=this.rules.block.def.exec(n);if(e){let t=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),a=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",r=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:t,raw:e[0],href:a,title:r}}}table(n){var i;let e=this.rules.block.table.exec(n);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let t=Qo(e[1]),a=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),r=(i=e[3])!=null&&i.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],o={type:"table",raw:e[0],header:[],align:[],rows:[]};if(t.length===a.length){for(let s of a)this.rules.other.tableAlignRight.test(s)?o.align.push("right"):this.rules.other.tableAlignCenter.test(s)?o.align.push("center"):this.rules.other.tableAlignLeft.test(s)?o.align.push("left"):o.align.push(null);for(let s=0;s<t.length;s++)o.header.push({text:t[s],tokens:this.lexer.inline(t[s]),header:!0,align:o.align[s]});for(let s of r)o.rows.push(Qo(s,o.header.length).map((l,c)=>({text:l,tokens:this.lexer.inline(l),header:!1,align:o.align[c]})));return o}}lheading(n){let e=this.rules.block.lheading.exec(n);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(n){let e=this.rules.block.paragraph.exec(n);if(e){let t=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:t,tokens:this.lexer.inline(t)}}}text(n){let e=this.rules.block.text.exec(n);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(n){let e=this.rules.inline.escape.exec(n);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(n){let e=this.rules.inline.tag.exec(n);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(n){let e=this.rules.inline.link.exec(n);if(e){let t=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(t)){if(!this.rules.other.endAngleBracket.test(t))return;let o=kt(t.slice(0,-1),"\\");if((t.length-o.length)%2===0)return}else{let o=Il(e[2],"()");if(o===-2)return;if(o>-1){let i=(e[0].indexOf("!")===0?5:4)+e[1].length+o;e[2]=e[2].substring(0,o),e[0]=e[0].substring(0,i).trim(),e[3]=""}}let a=e[2],r="";if(this.options.pedantic){let o=this.rules.other.pedanticHrefTitle.exec(a);o&&(a=o[1],r=o[3])}else r=e[3]?e[3].slice(1,-1):"";return a=a.trim(),this.rules.other.startAngleBracket.test(a)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(t)?a=a.slice(1):a=a.slice(1,-1)),Jo(e,{href:a&&a.replace(this.rules.inline.anyPunctuation,"$1"),title:r&&r.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(n,e){let t;if((t=this.rules.inline.reflink.exec(n))||(t=this.rules.inline.nolink.exec(n))){let a=(t[2]||t[1]).replace(this.rules.other.multipleSpaceGlobal," "),r=e[a.toLowerCase()];if(!r){let o=t[0].charAt(0);return{type:"text",raw:o,text:o}}return Jo(t,r,t[0],this.lexer,this.rules)}}emStrong(n,e,t=""){let a=this.rules.inline.emStrongLDelim.exec(n);if(!(!a||a[3]&&t.match(this.rules.other.unicodeAlphaNumeric))&&(!(a[1]||a[2])||!t||this.rules.inline.punctuation.exec(t))){let r=[...a[0]].length-1,o,i,s=r,l=0,c=a[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(c.lastIndex=0,e=e.slice(-1*n.length+r);(a=c.exec(e))!=null;){if(o=a[1]||a[2]||a[3]||a[4]||a[5]||a[6],!o)continue;if(i=[...o].length,a[3]||a[4]){s+=i;continue}else if((a[5]||a[6])&&r%3&&!((r+i)%3)){l+=i;continue}if(s-=i,s>0)continue;i=Math.min(i,i+s+l);let m=[...a[0]][0].length,b=n.slice(0,r+a.index+m+i);if(Math.min(r,i)%2){let C=b.slice(1,-1);return{type:"em",raw:b,text:C,tokens:this.lexer.inlineTokens(C)}}let d=b.slice(2,-2);return{type:"strong",raw:b,text:d,tokens:this.lexer.inlineTokens(d)}}}}codespan(n){let e=this.rules.inline.code.exec(n);if(e){let t=e[2].replace(this.rules.other.newLineCharGlobal," "),a=this.rules.other.nonSpaceChar.test(t),r=this.rules.other.startingSpaceChar.test(t)&&this.rules.other.endingSpaceChar.test(t);return a&&r&&(t=t.substring(1,t.length-1)),{type:"codespan",raw:e[0],text:t}}}br(n){let e=this.rules.inline.br.exec(n);if(e)return{type:"br",raw:e[0]}}del(n){let e=this.rules.inline.del.exec(n);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(n){let e=this.rules.inline.autolink.exec(n);if(e){let t,a;return e[2]==="@"?(t=e[1],a="mailto:"+t):(t=e[1],a=t),{type:"link",raw:e[0],text:t,href:a,tokens:[{type:"text",raw:t,text:t}]}}}url(n){var t,a;let e;if(e=this.rules.inline.url.exec(n)){let r,o;if(e[2]==="@")r=e[0],o="mailto:"+r;else{let i;do i=e[0],e[0]=(a=(t=this.rules.inline._backpedal.exec(e[0]))==null?void 0:t[0])!=null?a:"";while(i!==e[0]);r=e[0],e[1]==="www."?o="http://"+e[0]:o=e[0]}return{type:"link",raw:e[0],text:r,href:o,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(n){let e=this.rules.inline.text.exec(n);if(e){let t=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:t}}}},de=class Qn{constructor(e){B(this,"tokens");B(this,"options");B(this,"state");B(this,"inlineQueue");B(this,"tokenizer");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Re,this.options.tokenizer=this.options.tokenizer||new hn,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let t={other:J,block:un.normal,inline:Et.normal};this.options.pedantic?(t.block=un.pedantic,t.inline=Et.pedantic):this.options.gfm&&(t.block=un.gfm,this.options.breaks?t.inline=Et.breaks:t.inline=Et.gfm),this.tokenizer.rules=t}static get rules(){return{block:un,inline:Et}}static lex(e,t){return new Qn(t).lex(e)}static lexInline(e,t){return new Qn(t).inlineTokens(e)}lex(e){e=e.replace(J.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){let a=this.inlineQueue[t];this.inlineTokens(a.src,a.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],a=!1){var r,o,i;for(this.options.pedantic&&(e=e.replace(J.tabCharGlobal,"    ").replace(J.spaceLine,""));e;){let s;if((o=(r=this.options.extensions)==null?void 0:r.block)!=null&&o.some(c=>(s=c.call({lexer:this},e,t))?(e=e.substring(s.raw.length),t.push(s),!0):!1))continue;if(s=this.tokenizer.space(e)){e=e.substring(s.raw.length);let c=t.at(-1);s.raw.length===1&&c!==void 0?c.raw+=`
`:t.push(s);continue}if(s=this.tokenizer.code(e)){e=e.substring(s.raw.length);let c=t.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=(c.raw.endsWith(`
`)?"":`
`)+s.raw,c.text+=`
`+s.text,this.inlineQueue.at(-1).src=c.text):t.push(s);continue}if(s=this.tokenizer.fences(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.heading(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.hr(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.blockquote(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.list(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.html(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.def(e)){e=e.substring(s.raw.length);let c=t.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=(c.raw.endsWith(`
`)?"":`
`)+s.raw,c.text+=`
`+s.raw,this.inlineQueue.at(-1).src=c.text):this.tokens.links[s.tag]||(this.tokens.links[s.tag]={href:s.href,title:s.title},t.push(s));continue}if(s=this.tokenizer.table(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.lheading(e)){e=e.substring(s.raw.length),t.push(s);continue}let l=e;if((i=this.options.extensions)!=null&&i.startBlock){let c=1/0,m=e.slice(1),b;this.options.extensions.startBlock.forEach(d=>{b=d.call({lexer:this},m),typeof b=="number"&&b>=0&&(c=Math.min(c,b))}),c<1/0&&c>=0&&(l=e.substring(0,c+1))}if(this.state.top&&(s=this.tokenizer.paragraph(l))){let c=t.at(-1);a&&(c==null?void 0:c.type)==="paragraph"?(c.raw+=(c.raw.endsWith(`
`)?"":`
`)+s.raw,c.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):t.push(s),a=l.length!==e.length,e=e.substring(s.raw.length);continue}if(s=this.tokenizer.text(e)){e=e.substring(s.raw.length);let c=t.at(-1);(c==null?void 0:c.type)==="text"?(c.raw+=(c.raw.endsWith(`
`)?"":`
`)+s.raw,c.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):t.push(s);continue}if(e){let c="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){var l,c,m,b,d,C;let a=e,r=null;if(this.tokens.links){let g=Object.keys(this.tokens.links);if(g.length>0)for(;(r=this.tokenizer.rules.inline.reflinkSearch.exec(a))!=null;)g.includes(r[0].slice(r[0].lastIndexOf("[")+1,-1))&&(a=a.slice(0,r.index)+"["+"a".repeat(r[0].length-2)+"]"+a.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(r=this.tokenizer.rules.inline.anyPunctuation.exec(a))!=null;)a=a.slice(0,r.index)+"++"+a.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let o;for(;(r=this.tokenizer.rules.inline.blockSkip.exec(a))!=null;)o=r[2]?r[2].length:0,a=a.slice(0,r.index+o)+"["+"a".repeat(r[0].length-o-2)+"]"+a.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);a=(m=(c=(l=this.options.hooks)==null?void 0:l.emStrongMask)==null?void 0:c.call({lexer:this},a))!=null?m:a;let i=!1,s="";for(;e;){i||(s=""),i=!1;let g;if((d=(b=this.options.extensions)==null?void 0:b.inline)!=null&&d.some(w=>(g=w.call({lexer:this},e,t))?(e=e.substring(g.raw.length),t.push(g),!0):!1))continue;if(g=this.tokenizer.escape(e)){e=e.substring(g.raw.length),t.push(g);continue}if(g=this.tokenizer.tag(e)){e=e.substring(g.raw.length),t.push(g);continue}if(g=this.tokenizer.link(e)){e=e.substring(g.raw.length),t.push(g);continue}if(g=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(g.raw.length);let w=t.at(-1);g.type==="text"&&(w==null?void 0:w.type)==="text"?(w.raw+=g.raw,w.text+=g.text):t.push(g);continue}if(g=this.tokenizer.emStrong(e,a,s)){e=e.substring(g.raw.length),t.push(g);continue}if(g=this.tokenizer.codespan(e)){e=e.substring(g.raw.length),t.push(g);continue}if(g=this.tokenizer.br(e)){e=e.substring(g.raw.length),t.push(g);continue}if(g=this.tokenizer.del(e)){e=e.substring(g.raw.length),t.push(g);continue}if(g=this.tokenizer.autolink(e)){e=e.substring(g.raw.length),t.push(g);continue}if(!this.state.inLink&&(g=this.tokenizer.url(e))){e=e.substring(g.raw.length),t.push(g);continue}let _=e;if((C=this.options.extensions)!=null&&C.startInline){let w=1/0,h=e.slice(1),y;this.options.extensions.startInline.forEach(A=>{y=A.call({lexer:this},h),typeof y=="number"&&y>=0&&(w=Math.min(w,y))}),w<1/0&&w>=0&&(_=e.substring(0,w+1))}if(g=this.tokenizer.inlineText(_)){e=e.substring(g.raw.length),g.raw.slice(-1)!=="_"&&(s=g.raw.slice(-1)),i=!0;let w=t.at(-1);(w==null?void 0:w.type)==="text"?(w.raw+=g.raw,w.text+=g.text):t.push(g);continue}if(e){let w="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(w);break}else throw new Error(w)}}return t}},pn=class{constructor(n){B(this,"options");B(this,"parser");this.options=n||Re}space(n){return""}code({text:n,lang:e,escaped:t}){var o;let a=(o=(e||"").match(J.notSpaceStart))==null?void 0:o[0],r=n.replace(J.endingNewline,"")+`
`;return a?'<pre><code class="language-'+ke(a)+'">'+(t?r:ke(r,!0))+`</code></pre>
`:"<pre><code>"+(t?r:ke(r,!0))+`</code></pre>
`}blockquote({tokens:n}){return`<blockquote>
${this.parser.parse(n)}</blockquote>
`}html({text:n}){return n}def(n){return""}heading({tokens:n,depth:e}){return`<h${e}>${this.parser.parseInline(n)}</h${e}>
`}hr(n){return`<hr>
`}list(n){let e=n.ordered,t=n.start,a="";for(let i=0;i<n.items.length;i++){let s=n.items[i];a+=this.listitem(s)}let r=e?"ol":"ul",o=e&&t!==1?' start="'+t+'"':"";return"<"+r+o+`>
`+a+"</"+r+`>
`}listitem(n){return`<li>${this.parser.parse(n.tokens)}</li>
`}checkbox({checked:n}){return"<input "+(n?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:n}){return`<p>${this.parser.parseInline(n)}</p>
`}table(n){let e="",t="";for(let r=0;r<n.header.length;r++)t+=this.tablecell(n.header[r]);e+=this.tablerow({text:t});let a="";for(let r=0;r<n.rows.length;r++){let o=n.rows[r];t="";for(let i=0;i<o.length;i++)t+=this.tablecell(o[i]);a+=this.tablerow({text:t})}return a&&(a=`<tbody>${a}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+a+`</table>
`}tablerow({text:n}){return`<tr>
${n}</tr>
`}tablecell(n){let e=this.parser.parseInline(n.tokens),t=n.header?"th":"td";return(n.align?`<${t} align="${n.align}">`:`<${t}>`)+e+`</${t}>
`}strong({tokens:n}){return`<strong>${this.parser.parseInline(n)}</strong>`}em({tokens:n}){return`<em>${this.parser.parseInline(n)}</em>`}codespan({text:n}){return`<code>${ke(n,!0)}</code>`}br(n){return"<br>"}del({tokens:n}){return`<del>${this.parser.parseInline(n)}</del>`}link({href:n,title:e,tokens:t}){let a=this.parser.parseInline(t),r=Zo(n);if(r===null)return a;n=r;let o='<a href="'+n+'"';return e&&(o+=' title="'+ke(e)+'"'),o+=">"+a+"</a>",o}image({href:n,title:e,text:t,tokens:a}){a&&(t=this.parser.parseInline(a,this.parser.textRenderer));let r=Zo(n);if(r===null)return ke(t);n=r;let o=`<img src="${n}" alt="${t}"`;return e&&(o+=` title="${ke(e)}"`),o+=">",o}text(n){return"tokens"in n&&n.tokens?this.parser.parseInline(n.tokens):"escaped"in n&&n.escaped?n.text:ke(n.text)}},la=class{strong({text:n}){return n}em({text:n}){return n}codespan({text:n}){return n}del({text:n}){return n}html({text:n}){return n}text({text:n}){return n}link({text:n}){return""+n}image({text:n}){return""+n}br(){return""}checkbox({raw:n}){return n}},he=class Jn{constructor(e){B(this,"options");B(this,"renderer");B(this,"textRenderer");this.options=e||Re,this.options.renderer=this.options.renderer||new pn,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new la}static parse(e,t){return new Jn(t).parse(e)}static parseInline(e,t){return new Jn(t).parseInline(e)}parse(e){var a,r;let t="";for(let o=0;o<e.length;o++){let i=e[o];if((r=(a=this.options.extensions)==null?void 0:a.renderers)!=null&&r[i.type]){let l=i,c=this.options.extensions.renderers[l.type].call({parser:this},l);if(c!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(l.type)){t+=c||"";continue}}let s=i;switch(s.type){case"space":{t+=this.renderer.space(s);break}case"hr":{t+=this.renderer.hr(s);break}case"heading":{t+=this.renderer.heading(s);break}case"code":{t+=this.renderer.code(s);break}case"table":{t+=this.renderer.table(s);break}case"blockquote":{t+=this.renderer.blockquote(s);break}case"list":{t+=this.renderer.list(s);break}case"checkbox":{t+=this.renderer.checkbox(s);break}case"html":{t+=this.renderer.html(s);break}case"def":{t+=this.renderer.def(s);break}case"paragraph":{t+=this.renderer.paragraph(s);break}case"text":{t+=this.renderer.text(s);break}default:{let l='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(l),"";throw new Error(l)}}}return t}parseInline(e,t=this.renderer){var r,o;let a="";for(let i=0;i<e.length;i++){let s=e[i];if((o=(r=this.options.extensions)==null?void 0:r.renderers)!=null&&o[s.type]){let c=this.options.extensions.renderers[s.type].call({parser:this},s);if(c!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){a+=c||"";continue}}let l=s;switch(l.type){case"escape":{a+=t.text(l);break}case"html":{a+=t.html(l);break}case"link":{a+=t.link(l);break}case"image":{a+=t.image(l);break}case"checkbox":{a+=t.checkbox(l);break}case"strong":{a+=t.strong(l);break}case"em":{a+=t.em(l);break}case"codespan":{a+=t.codespan(l);break}case"br":{a+=t.br(l);break}case"del":{a+=t.del(l);break}case"text":{a+=t.text(l);break}default:{let c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return a}},mn,wt=(mn=class{constructor(n){B(this,"options");B(this,"block");this.options=n||Re}preprocess(n){return n}postprocess(n){return n}processAllTokens(n){return n}emStrongMask(n){return n}provideLexer(){return this.block?de.lex:de.lexInline}provideParser(){return this.block?he.parse:he.parseInline}},B(mn,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens","emStrongMask"])),B(mn,"passThroughHooksRespectAsync",new Set(["preprocess","postprocess","processAllTokens"])),mn),Nl=class{constructor(...n){B(this,"defaults",ea());B(this,"options",this.setOptions);B(this,"parse",this.parseMarkdown(!0));B(this,"parseInline",this.parseMarkdown(!1));B(this,"Parser",he);B(this,"Renderer",pn);B(this,"TextRenderer",la);B(this,"Lexer",de);B(this,"Tokenizer",hn);B(this,"Hooks",wt);this.use(...n)}walkTokens(n,e){var a,r;let t=[];for(let o of n)switch(t=t.concat(e.call(this,o)),o.type){case"table":{let i=o;for(let s of i.header)t=t.concat(this.walkTokens(s.tokens,e));for(let s of i.rows)for(let l of s)t=t.concat(this.walkTokens(l.tokens,e));break}case"list":{let i=o;t=t.concat(this.walkTokens(i.items,e));break}default:{let i=o;(r=(a=this.defaults.extensions)==null?void 0:a.childTokens)!=null&&r[i.type]?this.defaults.extensions.childTokens[i.type].forEach(s=>{let l=i[s].flat(1/0);t=t.concat(this.walkTokens(l,e))}):i.tokens&&(t=t.concat(this.walkTokens(i.tokens,e)))}}return t}use(...n){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return n.forEach(t=>{let a={...t};if(a.async=this.defaults.async||a.async||!1,t.extensions&&(t.extensions.forEach(r=>{if(!r.name)throw new Error("extension name required");if("renderer"in r){let o=e.renderers[r.name];o?e.renderers[r.name]=function(...i){let s=r.renderer.apply(this,i);return s===!1&&(s=o.apply(this,i)),s}:e.renderers[r.name]=r.renderer}if("tokenizer"in r){if(!r.level||r.level!=="block"&&r.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let o=e[r.level];o?o.unshift(r.tokenizer):e[r.level]=[r.tokenizer],r.start&&(r.level==="block"?e.startBlock?e.startBlock.push(r.start):e.startBlock=[r.start]:r.level==="inline"&&(e.startInline?e.startInline.push(r.start):e.startInline=[r.start]))}"childTokens"in r&&r.childTokens&&(e.childTokens[r.name]=r.childTokens)}),a.extensions=e),t.renderer){let r=this.defaults.renderer||new pn(this.defaults);for(let o in t.renderer){if(!(o in r))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;let i=o,s=t.renderer[i],l=r[i];r[i]=(...c)=>{let m=s.apply(r,c);return m===!1&&(m=l.apply(r,c)),m||""}}a.renderer=r}if(t.tokenizer){let r=this.defaults.tokenizer||new hn(this.defaults);for(let o in t.tokenizer){if(!(o in r))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;let i=o,s=t.tokenizer[i],l=r[i];r[i]=(...c)=>{let m=s.apply(r,c);return m===!1&&(m=l.apply(r,c)),m}}a.tokenizer=r}if(t.hooks){let r=this.defaults.hooks||new wt;for(let o in t.hooks){if(!(o in r))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;let i=o,s=t.hooks[i],l=r[i];wt.passThroughHooks.has(o)?r[i]=c=>{if(this.defaults.async&&wt.passThroughHooksRespectAsync.has(o))return(async()=>{let b=await s.call(r,c);return l.call(r,b)})();let m=s.call(r,c);return l.call(r,m)}:r[i]=(...c)=>{if(this.defaults.async)return(async()=>{let b=await s.apply(r,c);return b===!1&&(b=await l.apply(r,c)),b})();let m=s.apply(r,c);return m===!1&&(m=l.apply(r,c)),m}}a.hooks=r}if(t.walkTokens){let r=this.defaults.walkTokens,o=t.walkTokens;a.walkTokens=function(i){let s=[];return s.push(o.call(this,i)),r&&(s=s.concat(r.call(this,i))),s}}this.defaults={...this.defaults,...a}}),this}setOptions(n){return this.defaults={...this.defaults,...n},this}lexer(n,e){return de.lex(n,e!=null?e:this.defaults)}parser(n,e){return he.parse(n,e!=null?e:this.defaults)}parseMarkdown(n){return(e,t)=>{let a={...t},r={...this.defaults,...a},o=this.onError(!!r.silent,!!r.async);if(this.defaults.async===!0&&a.async===!1)return o(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(r.hooks&&(r.hooks.options=r,r.hooks.block=n),r.async)return(async()=>{let i=r.hooks?await r.hooks.preprocess(e):e,s=await(r.hooks?await r.hooks.provideLexer():n?de.lex:de.lexInline)(i,r),l=r.hooks?await r.hooks.processAllTokens(s):s;r.walkTokens&&await Promise.all(this.walkTokens(l,r.walkTokens));let c=await(r.hooks?await r.hooks.provideParser():n?he.parse:he.parseInline)(l,r);return r.hooks?await r.hooks.postprocess(c):c})().catch(o);try{r.hooks&&(e=r.hooks.preprocess(e));let i=(r.hooks?r.hooks.provideLexer():n?de.lex:de.lexInline)(e,r);r.hooks&&(i=r.hooks.processAllTokens(i)),r.walkTokens&&this.walkTokens(i,r.walkTokens);let s=(r.hooks?r.hooks.provideParser():n?he.parse:he.parseInline)(i,r);return r.hooks&&(s=r.hooks.postprocess(s)),s}catch(i){return o(i)}}}onError(n,e){return t=>{if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,n){let a="<p>An error occurred:</p><pre>"+ke(t.message+"",!0)+"</pre>";return e?Promise.resolve(a):a}if(e)return Promise.reject(t);throw t}}},Ie=new Nl;function x(n,e){return Ie.parse(n,e)}x.options=x.setOptions=function(n){return Ie.setOptions(n),x.defaults=Ie.defaults,ei(x.defaults),x};x.getDefaults=ea;x.defaults=Re;x.use=function(...n){return Ie.use(...n),x.defaults=Ie.defaults,ei(x.defaults),x};x.walkTokens=function(n,e){return Ie.walkTokens(n,e)};x.parseInline=Ie.parseInline;x.Parser=he;x.parser=he.parse;x.Renderer=pn;x.TextRenderer=la;x.Lexer=de;x.lexer=de.lex;x.Tokenizer=hn;x.Hooks=wt;x.parse=x;var Iu=x.options,Ru=x.setOptions,Nu=x.use,$u=x.walkTokens,Fu=x.parseInline;var Ou=he.parse,Du=de.lex;var $l=/^(\${1,2})(?!\$)((?:\\.|[^\\\n])*?(?:\\.|[^\\\n\$]))\1(?=[\s?!\.,:？！。，：]|$)/,Fl=/^(\${1,2})(?!\$)((?:\\.|[^\\\n])*?(?:\\.|[^\\\n\$]))\1/,Ol=/^(\${1,2})\n((?:\\[^]|[^\\])+?)\n\1(?:\n|$)/;function ca(n={}){return{extensions:[Dl(n,mi(n,!1)),Bl(n,mi(n,!0))]}}function mi(n,e){return t=>{try{let a=typeof window!="undefined"&&window.katex?window.katex:null;if(a&&typeof a.renderToString=="function")try{return a.renderToString(t.text,{...n,displayMode:t.displayMode})+(e?`
`:"")}catch(r){}}catch(a){}return t.raw+(e?`
`:"")}}function Dl(n,e){let t=n&&n.nonStandard,a=t?Fl:$l;return{name:"inlineKatex",level:"inline",start(r){let o,i=r;for(;i;){if(o=i.indexOf("$"),o===-1)return;if((t?o>-1:o===0||i.charAt(o-1)===" ")&&i.substring(o).match(a))return o;i=i.substring(o+1).replace(/^\$+/,"")}},tokenizer(r,o){let i=r.match(a);if(i)return{type:"inlineKatex",raw:i[0],text:i[2].trim(),displayMode:i[1].length===2}},renderer:e}}function Bl(n,e){return{name:"blockKatex",level:"block",tokenizer(t,a){let r=t.match(Ol);if(r)return{type:"blockKatex",raw:r[0],text:r[2].trim(),displayMode:r[1].length===2}},renderer:e}}var bn=null;try{x&&typeof x.use=="function"&&typeof ca=="function"&&x.use(ca({throwOnError:!1}))}catch(n){}try{let n=window==null?void 0:window.hljs;x&&typeof x.setOptions=="function"&&x.setOptions({highlight:(e,t)=>{try{if(n){if(t&&n.getLanguage&&n.getLanguage(t))return n.highlight(e,{language:t}).value;if(n.highlightAuto)return n.highlightAuto(e).value}}catch(a){}return e}})}catch(n){}function ua(n){try{let e=window==null?void 0:window.hljs;if(!e)return;Array.from(n.querySelectorAll("pre code")).forEach(a=>{try{if(typeof e.highlightElement=="function")e.highlightElement(a);else{let o=(a.className||"").match(/language-([a-z0-9-]+)/i),i=o&&o[1]||"",s=a.textContent||"";i&&e.getLanguage&&e.getLanguage(i)?a.innerHTML=e.highlight(s,{language:i}).value:e.highlightAuto&&(a.innerHTML=e.highlightAuto(s).value)}}catch(r){}})}catch(e){}}async function ql(){var n;try{await fetch("/api/notification/pushMsg",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({msg:(n=bn==null?void 0:bn.i18n)==null?void 0:n.mergedSideMemoEditTip,timeout:3e3})})}catch(e){}}async function di(){try{let n=document.head,e=(i,s)=>{try{if(document.getElementById(i))return;let l=document.createElement("link");l.id=i,l.rel="stylesheet",l.type="text/css",l.href=s,n.appendChild(l)}catch(l){}},t=(i,s)=>new Promise((l,c)=>{try{if(document.getElementById(i)){l();return}let m=document.createElement("script");m.id=i,m.src=s,m.async=!0,m.onload=()=>{try{l()}catch(b){}},m.onerror=()=>{try{c()}catch(b){}},n.appendChild(m)}catch(m){c(m)}}),a=!window.katex,r=!window.hljs;if(!a&&!r)return!0;let o=[];a&&(o.push({type:"link",id:"protyleKatexStyle",href:"/stage/protyle/js/katex/katex.min.css?v=0.16.9"}),o.push({type:"script",id:"protyleKatexScript",src:"/stage/protyle/js/katex/katex.min.js?v=0.16.9"}),o.push({type:"script",id:"protyleKatexMhchemScript",src:"/stage/protyle/js/katex/mhchem.min.js?v=0.16.9"})),r&&(o.push({type:"link",id:"protyleHljsStyle",href:"/stage/protyle/js/highlight.js/styles/github.min.css?v=11.11.1"}),o.push({type:"script",id:"protyleHljsScript",src:"/stage/protyle/js/highlight.js/highlight.min.js?v=11.11.1"}));for(let i of o)try{i.type==="link"?e(i.id,i.href):await t(i.id,i.src)}catch(s){}}catch(n){}return window.katex!==void 0||window.hljs!==void 0}var da="config.json",ha="asri-enhance-side-memo",Ve=null;function ma(n){try{if(!n||n.__asriNoRightClickAttached)return;n.__asriNoRightClickAttached=!0;let e=t=>{try{if(t.type==="contextmenu"){t.preventDefault(),t.stopPropagation();return}let a=t;if(typeof a.button=="number"&&a.button===2){try{a.preventDefault()}catch(r){}try{a.stopPropagation()}catch(r){}}}catch(a){}};try{n.addEventListener("contextmenu",e,{capture:!0,passive:!1}),n.addEventListener("mousedown",e,{capture:!0,passive:!1}),n.addEventListener("mouseup",e,{capture:!0,passive:!1})}catch(t){}}catch(e){}}function Ae(){Array.from(document.querySelectorAll(".protyle-title")).forEach(r=>{try{let o=r.getBoundingClientRect().height;r.style.setProperty("--asri-enhance-sidememo-title-height",`${o}px`)}catch(o){}});let e=document.documentElement,t=!!(e&&e.hasAttribute("data-asri-enhance-side-memo"));if(Array.from(document.querySelectorAll(".protyle-content")).forEach(r=>{try{let o=r.querySelector('[data-type*="inline-memo"], [memo]')!==null;t&&o?(r.classList.add("asri-enhance-sidememo"),r.classList.remove("asri-enhance-sidememo-none")):t&&!o?(r.classList.remove("asri-enhance-sidememo"),r.classList.add("asri-enhance-sidememo-none")):(r.classList.remove("asri-enhance-sidememo"),r.classList.remove("asri-enhance-sidememo-none"))}catch(o){}}),t)xt();else try{Array.from(document.querySelectorAll(".asri-enhance-sidememo-container")).forEach(o=>{try{o.remove()}catch(i){}})}catch(r){}}function xt(){if(Array.from(document.querySelectorAll(".asri-enhance-sidememo .protyle-top .protyle-title")).forEach(t=>{try{let a=t.querySelector(".asri-enhance-sidememo-container");a||(a=document.createElement("div"),a.className="asri-enhance-sidememo-container protyle-custom",t.appendChild(a));try{let o=t.closest(".protyle-top");o&&(t.classList.contains("fn__none")?o.classList.add("asri-enhance-sidememo-protyle-title-none"):o.classList.remove("asri-enhance-sidememo-protyle-title-none"))}catch(o){}try{ma(a)}catch(o){}try{let o=getComputedStyle(t).position;(!o||o==="static")&&(t.style.position="relative")}catch(o){}let r=t.closest(".protyle-content");if(r){zl(a,r);try{ma(a)}catch(o){}}}catch(a){}}),Array.from(document.querySelectorAll(".protyle-top .protyle-title > .asri-enhance-sidememo-container")).forEach(t=>{let a=t.parentElement;if(a)if(a.closest(".asri-enhance-sidememo"))try{ma(t)}catch(r){}else try{try{let r=a.closest(".protyle-top");r&&r.classList.remove("asri-enhance-sidememo-protyle-title-none")}catch(r){}t.remove()}catch(r){}}),!Ve){Ve=t=>{try{let a=t.target;if(!a||!a.closest)return;let r=a.closest(".asri-enhance-sidememo-inlinememo-item-title, .asri-enhance-sidememo-blockmemo-item-title, .asri-enhance-sidememo-filememo-item-title");if(!r)return;let o=r.closest(".asri-enhance-sidememo-inlinememo-item, .asri-enhance-sidememo-blockmemo-item, .asri-enhance-sidememo-filememo-item");if(!o)return;try{t.preventDefault(),t.stopPropagation()}catch(i){}try{let i=o.classList.toggle("asri-enhance-sidememo-item-fold");try{let s=o.getAttribute("asri-enhance-sidememo-uid");if(s){let l=`[data-type*="inline-memo"][asri-enhance-sidememo-uid="${s}"], [memo][asri-enhance-sidememo-uid="${s}"]`;Array.from(document.querySelectorAll(l)).forEach(m=>{if(m&&m.setAttribute)if(i)m.setAttribute("asri-enhance-sidememo-fold","true");else try{m.removeAttribute("asri-enhance-sidememo-fold")}catch(b){}})}}catch(s){}try{Ae(),xt()}catch(s){}}catch(i){}}catch(a){}};try{document.addEventListener("contextmenu",Ve,!0)}catch(t){}}}function zl(n,e){for(Array.from(e.querySelectorAll('[data-type*="inline-memo"], [memo]')).forEach(h=>{try{let y=h.__asriSidememoHandlers;y&&(y.enter&&h.removeEventListener("mouseenter",y.enter),y.leave&&h.removeEventListener("mouseleave",y.leave),delete h.__asriSidememoHandlers)}catch(y){}});n.firstChild;){let h=n.firstChild;try{let y=h.__asriSidememoHandlers;if(y){y.enter&&h.removeEventListener("mouseenter",y.enter),y.leave&&h.removeEventListener("mouseleave",y.leave),y.click&&h.removeEventListener("click",y.click),y.mousedown&&h.removeEventListener("mousedown",y.mousedown),y._preMove&&document.removeEventListener("mousemove",y._preMove),y._preUp&&document.removeEventListener("mouseup",y._preUp),y._dragMove&&document.removeEventListener("mousemove",y._dragMove),y._dragUp&&document.removeEventListener("mouseup",y._dragUp),y._timer&&clearTimeout(y._timer);try{y._asriContainer&&y._asriContainer.classList.remove("asri-enhance-sidememo-container-resize"),y._asriParent&&y._asriParent.classList.remove("asri-enhance-sidememo-container-resize")}catch(A){}delete h.__asriSidememoHandlers}}catch(y){}n.removeChild(h)}let a=Array.from(e.querySelectorAll('[data-type*="inline-memo"], [memo]')),r=[],o=a.filter(h=>{var y;return h.hasAttribute("data-type")&&((y=h.getAttribute("data-type"))==null?void 0:y.split(/\s+/).includes("inline-memo"))&&!h.closest(".av__gallery-content")}),i=new Set,s=[];o.forEach((h,y)=>{if(i.has(h))return;let A=h.getAttribute("data-inline-memo-content")||"",N=[h];i.add(h);for(let q=y+1;q<o.length;q++){let D=o[q];if(i.has(D))continue;let z=D.getAttribute("data-inline-memo-content")||"";if(A===z&&c(N[N.length-1],D))N.push(D),i.add(D);else break}s.push({elements:N,content:A})});function l(h){return h?/^[\u200B\u200C\u200D\u200E\u200F\uFEFF]*$/.test(h):!0}function c(h,y){if(!h.parentElement||!y.parentElement||h.parentElement!==y.parentElement)return!1;let A=Array.from(h.parentElement.childNodes),N=A.indexOf(h),q=A.indexOf(y);if(q<=N)return!1;for(let D=N+1;D<q;D++){let z=A[D];if(z.nodeType===Node.TEXT_NODE){let T=z.textContent||"";if(!l(T))return!1}if(z.nodeType===Node.ELEMENT_NODE)return!1}return!0}let m=a.filter(h=>h.hasAttribute("memo")&&!h.classList.contains("protyle-wysiwyg")),b=a.filter(h=>h.hasAttribute("memo")&&h.classList.contains("protyle-wysiwyg")),d=[...s,...m,...b];d.sort((h,y)=>{let A,N;"elements"in h?A=h.elements[0]:A=h,"elements"in y?N=y.elements[0]:N=y;let q=A.compareDocumentPosition(N);return q&Node.DOCUMENT_POSITION_FOLLOWING?-1:q&Node.DOCUMENT_POSITION_PRECEDING?1:0}),d.forEach((h,y)=>{var A,N;try{let q="elements"in h,D=h instanceof HTMLElement&&h.hasAttribute("memo")&&!h.classList.contains("protyle-wysiwyg"),z=h instanceof HTMLElement&&h.hasAttribute("memo")&&h.classList.contains("protyle-wysiwyg");if(q){let{elements:T,content:$}=h,O=T.map(E=>(E.textContent||"").trim()).join(""),L=document.createElement("div");L.className="asri-enhance-sidememo-inlinememo-item",L.style.position="absolute";let G=document.createElement("div");G.className="asri-enhance-sidememo-inlinememo-item-title",G.textContent=O;let F=document.createElement("div");F.className="asri-enhance-sidememo-inlinememo-item-content";try{let E=typeof x=="function"?x($):x&&(x.parse||x.default)?x.parse?x.parse($):x.default?x.default($):$:$;F.innerHTML=E;try{ua(F)}catch(H){}}catch(E){F.textContent=$}L.appendChild(G),L.appendChild(F);try{T.some(E=>E.getAttribute&&E.getAttribute("asri-enhance-sidememo-fold")==="true")&&L.classList.add("asri-enhance-sidememo-item-fold")}catch(E){}let M=0;try{let E=T[0].getBoundingClientRect(),H=(A=n.parentElement)==null?void 0:A.getBoundingClientRect();if(H)M=Math.max(0,E.top-H.bottom+4);else{let V=e.getBoundingClientRect();M=Math.max(0,E.top-V.top)}}catch(E){}let P=T[0].getAttribute("asri-enhance-sidememo-uid");if(!P){P=`asri-enhance-sidememo-${Math.random().toString(36).slice(2,10)}${Date.now().toString(36)}`;try{T.forEach(E=>E.setAttribute("asri-enhance-sidememo-uid",P))}catch(E){}}L.setAttribute("asri-enhance-sidememo-uid",P),L.style.top=`${M}px`,r.push({el:L,top:M,height:0,uid:P,sourceEls:T,index:y,type:"inline"})}else if(D){let T=h,$=(T.textContent||"").trim(),O=T.getAttribute("memo")||"",L=document.createElement("div");L.className="asri-enhance-sidememo-blockmemo-item",L.style.position="absolute";let G=document.createElement("div");G.className="asri-enhance-sidememo-blockmemo-item-title",G.textContent=$;let F=document.createElement("div");F.className="asri-enhance-sidememo-blockmemo-item-content";try{let E=typeof x=="function"?x(O):x&&(x.parse||x.default)?x.parse?x.parse(O):x.default?x.default(O):O:O;F.innerHTML=E;try{ua(F)}catch(H){}}catch(E){F.textContent=O}L.appendChild(G),L.appendChild(F);try{T.getAttribute&&T.getAttribute("asri-enhance-sidememo-fold")==="true"&&L.classList.add("asri-enhance-sidememo-item-fold")}catch(E){}let M=0;try{let E=T.getBoundingClientRect(),H=(N=n.parentElement)==null?void 0:N.getBoundingClientRect();if(H)M=Math.max(0,E.top-H.bottom+4);else{let V=e.getBoundingClientRect();M=Math.max(0,E.top-V.top)}}catch(E){}let P=T.getAttribute("asri-enhance-sidememo-uid");if(!P){P=`asri-enhance-sidememo-${Math.random().toString(36).slice(2,10)}${Date.now().toString(36)}`;try{T.setAttribute("asri-enhance-sidememo-uid",P)}catch(E){}}L.setAttribute("asri-enhance-sidememo-uid",P),L.style.top=`${M}px`,r.push({el:L,top:M,height:0,uid:P,sourceEl:T,index:y,type:"block"})}else if(z){let T=h,$="";try{let E=T.previousElementSibling;if(E&&E.classList.contains("protyle-top")){let H=E.querySelector(".protyle-title .protyle-title__input");H&&($=(H.textContent||"").trim())}}catch(E){}$||($=(T.textContent||"").trim());let O=T.getAttribute("memo")||"",L=document.createElement("div");L.className="asri-enhance-sidememo-filememo-item",L.style.position="absolute";let G=document.createElement("div");G.className="asri-enhance-sidememo-filememo-item-title",G.textContent=$;let F=document.createElement("div");F.className="asri-enhance-sidememo-filememo-item-content";try{let E=typeof x=="function"?x(O):x&&(x.parse||x.default)?x.parse?x.parse(O):x.default?x.default(O):O:O;F.innerHTML=E;try{ua(F)}catch(H){}}catch(E){F.textContent=O}L.appendChild(G),L.appendChild(F);try{T.getAttribute&&T.getAttribute("asri-enhance-sidememo-fold")==="true"&&L.classList.add("asri-enhance-sidememo-item-fold")}catch(E){}let M=20,P=T.getAttribute("asri-enhance-sidememo-uid");if(!P){P=`asri-enhance-sidememo-${Math.random().toString(36).slice(2,10)}${Date.now().toString(36)}`;try{T.setAttribute("asri-enhance-sidememo-uid",P)}catch(E){}}L.setAttribute("asri-enhance-sidememo-uid",P),L.style.top=`${M}px`,r.push({el:L,top:M,height:0,uid:P,sourceEl:T,index:y,type:"file"})}}catch(q){}});let C=document.createDocumentFragment();r.forEach(h=>C.appendChild(h.el)),n.appendChild(C),r.forEach(h=>{try{h.height=Math.ceil(h.el.getBoundingClientRect().height)}catch(y){h.height=0}});let g=8,_=0;r.forEach(h=>{let y=Math.max(0,h.top),A=Math.max(y,_);h.el.style.top=`${A}px`,_=A+h.height+g});let w=(h,y)=>{try{if(!h)return;let A=h.hasAttribute&&h.getAttribute("data-type")==="inline-memo",N=h.hasAttribute("memo")&&h.classList.contains("protyle-wysiwyg");if(!A&&!N)return;if(y)try{if(h.getAttribute&&h.getAttribute("asri-enhance-sidememo-fold")==="true")return}catch($){}let q=h.closest(".protyle-wysiwyg");if(!q)return;let D=q.previousElementSibling;if(!D||!D.classList||!D.classList.contains("protyle-top")||D.classList.contains("asri-enhance-sidememo-protyle-title-none")||!q.closest(".asri-enhance-sidememo"))return;let T=document.querySelector(".tooltip--memo#tooltip");if(!T)return;try{y?T.classList.add("asri-enhance-sidememo-tooltip-memo-none"):T.classList.remove("asri-enhance-sidememo-tooltip-memo-none")}catch($){}}catch(A){}};r.forEach(h=>{try{let y=h.sourceEls||(h.sourceEl?[h.sourceEl]:[]);if(y.length===0)return;let A=()=>{y.forEach(T=>T.classList.add("asri-enhance-sidememo-highlight"))},N=()=>{y.forEach(T=>T.classList.remove("asri-enhance-sidememo-highlight"))},q=()=>{h.el.classList.add("asri-enhance-sidememo-highlight");try{y.forEach(T=>w(T,!0))}catch(T){}},D=()=>{h.el.classList.remove("asri-enhance-sidememo-highlight");try{y.forEach(T=>w(T,!1))}catch(T){}};h.el.addEventListener("mouseenter",A),h.el.addEventListener("mouseleave",N),y.forEach(T=>{T.addEventListener("mouseenter",q),T.addEventListener("mouseleave",D)});let z=T=>{if(T.button!==0)return;let $=T.clientX,O=T.clientY,L=P=>{$=P.clientX,O=P.clientY,(Math.abs(P.clientX-T.clientX)>6||Math.abs(P.clientY-T.clientY)>6)&&(h.el.__asriSidememoHandlers&&h.el.__asriSidememoHandlers._timer&&(clearTimeout(h.el.__asriSidememoHandlers._timer),h.el.__asriSidememoHandlers._timer=null),document.removeEventListener("mousemove",L),document.removeEventListener("mouseup",G))},G=()=>{h.el.__asriSidememoHandlers&&h.el.__asriSidememoHandlers._timer&&(clearTimeout(h.el.__asriSidememoHandlers._timer),h.el.__asriSidememoHandlers._timer=null),document.removeEventListener("mousemove",L),document.removeEventListener("mouseup",G)};document.addEventListener("mousemove",L),document.addEventListener("mouseup",G);let F=window.setTimeout(()=>{var we;document.removeEventListener("mousemove",L),document.removeEventListener("mouseup",G);let P=$,E=(we=y[0])==null?void 0:we.closest(".asri-enhance-sidememo");if(!E)return;let H=n;try{H.classList.add("asri-enhance-sidememo-container-resize")}catch(U){}let V=getComputedStyle(E).getPropertyValue("--asri-enhance-sidememo-container-width")||"",ee=Math.max(50,Math.min(600,Math.round(parseFloat(V)||200))),Q=null,Z=null,se=null,ce=null;Q=U=>{try{let ae=Math.round(ee+(P-U.clientX));ce=Math.max(50,Math.min(600,ae)),se===null&&(se=requestAnimationFrame(()=>{try{ce!==null&&E.style.setProperty("--asri-enhance-sidememo-container-width",`${ce}px`)}catch(Se){}se=null,ce=null}))}catch(ae){}},Z=()=>{try{Q&&document.removeEventListener("mousemove",Q),Z&&document.removeEventListener("mouseup",Z)}catch(ae){}try{se!==null&&(cancelAnimationFrame(se),se=null,ce=null)}catch(ae){}let U=h.el.__asriSidememoHandlers;if(U){try{U._asriContainer&&U._asriContainer.classList.remove("asri-enhance-sidememo-container-resize"),U._asriParent&&U._asriParent.classList.remove("asri-enhance-sidememo-container-resize")}catch(ae){}U._dragMove=null,U._dragUp=null,U._asriParent=null,U._asriContainer=null}try{setTimeout(()=>{try{Ae(),xt()}catch(ae){}},200)}catch(ae){}};let ue=h.el.__asriSidememoHandlers||{};ue._dragMove=Q,ue._dragUp=Z,ue._asriParent=E,ue._asriContainer=H,h.el.__asriSidememoHandlers=ue,document.addEventListener("mousemove",Q),document.addEventListener("mouseup",Z)},300),M=h.el.__asriSidememoHandlers||{};M._preMove=L,M._preUp=G,M._timer=F,h.el.__asriSidememoHandlers=M};try{let T=h.el.querySelector(".asri-enhance-sidememo-inlinememo-item-title, .asri-enhance-sidememo-blockmemo-item-title, .asri-enhance-sidememo-filememo-item-title");if(T){let $=F=>{try{F.preventDefault(),F.stopPropagation()}catch(M){}try{if(h.type==="file"){let E=y[0];try{let H=E.previousElementSibling;if(H&&H.classList.contains("protyle-top")){let V=H.querySelector(".protyle-title .protyle-attr--memo");if(V){let ee=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window,button:0});V.dispatchEvent(ee);return}}}catch(H){}}let M=y[0],P=y.length>1;if(M!=null&&M.hasAttribute&&M.hasAttribute("memo")){let E=null;try{let Z=M.querySelector(":scope > .protyle-attr");Z&&(E=Z.querySelector(".protyle-attr--memo"))}catch(Z){E=null}let H=(E!=null?E:M).getBoundingClientRect(),V=Math.round(H.left+H.width/2),ee=Math.round(H.top+H.height/2),Q=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window,button:0,clientX:V,clientY:ee});try{E?E.dispatchEvent(Q):M.dispatchEvent(Q)}catch(Z){}}else if(P)ql().catch(()=>{});else{let E=M.getBoundingClientRect(),H=Math.round(E.left+E.width/2),V=Math.round(E.top+E.height/2),ee=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0,view:window,button:2,clientX:H,clientY:V});try{M.dispatchEvent(ee)}catch(Q){}}}catch(M){}};T.addEventListener("click",$);let O=F=>{try{F.preventDefault(),F.stopPropagation()}catch(M){}try{let M=h.el.classList.toggle("asri-enhance-sidememo-item-fold");try{let P=h.el.getAttribute("asri-enhance-sidememo-uid");if(P){let E=`[data-type*="inline-memo"][asri-enhance-sidememo-uid="${P}"], [memo][asri-enhance-sidememo-uid="${P}"]`;Array.from(document.querySelectorAll(E)).forEach(V=>{if(V&&V.setAttribute)if(M)V.setAttribute("asri-enhance-sidememo-fold","true");else try{V.removeAttribute("asri-enhance-sidememo-fold")}catch(ee){}})}}catch(P){}}catch(M){}try{Ae(),xt()}catch(M){}};T.addEventListener("contextmenu",O);let L=h.el.__asriSidememoHandlers||{},G=Object.assign(L,{enter:A,leave:N,click:$,titleRightClick:O,mousedown:z});h.el.__asriSidememoHandlers=G,h.el.addEventListener("mousedown",z)}else{let $=h.el.__asriSidememoHandlers||{},O=Object.assign($,{enter:A,leave:N,mousedown:z});h.el.__asriSidememoHandlers=O,h.el.addEventListener("mousedown",z)}}catch(T){let $=h.el.__asriSidememoHandlers||{},O=Object.assign($,{enter:A,leave:N,mousedown:z});h.el.__asriSidememoHandlers=O,h.el.addEventListener("mousedown",z)}try{y.forEach(T=>{T.__asriSidememoHandlers={enter:q,leave:D}})}catch(T){}}catch(y){}})}var We=null;function yn(){try{if(Ve){try{document.removeEventListener("contextmenu",Ve,!0)}catch(l){}Ve=null}Array.from(document.querySelectorAll(".asri-enhance-sidememo-container")).forEach(l=>{try{Array.from(l.children).forEach(c=>{try{let m=c.__asriSidememoHandlers;if(m){if(m.enter&&c.removeEventListener("mouseenter",m.enter),m.leave&&c.removeEventListener("mouseleave",m.leave),m.click&&c.removeEventListener("click",m.click),m.mousedown&&c.removeEventListener("mousedown",m.mousedown),m._preMove&&document.removeEventListener("mousemove",m._preMove),m._preUp&&document.removeEventListener("mouseup",m._preUp),m._dragMove&&document.removeEventListener("mousemove",m._dragMove),m._dragUp&&document.removeEventListener("mouseup",m._dragUp),m.titleRightClick)try{let b=c.querySelector(".asri-enhance-sidememo-inlinememo-item-title, .asri-enhance-sidememo-blockmemo-item-title, .asri-enhance-sidememo-filememo-item-title");b&&b.removeEventListener("contextmenu",m.titleRightClick)}catch(b){}if(m._timer&&clearTimeout(m._timer),m._asriContainer)try{m._asriContainer.classList.remove("asri-enhance-sidememo-container-resize")}catch(b){}if(m._asriParent)try{m._asriParent.classList.remove("asri-enhance-sidememo-container-resize")}catch(b){}delete c.__asriSidememoHandlers}}catch(m){}});try{l.remove()}catch(c){}}catch(c){}}),Array.from(document.querySelectorAll(".protyle-content")).forEach(l=>{try{l.classList.remove("asri-enhance-sidememo"),l.classList.remove("asri-enhance-sidememo-none"),Array.from(l.querySelectorAll('[data-type*="inline-memo"], [memo]')).forEach(m=>{try{let b=m.__asriSidememoHandlers;b&&(b.enter&&m.removeEventListener("mouseenter",b.enter),b.leave&&m.removeEventListener("mouseleave",b.leave),delete m.__asriSidememoHandlers);try{m.removeAttribute("asri-enhance-sidememo-uid")}catch(d){}try{m.classList.remove("asri-enhance-sidememo-highlight")}catch(d){}}catch(b){}})}catch(c){}}),Array.from(document.querySelectorAll(".asri-enhance-sidememo-container-resize")).forEach(l=>{try{l.classList.remove("asri-enhance-sidememo-container-resize")}catch(c){}}),Array.from(document.querySelectorAll(".protyle-title")).forEach(l=>{try{l.style.removeProperty("--asri-enhance-sidememo-title-height")}catch(c){}}),Array.from(document.querySelectorAll(".protyle-top")).forEach(l=>{try{l.classList.remove("asri-enhance-sidememo-protyle-title-none")}catch(c){}});let o=Array.from(document.querySelectorAll(".asri-enhance-sidememo"));o.forEach(l=>{try{l.style.removeProperty("--asri-enhance-sidememo-container-width")}catch(c){}}),o.forEach(l=>{try{l.classList.remove("asri-enhance-sidememo")}catch(c){}}),Array.from(document.querySelectorAll('[data-type*="inline-memo"][asri-enhance-sidememo-fold], [memo][asri-enhance-sidememo-fold]')).forEach(l=>{try{l.removeAttribute("asri-enhance-sidememo-fold")}catch(c){}}),Array.from(document.querySelectorAll(".tooltip--memo#tooltip")).forEach(l=>{try{l.classList.remove("asri-enhance-sidememo-tooltip-memo-none")}catch(c){}})}catch(n){}}async function hi(){if(!We)try{let n=an(/setUILayout|transactions|setBlockAttrs|getDoc|renameDoc/,e=>{try{setTimeout(()=>{try{Ae(),xt()}catch(t){}},200)}catch(t){}});We=()=>{try{n.disconnect()}catch(e){}We=null}}catch(n){}}function vn(){if(We){try{We()}catch(n){}We=null}}async function pi(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t)return;let a=t.hasAttribute("data-asri-enhance-side-memo"),r=await p(n,da)||{};a?(t.removeAttribute("data-asri-enhance-side-memo"),r[ha]=!1,yn(),Ae(),vn()):(t.setAttribute("data-asri-enhance-side-memo","true"),r[ha]=!0,await di().catch(()=>{}),Ae(),hi().catch(()=>{})),await k(n,da,r).catch(()=>{})}async function fi(n,e){bn=n;let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await p(n,da);a&&a[ha]===!0?(t.setAttribute("data-asri-enhance-side-memo","true"),await di().catch(()=>{}),Ae(),hi().catch(()=>{})):(t.removeAttribute("data-asri-enhance-side-memo"),yn(),Ae(),vn())}var pa="config.json",fa="asri-enhance-global-frosted-glass";async function gi(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t)return;let a=t.hasAttribute("data-asri-enhance-global-frosted-glass"),r=await p(n,pa)||{};a?(t.removeAttribute("data-asri-enhance-global-frosted-glass"),r[fa]=!1):(t.setAttribute("data-asri-enhance-global-frosted-glass","true"),r[fa]=!0),await k(n,pa,r).catch(()=>{})}async function bi(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await p(n,pa);a&&a[fa]===!0?t.setAttribute("data-asri-enhance-global-frosted-glass","true"):t.removeAttribute("data-asri-enhance-global-frosted-glass")}var ga="config.json",ba="asri-enhance-sidebar-top-sticky";async function yi(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t)return;let a=t.hasAttribute("data-asri-enhance-sidebar-top-sticky"),r=await p(n,ga)||{};a?(t.removeAttribute("data-asri-enhance-sidebar-top-sticky"),r[ba]=!1):(t.setAttribute("data-asri-enhance-sidebar-top-sticky","true"),r[ba]=!0),await k(n,ga,r).catch(()=>{})}async function vi(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await p(n,ga);a&&a[ba]===!0?t.setAttribute("data-asri-enhance-sidebar-top-sticky","true"):t.removeAttribute("data-asri-enhance-sidebar-top-sticky")}var ya="config.json",va="asri-enhance-hide-tab";async function Ei(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t)return;let a=t.hasAttribute("data-asri-enhance-hide-tab"),r=await p(n,ya)||{};a?(t.removeAttribute("data-asri-enhance-hide-tab"),r[va]=!1):(t.setAttribute("data-asri-enhance-hide-tab","true"),r[va]=!0),await k(n,ya,r).catch(()=>{})}async function ki(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await p(n,ya);a&&a[va]===!0?t.setAttribute("data-asri-enhance-hide-tab","true"):t.removeAttribute("data-asri-enhance-hide-tab")}var Ea="config.json",ka="asri-enhance-hide-breadcrumb";async function wi(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t)return;let a=t.hasAttribute("data-asri-enhance-hide-breadcrumb"),r=await p(n,Ea)||{};a?(t.removeAttribute("data-asri-enhance-hide-breadcrumb"),r[ka]=!1):(t.setAttribute("data-asri-enhance-hide-breadcrumb","true"),r[ka]=!0),await k(n,Ea,r).catch(()=>{})}async function Ci(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await p(n,Ea);a&&a[ka]===!0?t.setAttribute("data-asri-enhance-hide-breadcrumb","true"):t.removeAttribute("data-asri-enhance-hide-breadcrumb")}var wa="config.json",Ca="asri-enhance-moreanimations";async function Ti(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t)return;let a=t.hasAttribute("data-asri-enhance-moreanimations"),r=await p(n,wa)||{};a?(t.removeAttribute("data-asri-enhance-moreanimations"),r[Ca]=!1):(t.setAttribute("data-asri-enhance-moreanimations","true"),r[Ca]=!0),await k(n,wa,r).catch(()=>{})}async function xi(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await p(n,wa);a&&a[Ca]===!0?t.setAttribute("data-asri-enhance-moreanimations","true"):t.removeAttribute("data-asri-enhance-moreanimations")}var Ta="config.json",xa="asri-enhance-singlecolumnslashmenu",_t="data-asri-enhance-singlecolumnslashmenu";async function _i(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t)return;let a=t.hasAttribute(_t),r=await p(n,Ta)||{};a?(t.removeAttribute(_t),r[xa]=!1):(t.setAttribute(_t,"true"),r[xa]=!0),await k(n,Ta,r).catch(()=>{})}async function Ai(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await p(n,Ta);a&&a[xa]===!0?t.setAttribute(_t,"true"):t.removeAttribute(_t)}var _a="config.json",Aa="asri-enhance-cardsearchlist",At="data-asri-enhance-cardsearchlist";async function Li(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t)return;let a=t.hasAttribute(At),r=await p(n,_a)||{};a?(t.removeAttribute(At),r[Aa]=!1):(t.setAttribute(At,"true"),r[Aa]=!0),await k(n,_a,r).catch(()=>{})}async function Mi(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await p(n,_a);a&&a[Aa]===!0?t.setAttribute(At,"true"):t.removeAttribute(At)}var La="config.json",Pi="asri-enhance-windowtransparencyvalue",Ma="data-asri-enhance-windowtransparencyvalue";async function Si(n,e){e&&(e.preventDefault(),e.stopPropagation())}async function Hi(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await p(n,La),r=a==null?void 0:a[Pi];r!=null?t.setAttribute(Ma,String(r)):t.setAttribute(Ma,"0.5")}async function Ii(n,e){let t=await p(n,La)||{};t[Pi]=e,await k(n,La,t);let a=document.documentElement;a&&a.setAttribute(Ma,String(e))}var Pa="config.json",Sa="asri-enhance-wholewindowtransparency",Lt="data-asri-enhance-wholewindowtransparency";async function Ri(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t)return;let a=t.hasAttribute(Lt),r=await p(n,Pa)||{};a?(t.removeAttribute(Lt),r[Sa]=!1):(t.setAttribute(Lt,"true"),r[Sa]=!0),await k(n,Pa,r).catch(()=>{})}async function Ni(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await p(n,Pa);a&&a[Sa]===!0?t.setAttribute(Lt,"true"):t.removeAttribute(Lt)}var Ha="config.json",Ia="asri-enhance-smoothcaret",Ra="asri-enhance-smooth-caret-item",Mt=null,Pt=null,Ne=[],En=0,kn=null,wn=null,Na=null,$i=()=>{var i;(i=document.getElementById(Ra))==null||i.remove();let n=document.createElement("div");n.id=Ra,document.body.appendChild(n);let e=!1,t=s=>{if(s===kn)return En;let l=s;for(;l&&l!==document.body;){if(l.classList.contains("b3-dialog")||l.classList.contains("block__popover--open")||l.id==="commonMenu"){let m=window.getComputedStyle(l).zIndex,b=parseInt(m)||0;return En=b,kn=s,b}l=l.parentElement}return En=0,kn=s,0},a=()=>{var b,d,C;e=!1;let s=window.getSelection(),l=(b=s.focusNode)==null?void 0:b.parentElement;if((d=l==null?void 0:l.classList)!=null&&d.contains("av__cursor")){n.classList.add("asri-enhance-smooth-caret-item-none");return}if(((C=l==null?void 0:l.getAttribute)==null?void 0:C.call(l,"contenteditable"))==="false"){n.classList.add("asri-enhance-smooth-caret-item-none");return}let m=(l==null?void 0:l.closest('[contenteditable="true"]'))||(l!=null&&l.closest(".protyle-title")?l:null);if(s.rangeCount&&m){let g=s.getRangeAt(0),_=g.getClientRects()[0];if(!_||_.height===0){let w=null;try{let h=g.cloneRange();w=document.createTextNode("\u200B"),h.insertNode(w),h.selectNode(w),_=h.getBoundingClientRect()}catch(h){}finally{w!=null&&w.parentNode&&w.parentNode.removeChild(w)}}if(_){if(l!==Na&&(Na=l!=null?l:null,wn=l==null?void 0:l.closest(".protyle-content")),wn){let A=wn.getBoundingClientRect();if(!(_.left>=A.left&&_.top>=A.top&&_.right<=A.right&&_.bottom<=A.bottom)){n.classList.add("asri-enhance-smooth-caret-item-none");return}}n.classList.remove("asri-enhance-smooth-caret-item-none"),n.style.transform=`translate3d(${_.left-.75}px, ${_.top-_.height*.025}px, 0)`,n.style.height=`${_.height*1.05}px`;let w=t(m);n.style.zIndex=(w+1).toString();let h=null,y=s.focusNode;if(y)if(y.nodeType===Node.TEXT_NODE){let A=y.parentElement;A&&(h=window.getComputedStyle(A).color)}else y.nodeType===Node.ELEMENT_NODE&&(h=window.getComputedStyle(y).color);h||(h=window.getComputedStyle(m).color),h&&h!=="transparent"&&!/rgba?\([^)]*,\s*0\s*\)$/i.test(h)?n.style.setProperty("--asri-enhance-smooth-caret-color",h):n.style.removeProperty("--asri-enhance-smooth-caret-color");return}}n.classList.add("asri-enhance-smooth-caret-item-none")},r=()=>{e||(window.requestAnimationFrame(a),e=!0)},o=()=>{Ne.forEach(l=>clearTimeout(l)),Ne=[],[200,400,600].forEach(l=>{let c=window.setTimeout(()=>{r();let m=Ne.indexOf(c);m>-1&&Ne.splice(m,1)},l);Ne.push(c)})};Pt=o,Mt=r,document.addEventListener("selectionchange",r),document.addEventListener("scroll",r,{capture:!0,passive:!0}),document.addEventListener("keyup",o),document.addEventListener("mouseup",o),a()},Cn=()=>{var n;(n=document.getElementById(Ra))==null||n.remove(),Ne.forEach(e=>clearTimeout(e)),Ne=[],En=0,kn=null,wn=null,Na=null,Mt&&(document.removeEventListener("selectionchange",Mt),document.removeEventListener("scroll",Mt,{capture:!0}),Mt=null),Pt&&(document.removeEventListener("keyup",Pt),document.removeEventListener("mouseup",Pt),Pt=null)};async function Fi(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t)return;let a=t.hasAttribute("data-asri-enhance-smoothcaret"),r=await p(n,Ha)||{};a?(t.removeAttribute("data-asri-enhance-smoothcaret"),r[Ia]=!1,Cn()):(t.setAttribute("data-asri-enhance-smoothcaret","true"),r[Ia]=!0,$i()),await k(n,Ha,r).catch(()=>{})}async function Oi(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await p(n,Ha);a&&a[Ia]===!0?(t.setAttribute("data-asri-enhance-smoothcaret","true"),$i()):(t.removeAttribute("data-asri-enhance-smoothcaret"),Cn())}var Fa="config.json",Oa="asri-enhance-fluidcursor",Da="asri-enhance-fluid-cursor-canvas",Ue=null,Rt=null,Nt=null,$t=null,Ft=null,Ot=null,xn=null,W=[],ge={x:-100,y:-100},_n=0,X=null,ne=null,St=!0,Gl="#f44336",Kl=0,Xe=null,jl=200,Tn=!1,Vl=300,Ht=!1,It=0,Dt=0,Wl=.08,Ye={trailLength:8,widthBase:6,widthFactor:1.2,headEase:.9,tailStiffness:.4,zIndex:"999999",opacity:1},Di=()=>getComputedStyle(document.documentElement).getPropertyValue("--b3-theme-primary").trim()||"#f44336",$a=()=>{let n=Math.random(),e=Di();if(n<.02){let t=Math.random(),a;t<.8?a=Math.floor(Math.random()*31)-15:t<.9?a=(Math.random()<.5?-1:1)*(Math.floor(Math.random()*31)+30):a=(Math.random()<.5?-1:1)*(Math.floor(Math.random()*91)+90),Gl=`oklch(from ${e} l c calc(h + ${Ht?180:0} + ${a}))`,It=a,Dt=a}else{let t=Math.random(),a;t<.6?a=Math.floor(Math.random()*31)-15:t<.8?a=(Math.random()<.5?-1:1)*(Math.floor(Math.random()*31)+30):a=(Math.random()<.5?-1:1)*(Math.floor(Math.random()*91)+90),Dt=a}},Bi=()=>{let n=document.getElementById(Da);n&&n.remove(),X=document.createElement("canvas"),X.id=Da,Object.assign(X.style,{position:"fixed",top:"0",left:"0",pointerEvents:"none",zIndex:Ye.zIndex,opacity:"0"}),document.body.appendChild(X),ne=X.getContext("2d"),Ht=!1,$a(),ge={x:-100,y:-100},W=[],St=!0,Tn=!1;let e=()=>{if(!X)return;let a=window.devicePixelRatio||1;X.width=window.innerWidth*a,X.height=window.innerHeight*a,X.style.width=window.innerWidth+"px",X.style.height=window.innerHeight+"px",ne&&ne.scale(a,a)};Rt=e,e(),Nt=a=>{if(St){St=!1,ge.x=a.clientX,ge.y=a.clientY;for(let r=0;r<Ye.trailLength;r++)W.push({x:ge.x,y:ge.y})}else ge.x=a.clientX,ge.y=a.clientY;$a(),Kl=Date.now(),!Tn&&X&&(Tn=!0,X.style.transition="none",X.style.opacity="1"),Xe!==null&&clearTimeout(Xe),Xe=window.setTimeout(()=>{Tn=!1,X&&(X.style.transition=`opacity ${Vl}ms ease-out`,X.style.opacity="0")},jl)},window.addEventListener("resize",Rt),window.addEventListener("mousemove",Nt,{passive:!0}),$t=()=>{Ht=!0},Ft=()=>{Ht=!1,Dt=0},window.addEventListener("mousedown",$t,{passive:!0}),window.addEventListener("mouseup",Ft,{passive:!0}),Ot=()=>{W=[],St=!0},document.addEventListener("mouseleave",Ot);let t=a=>{if(!X||!ne)return;let r=(a-_n)/1e3;_n=a;let o=r*60,i=Dt-It;Math.abs(i)>.5?It+=i*Wl*o:It=Dt;let c=`oklch(from ${Di()} l c calc(h + ${Ht?180:0} + ${It}))`;if(ne.clearRect(0,0,window.innerWidth,window.innerHeight),St){Ue=window.requestAnimationFrame(t);return}let m=1-Math.pow(1-Ye.headEase,o),b=1-Math.pow(1-Ye.tailStiffness,o);W[0].x+=(ge.x-W[0].x)*m,W[0].y+=(ge.y-W[0].y)*m;for(let d=1;d<W.length;d++)W[d].x+=(W[d-1].x-W[d].x)*b,W[d].y+=(W[d-1].y-W[d].y)*b;ne.strokeStyle=c,ne.lineCap="round",ne.lineJoin="round";for(let d=0;d<W.length-1;d++){let C=Math.max(0,Ye.widthBase-d*Ye.widthFactor);ne.beginPath(),ne.lineWidth=C,ne.moveTo(W[d].x,W[d].y),ne.lineTo(W[d+1].x,W[d+1].y),ne.stroke()}Ue=window.requestAnimationFrame(t)};_n=performance.now(),Ue=window.requestAnimationFrame(t),xn=window.setInterval($a,3e3)},An=()=>{let n=document.getElementById(Da);n&&n.remove(),Ue!==null&&(window.cancelAnimationFrame(Ue),Ue=null),xn!==null&&(window.clearInterval(xn),xn=null),Xe!==null&&(clearTimeout(Xe),Xe=null),Rt&&(window.removeEventListener("resize",Rt),Rt=null),Nt&&(window.removeEventListener("mousemove",Nt),Nt=null),$t&&(window.removeEventListener("mousedown",$t),$t=null),Ft&&(window.removeEventListener("mouseup",Ft),Ft=null),Ot&&(document.removeEventListener("mouseleave",Ot),Ot=null),W=[],ge={x:0,y:0},_n=0,X=null,ne=null};async function qi(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t)return;let a=t.hasAttribute("data-asri-enhance-fluidcursor"),r=await p(n,Fa)||{};a?(t.removeAttribute("data-asri-enhance-fluidcursor"),r[Oa]=!1,An()):(t.setAttribute("data-asri-enhance-fluidcursor","true"),r[Oa]=!0,Bi()),await k(n,Fa,r).catch(()=>{})}async function zi(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await p(n,Fa);a&&a[Oa]===!0?(t.setAttribute("data-asri-enhance-fluidcursor","true"),Bi()):(t.removeAttribute("data-asri-enhance-fluidcursor"),An())}var Ba="config.json",qa="asri-enhance-island-layout",Ln=class{constructor(){this.hasFullscreen=!1;this.timer=null;this.isActive=!0;this.onFullscreenChange=null}start(e){this.onFullscreenChange=e||null,this.check(),document.addEventListener("visibilitychange",()=>{this.isActive=document.visibilityState==="visible",this.isActive&&this.check()});let t=()=>{this.isActive&&this.check(),this.timer=setTimeout(t,this.isActive?200:1e3)};this.timer=setTimeout(t,200)}check(){var t;let e=document.querySelector(".protyle.fullscreen:not(.fn__none)")!==null;e!==this.hasFullscreen&&(this.hasFullscreen=e,document.body.classList.toggle("asri-enhance-has-fullscreen",e),(t=this.onFullscreenChange)==null||t.call(this,e))}stop(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.hasFullscreen&&(this.hasFullscreen=!1,document.body.classList.remove("asri-enhance-has-fullscreen"))}},Le=null;async function Gi(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t)return;let a=t.hasAttribute("data-asri-enhance-island-layout"),r=await p(n,Ba)||{};a?(t.removeAttribute("data-asri-enhance-island-layout"),r[qa]=!1,Bt(),Le==null||Le.stop(),Le=null):(t.setAttribute("data-asri-enhance-island-layout","true"),r[qa]=!0,Mn(),Le=new Ln,Le.start(o=>{var i;(i=document.body)!=null&&i.classList.contains("body--window")||(o?Bt():Mn())})),await k(n,Ba,r).catch(()=>{})}function Mn(){var e,t;let n=window;if(typeof window!="undefined"&&n.process&&n.require)try{let{BrowserWindow:a}=n.require("@electron/remote");if(n.process.platform==="darwin"){if((e=document.body)!=null&&e.classList.contains("body--window"))return;(t=a.getFocusedWindow())==null||t.setWindowButtonPosition({x:16,y:24})}}catch(a){}}function Bt(){var e;let n=window;if(typeof window!="undefined"&&n.process&&n.require)try{let{BrowserWindow:t}=n.require("@electron/remote");n.process.platform==="darwin"&&((e=t.getFocusedWindow())==null||e.setWindowButtonPosition({x:16,y:16}))}catch(t){}}async function Ki(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await p(n,Ba);a&&a[qa]===!0?(t.setAttribute("data-asri-enhance-island-layout","true"),Mn(),Le=new Ln,Le.start(r=>{var o;(o=document.body)!=null&&o.classList.contains("body--window")||(r?Bt():Mn())})):t.removeAttribute("data-asri-enhance-island-layout")}var za="config.json",Ga="asri-enhance-paper",qt="data-asri-enhance-paper",ji=["asri-enhance-noise","asri-enhance-acrylic","asri-enhance-checkerboard","asri-enhance-grid","asri-enhance-polkadot","asri-enhance-crossdot","asri-enhance-honeycomb","asri-enhance-wood","asri-enhance-camouflage","asri-enhance-fiber","asri-enhance-fabric"],Yl=["data-asri-enhance-noise","data-asri-enhance-acrylic","data-asri-enhance-checkerboard","data-asri-enhance-grid","data-asri-enhance-polkadot","data-asri-enhance-crossdot","data-asri-enhance-honeycomb","data-asri-enhance-wood","data-asri-enhance-camouflage","data-asri-enhance-fiber","data-asri-enhance-fabric"];function Vi(n,e){e.preventDefault(),e.stopPropagation(),p(n,za).then(t=>{let r=!((t==null?void 0:t[Ga])||!1),o={...t,[Ga]:r};r&&ji.forEach(i=>{o[i]=!1}),k(n,za,o).then(()=>{Yl.forEach(i=>{document.documentElement.removeAttribute(i)}),r?document.documentElement.setAttribute(qt,"true"):document.documentElement.removeAttribute(qt)}).catch(()=>{})}).catch(()=>{})}async function Wi(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await p(n,za),r=a==null?void 0:a[Ga],o=ji.some(i=>(a==null?void 0:a[i])===!0||(a==null?void 0:a[i])==="true");r===!0||r==="true"?o?t.removeAttribute(qt):t.setAttribute(qt,"true"):t.removeAttribute(qt)}var Ka="config.json",ja="asri-enhance-noise",zt="data-asri-enhance-noise",Yi=["asri-enhance-paper","asri-enhance-acrylic","asri-enhance-checkerboard","asri-enhance-grid","asri-enhance-polkadot","asri-enhance-crossdot","asri-enhance-honeycomb","asri-enhance-wood","asri-enhance-camouflage","asri-enhance-fiber","asri-enhance-fabric"],Ul=["data-asri-enhance-paper","data-asri-enhance-acrylic","data-asri-enhance-checkerboard","data-asri-enhance-grid","data-asri-enhance-polkadot","data-asri-enhance-crossdot","data-asri-enhance-honeycomb","data-asri-enhance-wood","data-asri-enhance-camouflage","data-asri-enhance-fiber","data-asri-enhance-fabric"];function Ui(n,e){e.preventDefault(),e.stopPropagation(),p(n,Ka).then(t=>{let r=!((t==null?void 0:t[ja])||!1),o={...t,[ja]:r};r&&Yi.forEach(i=>{o[i]=!1}),k(n,Ka,o).then(()=>{Ul.forEach(i=>{document.documentElement.removeAttribute(i)}),r?document.documentElement.setAttribute(zt,"true"):document.documentElement.removeAttribute(zt)}).catch(()=>{})}).catch(()=>{})}async function Xi(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await p(n,Ka),r=a==null?void 0:a[ja],o=Yi.some(i=>(a==null?void 0:a[i])===!0||(a==null?void 0:a[i])==="true");r===!0||r==="true"?o?t.removeAttribute(zt):t.setAttribute(zt,"true"):t.removeAttribute(zt)}var Va="config.json",Wa="asri-enhance-acrylic",Gt="data-asri-enhance-acrylic",Zi=["asri-enhance-paper","asri-enhance-noise","asri-enhance-checkerboard","asri-enhance-grid","asri-enhance-polkadot","asri-enhance-crossdot","asri-enhance-honeycomb","asri-enhance-wood","asri-enhance-camouflage","asri-enhance-fiber","asri-enhance-fabric"],Xl=["data-asri-enhance-paper","data-asri-enhance-noise","data-asri-enhance-checkerboard","data-asri-enhance-grid","data-asri-enhance-polkadot","data-asri-enhance-crossdot","data-asri-enhance-honeycomb","data-asri-enhance-wood","data-asri-enhance-camouflage","data-asri-enhance-fiber","data-asri-enhance-fabric"];function Qi(n,e){e.preventDefault(),e.stopPropagation(),p(n,Va).then(t=>{let r=!((t==null?void 0:t[Wa])||!1),o={...t,[Wa]:r};r&&Zi.forEach(i=>{o[i]=!1}),k(n,Va,o).then(()=>{Xl.forEach(i=>{document.documentElement.removeAttribute(i)}),r?document.documentElement.setAttribute(Gt,"true"):document.documentElement.removeAttribute(Gt)}).catch(()=>{})}).catch(()=>{})}async function Ji(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await p(n,Va),r=a==null?void 0:a[Wa],o=Zi.some(i=>(a==null?void 0:a[i])===!0||(a==null?void 0:a[i])==="true");r===!0||r==="true"?o?t.removeAttribute(Gt):t.setAttribute(Gt,"true"):t.removeAttribute(Gt)}var Ya="config.json",Ua="asri-enhance-checkerboard",Kt="data-asri-enhance-checkerboard",es=["asri-enhance-paper","asri-enhance-noise","asri-enhance-acrylic","asri-enhance-grid","asri-enhance-polkadot","asri-enhance-crossdot","asri-enhance-honeycomb","asri-enhance-wood","asri-enhance-camouflage","asri-enhance-fiber","asri-enhance-fabric"],Zl=["data-asri-enhance-paper","data-asri-enhance-noise","data-asri-enhance-acrylic","data-asri-enhance-grid","data-asri-enhance-polkadot","data-asri-enhance-crossdot","data-asri-enhance-honeycomb","data-asri-enhance-wood","data-asri-enhance-camouflage","data-asri-enhance-fiber","data-asri-enhance-fabric"];function ts(n,e){e.preventDefault(),e.stopPropagation(),p(n,Ya).then(t=>{let r=!((t==null?void 0:t[Ua])||!1),o={...t,[Ua]:r};r&&es.forEach(i=>{o[i]=!1}),k(n,Ya,o).then(()=>{Zl.forEach(i=>{document.documentElement.removeAttribute(i)}),r?document.documentElement.setAttribute(Kt,"true"):document.documentElement.removeAttribute(Kt)}).catch(()=>{})}).catch(()=>{})}async function ns(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await p(n,Ya),r=a==null?void 0:a[Ua],o=es.some(i=>(a==null?void 0:a[i])===!0||(a==null?void 0:a[i])==="true");r===!0||r==="true"?o?t.removeAttribute(Kt):t.setAttribute(Kt,"true"):t.removeAttribute(Kt)}var Xa="config.json",Za="asri-enhance-grid",jt="data-asri-enhance-grid",as=["asri-enhance-paper","asri-enhance-noise","asri-enhance-acrylic","asri-enhance-checkerboard","asri-enhance-polkadot","asri-enhance-crossdot","asri-enhance-honeycomb","asri-enhance-wood","asri-enhance-camouflage","asri-enhance-fiber","asri-enhance-fabric"],Ql=["data-asri-enhance-paper","data-asri-enhance-noise","data-asri-enhance-acrylic","data-asri-enhance-checkerboard","data-asri-enhance-polkadot","data-asri-enhance-crossdot","data-asri-enhance-honeycomb","data-asri-enhance-wood","data-asri-enhance-camouflage","data-asri-enhance-fiber","data-asri-enhance-fabric"];function rs(n,e){e.preventDefault(),e.stopPropagation(),p(n,Xa).then(t=>{let r=!((t==null?void 0:t[Za])||!1),o={...t,[Za]:r};r&&as.forEach(i=>{o[i]=!1}),k(n,Xa,o).then(()=>{Ql.forEach(i=>{document.documentElement.removeAttribute(i)}),r?document.documentElement.setAttribute(jt,"true"):document.documentElement.removeAttribute(jt)}).catch(()=>{})}).catch(()=>{})}async function os(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await p(n,Xa),r=a==null?void 0:a[Za],o=as.some(i=>(a==null?void 0:a[i])===!0||(a==null?void 0:a[i])==="true");r===!0||r==="true"?o?t.removeAttribute(jt):t.setAttribute(jt,"true"):t.removeAttribute(jt)}var Qa="config.json",Ja="asri-enhance-polkadot",Vt="data-asri-enhance-polkadot",is=["asri-enhance-paper","asri-enhance-noise","asri-enhance-acrylic","asri-enhance-checkerboard","asri-enhance-grid","asri-enhance-crossdot","asri-enhance-honeycomb","asri-enhance-wood","asri-enhance-camouflage","asri-enhance-fiber","asri-enhance-fabric"],Jl=["data-asri-enhance-paper","data-asri-enhance-noise","data-asri-enhance-acrylic","data-asri-enhance-checkerboard","data-asri-enhance-grid","data-asri-enhance-crossdot","data-asri-enhance-honeycomb","data-asri-enhance-wood","data-asri-enhance-camouflage","data-asri-enhance-fiber","data-asri-enhance-fabric"];function ss(n,e){e.preventDefault(),e.stopPropagation(),p(n,Qa).then(t=>{let r=!((t==null?void 0:t[Ja])||!1),o={...t,[Ja]:r};r&&is.forEach(i=>{o[i]=!1}),k(n,Qa,o).then(()=>{Jl.forEach(i=>{document.documentElement.removeAttribute(i)}),r?document.documentElement.setAttribute(Vt,"true"):document.documentElement.removeAttribute(Vt)}).catch(()=>{})}).catch(()=>{})}async function ls(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await p(n,Qa),r=a==null?void 0:a[Ja],o=is.some(i=>(a==null?void 0:a[i])===!0||(a==null?void 0:a[i])==="true");r===!0||r==="true"?o?t.removeAttribute(Vt):t.setAttribute(Vt,"true"):t.removeAttribute(Vt)}var er="config.json",tr="asri-enhance-crossdot",Wt="data-asri-enhance-crossdot",cs=["asri-enhance-paper","asri-enhance-noise","asri-enhance-acrylic","asri-enhance-checkerboard","asri-enhance-grid","asri-enhance-polkadot","asri-enhance-honeycomb","asri-enhance-wood","asri-enhance-camouflage","asri-enhance-fiber","asri-enhance-fabric"],ec=["data-asri-enhance-paper","data-asri-enhance-noise","data-asri-enhance-acrylic","data-asri-enhance-checkerboard","data-asri-enhance-grid","data-asri-enhance-polkadot","data-asri-enhance-honeycomb","data-asri-enhance-wood","data-asri-enhance-camouflage","data-asri-enhance-fiber","data-asri-enhance-fabric"];function us(n,e){e.preventDefault(),e.stopPropagation(),p(n,er).then(t=>{let r=!((t==null?void 0:t[tr])||!1),o={...t,[tr]:r};r&&cs.forEach(i=>{o[i]=!1}),k(n,er,o).then(()=>{ec.forEach(i=>{document.documentElement.removeAttribute(i)}),r?document.documentElement.setAttribute(Wt,"true"):document.documentElement.removeAttribute(Wt)}).catch(()=>{})}).catch(()=>{})}async function ms(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await p(n,er),r=a==null?void 0:a[tr],o=cs.some(i=>(a==null?void 0:a[i])===!0||(a==null?void 0:a[i])==="true");r===!0||r==="true"?o?t.removeAttribute(Wt):t.setAttribute(Wt,"true"):t.removeAttribute(Wt)}var nr="config.json",ar="asri-enhance-honeycomb",Yt="data-asri-enhance-honeycomb",ds=["asri-enhance-paper","asri-enhance-noise","asri-enhance-acrylic","asri-enhance-checkerboard","asri-enhance-grid","asri-enhance-polkadot","asri-enhance-crossdot","asri-enhance-wood","asri-enhance-camouflage","asri-enhance-fiber","asri-enhance-fabric"],tc=["data-asri-enhance-paper","data-asri-enhance-noise","data-asri-enhance-acrylic","data-asri-enhance-checkerboard","data-asri-enhance-grid","data-asri-enhance-polkadot","data-asri-enhance-crossdot","data-asri-enhance-wood","data-asri-enhance-camouflage","data-asri-enhance-fiber","data-asri-enhance-fabric"];function hs(n,e){e.preventDefault(),e.stopPropagation(),p(n,nr).then(t=>{let r=!((t==null?void 0:t[ar])||!1),o={...t,[ar]:r};r&&ds.forEach(i=>{o[i]=!1}),k(n,nr,o).then(()=>{tc.forEach(i=>{document.documentElement.removeAttribute(i)}),r?document.documentElement.setAttribute(Yt,"true"):document.documentElement.removeAttribute(Yt)}).catch(()=>{})}).catch(()=>{})}async function ps(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await p(n,nr),r=a==null?void 0:a[ar],o=ds.some(i=>(a==null?void 0:a[i])===!0||(a==null?void 0:a[i])==="true");r===!0||r==="true"?o?t.removeAttribute(Yt):t.setAttribute(Yt,"true"):t.removeAttribute(Yt)}var rr="config.json",or="asri-enhance-wood",Ut="data-asri-enhance-wood",fs=["asri-enhance-paper","asri-enhance-noise","asri-enhance-acrylic","asri-enhance-checkerboard","asri-enhance-grid","asri-enhance-polkadot","asri-enhance-crossdot","asri-enhance-honeycomb","asri-enhance-camouflage","asri-enhance-fiber","asri-enhance-fabric"],nc=["data-asri-enhance-paper","data-asri-enhance-noise","data-asri-enhance-acrylic","data-asri-enhance-checkerboard","data-asri-enhance-grid","data-asri-enhance-polkadot","data-asri-enhance-crossdot","data-asri-enhance-honeycomb","data-asri-enhance-camouflage","data-asri-enhance-fiber","data-asri-enhance-fabric"];function gs(n,e){e.preventDefault(),e.stopPropagation(),p(n,rr).then(t=>{let r=!((t==null?void 0:t[or])||!1),o={...t,[or]:r};r&&fs.forEach(i=>{o[i]=!1}),k(n,rr,o).then(()=>{nc.forEach(i=>{document.documentElement.removeAttribute(i)}),r?document.documentElement.setAttribute(Ut,"true"):document.documentElement.removeAttribute(Ut)}).catch(()=>{})}).catch(()=>{})}async function bs(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await p(n,rr),r=a==null?void 0:a[or],o=fs.some(i=>(a==null?void 0:a[i])===!0||(a==null?void 0:a[i])==="true");r===!0||r==="true"?o?t.removeAttribute(Ut):t.setAttribute(Ut,"true"):t.removeAttribute(Ut)}var ir="config.json",sr="asri-enhance-camouflage",Xt="data-asri-enhance-camouflage",ys=["asri-enhance-paper","asri-enhance-noise","asri-enhance-acrylic","asri-enhance-checkerboard","asri-enhance-grid","asri-enhance-polkadot","asri-enhance-crossdot","asri-enhance-honeycomb","asri-enhance-wood","asri-enhance-fiber","asri-enhance-fabric"],ac=["data-asri-enhance-paper","data-asri-enhance-noise","data-asri-enhance-acrylic","data-asri-enhance-checkerboard","data-asri-enhance-grid","data-asri-enhance-polkadot","data-asri-enhance-crossdot","data-asri-enhance-honeycomb","data-asri-enhance-wood","data-asri-enhance-fiber","data-asri-enhance-fabric"];function vs(n,e){e.preventDefault(),e.stopPropagation(),p(n,ir).then(t=>{let r=!((t==null?void 0:t[sr])||!1),o={...t,[sr]:r};r&&ys.forEach(i=>{o[i]=!1}),k(n,ir,o).then(()=>{ac.forEach(i=>{document.documentElement.removeAttribute(i)}),r?document.documentElement.setAttribute(Xt,"true"):document.documentElement.removeAttribute(Xt)}).catch(()=>{})}).catch(()=>{})}async function Es(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await p(n,ir),r=a==null?void 0:a[sr],o=ys.some(i=>(a==null?void 0:a[i])===!0||(a==null?void 0:a[i])==="true");r===!0||r==="true"?o?t.removeAttribute(Xt):t.setAttribute(Xt,"true"):t.removeAttribute(Xt)}var lr="config.json",cr="asri-enhance-fiber",Zt="data-asri-enhance-fiber",ks=["asri-enhance-paper","asri-enhance-noise","asri-enhance-acrylic","asri-enhance-checkerboard","asri-enhance-grid","asri-enhance-polkadot","asri-enhance-crossdot","asri-enhance-honeycomb","asri-enhance-wood","asri-enhance-camouflage","asri-enhance-fabric"],rc=["data-asri-enhance-paper","data-asri-enhance-noise","data-asri-enhance-acrylic","data-asri-enhance-checkerboard","data-asri-enhance-grid","data-asri-enhance-polkadot","data-asri-enhance-crossdot","data-asri-enhance-honeycomb","data-asri-enhance-wood","data-asri-enhance-camouflage","data-asri-enhance-fabric"];function ws(n,e){e.preventDefault(),e.stopPropagation(),p(n,lr).then(t=>{let r=!((t==null?void 0:t[cr])||!1),o={...t,[cr]:r};r&&ks.forEach(i=>{o[i]=!1}),k(n,lr,o).then(()=>{rc.forEach(i=>{document.documentElement.removeAttribute(i)}),r?document.documentElement.setAttribute(Zt,"true"):document.documentElement.removeAttribute(Zt)}).catch(()=>{})}).catch(()=>{})}async function Cs(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await p(n,lr),r=a==null?void 0:a[cr],o=ks.some(i=>(a==null?void 0:a[i])===!0||(a==null?void 0:a[i])==="true");r===!0||r==="true"?o?t.removeAttribute(Zt):t.setAttribute(Zt,"true"):t.removeAttribute(Zt)}var ur="config.json",mr="asri-enhance-fabric",Qt="data-asri-enhance-fabric",Ts=["asri-enhance-paper","asri-enhance-noise","asri-enhance-acrylic","asri-enhance-checkerboard","asri-enhance-grid","asri-enhance-polkadot","asri-enhance-crossdot","asri-enhance-honeycomb","asri-enhance-wood","asri-enhance-camouflage","asri-enhance-fiber"],oc=["data-asri-enhance-paper","data-asri-enhance-noise","data-asri-enhance-acrylic","data-asri-enhance-checkerboard","data-asri-enhance-grid","data-asri-enhance-polkadot","data-asri-enhance-crossdot","data-asri-enhance-honeycomb","data-asri-enhance-wood","data-asri-enhance-camouflage","data-asri-enhance-fiber"];function xs(n,e){e.preventDefault(),e.stopPropagation(),p(n,ur).then(t=>{let r=!((t==null?void 0:t[mr])||!1),o={...t,[mr]:r};r&&Ts.forEach(i=>{o[i]=!1}),k(n,ur,o).then(()=>{oc.forEach(i=>{document.documentElement.removeAttribute(i)}),r?document.documentElement.setAttribute(Qt,"true"):document.documentElement.removeAttribute(Qt)}).catch(()=>{})}).catch(()=>{})}async function _s(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await p(n,ur),r=a==null?void 0:a[mr],o=Ts.some(i=>(a==null?void 0:a[i])===!0||(a==null?void 0:a[i])==="true");r===!0||r==="true"?o?t.removeAttribute(Qt):t.setAttribute(Qt,"true"):t.removeAttribute(Qt)}var dr="config.json",hr="asri-enhance-typewriter",Me=null,pr=!1,$e=null,Fe=null,Ze=null,As=null,Ls=null,ic=600,Ms=100,sc=()=>{let n=window.getSelection();if(!n||n.rangeCount===0)return;let e=n.getRangeAt(0),t=e.getClientRects()[0];if(!t||t.height===0){let d=null;try{let C=e.cloneRange();d=document.createTextNode("\u200B"),C.insertNode(d),C.selectNode(d),t=C.getBoundingClientRect()}catch(C){}finally{d!=null&&d.parentNode&&d.parentNode.removeChild(d)}}if(!t)return;let a=null,r=e.startContainer instanceof HTMLElement?e.startContainer:e.startContainer.parentElement;for(;r&&r!==document.body;){if(r.classList.contains("protyle-content")){a=r;break}let d=getComputedStyle(r).overflowY;(d==="auto"||d==="scroll")&&(a=r),r=r.parentElement}if(!a){let d=document.querySelectorAll(".protyle-content");for(let C of d){let g=C.getBoundingClientRect();if(t.top>=g.top&&t.top<=g.bottom){a=C;break}}}a||(a=document.documentElement);let o=a.getBoundingClientRect(),i=o.height/2,s=a.scrollTop+t.top-o.top-i+t.height/2;pr=!0;let l=a.scrollTop,c=s-l,m=performance.now(),b=d=>{let C=d-m,g=Math.min(C/ic,1),_=g<.5?4*g*g*g:1-Math.pow(-2*g+2,3)/2;if(a.scrollTop=l+c*_,g<1)Fe=requestAnimationFrame(b);else{let w=window.getSelection();if(w&&w.rangeCount>0){let y=w.getRangeAt(0).getClientRects()[0];y&&lc(y,o,a)}$e!==null&&clearTimeout($e),$e=window.setTimeout(()=>{pr=!1,$e=null},Ms)}};Fe!==null&&cancelAnimationFrame(Fe),Fe=requestAnimationFrame(b)},lc=(n,e,t)=>{let a=n.top+n.height/2,r=e.top,o=e.height,l=`${(a-r)/o*100}%`,c=`${n.height*.75}px`,m=null,b=window.getSelection(),d=b==null?void 0:b.focusNode;if(d)if(d.nodeType===Node.TEXT_NODE){let C=d.parentElement;C&&(m=getComputedStyle(C).color)}else d.nodeType===Node.ELEMENT_NODE&&(m=getComputedStyle(d).color);m||(m=getComputedStyle(t).color),(As!==l||Ls!==c)&&(As=l,Ls=c,t.style.setProperty("--asri-enhance-focus-mask-position",l),t.style.setProperty("--asri-enhance-focus-mask-height",c)),m&&t.style.setProperty("--asri-enhance-focus-text-color",m)},Ps=()=>{Me&&(document.removeEventListener("selectionchange",Me),Me=null),Me=()=>{Ze===null&&(Ze=window.setTimeout(()=>{Ze=null},Ms),requestAnimationFrame(()=>{sc()}))},document.addEventListener("selectionchange",Me)},Pn=()=>{Fe!==null&&(cancelAnimationFrame(Fe),Fe=null),$e!==null&&(clearTimeout($e),$e=null),Ze!==null&&(clearTimeout(Ze),Ze=null),Me&&(document.removeEventListener("selectionchange",Me),Me=null),pr=!1};async function Sn(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t)return;let a=t.hasAttribute("data-asri-enhance-typewriter"),r=await p(n,dr)||{};a?(t.removeAttribute("data-asri-enhance-typewriter"),r[hr]=!1,Pn()):(t.setAttribute("data-asri-enhance-typewriter","true"),r[hr]=!0,Ps()),await k(n,dr,r).catch(()=>{})}async function Ss(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await p(n,dr);a&&a[hr]===!0?(t.setAttribute("data-asri-enhance-typewriter","true"),Ps()):(t.removeAttribute("data-asri-enhance-typewriter"),Pn())}var fr="config.json",gr="asri-enhance-focus";async function Hn(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t)return;let a=t.hasAttribute("data-asri-enhance-focus"),r=await p(n,fr)||{};a?(t.removeAttribute("data-asri-enhance-focus"),r[gr]=!1):(t.setAttribute("data-asri-enhance-focus","true"),r[gr]=!0),await k(n,fr,r).catch(()=>{})}async function Hs(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await p(n,fr);a&&a[gr]===!0?t.setAttribute("data-asri-enhance-focus","true"):t.removeAttribute("data-asri-enhance-focus")}var le='<svg class="b3-menu__icon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M19 3h-4a2 2 0 0 0-2 2v12a4 4 0 0 0 8 0V5a2 2 0 0 0-2-2"></path><path d="m13 7.35l-2-2a2 2 0 0 0-2.828 0L5.344 8.178a2 2 0 0 0 0 2.828l9 9"></path><path d="M7.3 13H5a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h12m0-4v.01"></path></g></svg>',S='<svg class="b3-menu__icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em"><path d="M512 443.733333a68.266667 68.266667 0 1 1-0.034133 136.567467A68.266667 68.266667 0 0 1 512 443.733333z m0-238.933333a68.266667 68.266667 0 1 1-0.034133 136.567467A68.266667 68.266667 0 0 1 512 204.8z m0 477.866667a68.266667 68.266667 0 1 1-0.034133 136.567466A68.266667 68.266667 0 0 1 512 682.666667z" fill="currentColor"></path></svg>';function Is(n,e,t=0){let a,r,o=null,i=0,s=new Set,l=10,c=100,m=()=>{s.forEach(g=>window.clearTimeout(g)),s.clear()},b=(g,_)=>{let w=window.setTimeout(()=>{s.delete(w),g()},_);return s.add(w),w},d=g=>{a!==void 0&&window.clearTimeout(a),a=window.setTimeout(()=>{m();let _=(w=0)=>{var y,A,N,q,D,z,T,$,O,L,G,F,M,P;let h=document.querySelector('#commonMenu[data-name="barmode"] #pickColor');if(h){let E=h.parentElement;if(E){if(!E.querySelector("#asri-enhance-palette")){let I=document.createElement("button");I.className="b3-menu__item asri-enhance",I.id="asri-enhance-palette",I.innerHTML=`${S}<span class="b3-menu__label">${((y=n.i18n)==null?void 0:y.morePresetColors)||"morePresetColors"}</span><svg class="b3-menu__icon b3-menu__icon--small"><use xlink:href="#iconRight"></use></svg><div class="b3-menu__submenu"><div class="b3-menu__items"><button class="b3-menu__item" id="asri-enhance-sakura">${le}<span class="b3-menu__label">${((A=n.i18n)==null?void 0:A.sakura)||"Sakura"}</span></button><button class="b3-menu__item" id="asri-enhance-amber">${le}<span class="b3-menu__label">${((N=n.i18n)==null?void 0:N.amber)||"amber"}</span></button><button class="b3-menu__item" id="asri-enhance-wilderness">${le}<span class="b3-menu__label">${((q=n.i18n)==null?void 0:q.wilderness)||"wilderness"}</span></button><button class="b3-menu__item" id="asri-enhance-midnight">${le}<span class="b3-menu__label">${((D=n.i18n)==null?void 0:D.midnight)||"midnight"}</span></button><button class="b3-menu__item" id="asri-enhance-salt">${le}<span class="b3-menu__label">${((z=n.i18n)==null?void 0:z.salt)||"salt"}</span></button><button class="b3-menu__item" id="asri-enhance-rosepine">${le}<span class="b3-menu__label">${((T=n.i18n)==null?void 0:T.rosePine)||"Ros\xE9 Pine"}</span></button><button class="b3-menu__item" id="asri-enhance-topaz">${le}<span class="b3-menu__label">${(($=n.i18n)==null?void 0:$.goldenTopaz)||"Golden Topaz"}</span></button><button class="b3-menu__item" id="asri-enhance-oxygen">${le}<span class="b3-menu__label">${((O=n.i18n)==null?void 0:O.oxygen)||"Oxygen"}</span></button><button class="b3-menu__item" id="asri-enhance-shade">${le}<span class="b3-menu__label">${((L=n.i18n)==null?void 0:L.shade)||"Shade"}</span></button><button class="b3-menu__item" id="asri-enhance-gruvbox">${le}<span class="b3-menu__label">${((G=n.i18n)==null?void 0:G.gruvbox)||"Gruvbox"}</span></button><button class="b3-menu__item" id="asri-enhance-glitch">${le}<span class="b3-menu__label">${((F=n.i18n)==null?void 0:F.glitch)||"glitch"}</span></button><button class="b3-menu__item" id="asri-enhance-nostalgia">${le}<span class="b3-menu__label">${((M=n.i18n)==null?void 0:M.nostalgia)||"\u56DE\u5FC6"}</span></button></div></div>`;let re=h,te=h.previousElementSibling;for(;te;){if(te.classList&&te.classList.contains("b3-menu__separator")){re=te;break}te=te.previousElementSibling}E.insertBefore(I,re)}let H=E.querySelector("#asri-enhance-amber");H&&(H.onclick=I=>Kr(n,I));let V=E.querySelector("#asri-enhance-sakura");V&&(V.onclick=I=>Wr(n,I));let ee=E.querySelector("#asri-enhance-wilderness");ee&&(ee.onclick=I=>Xr(n,I));let Q=E.querySelector("#asri-enhance-midnight");Q&&(Q.onclick=I=>Jr(n,I));let Z=E.querySelector("#asri-enhance-salt");Z&&(Z.onclick=I=>no(n,I));let se=E.querySelector("#asri-enhance-rosepine");se&&(se.onclick=I=>oo(n,I));let ce=E.querySelector("#asri-enhance-topaz");ce&&(ce.onclick=I=>lo(n,I));let ue=E.querySelector("#asri-enhance-oxygen");ue&&(ue.onclick=I=>mo(n,I));let we=E.querySelector("#asri-enhance-shade");we&&(we.onclick=I=>fo(n,I));let U=E.querySelector("#asri-enhance-gruvbox");U&&(U.onclick=I=>yo(n,I));let ae=E.querySelector("#asri-enhance-glitch");ae&&(ae.onclick=I=>ko(n,I));let De=E.querySelector("#asri-enhance-nostalgia");De&&(De.onclick=I=>To(n,I));let Se=document.querySelector('#commonMenu[data-name="barmode"] #followCoverImgColor');if(Se&&!E.querySelector("#asri-enhance-follow-time")){let I=document.documentElement.style.getPropertyValue("--asri-enhance-follow-time-base-color")||"#3478f6",re=document.createElement("button");re.className="b3-menu__item asri-enhance",re.id="asri-enhance-follow-time",re.innerHTML=`<svg class="b3-menu__icon"></svg><input id="asri-enhance-followtime-colorpicker" type="color" value="${I}"><span class="b3-menu__label">${((P=n.i18n)==null?void 0:P.followTime)||"Follow Time"}</span>`,Se.nextSibling?E.insertBefore(re,Se.nextSibling):E.appendChild(re);let te=re.querySelector("#asri-enhance-followtime-colorpicker");te&&(re.addEventListener("click",async be=>{be.preventDefault(),be.stopPropagation(),await Br(n),te.click()}),te.addEventListener("click",be=>{be.stopPropagation()}),te.addEventListener("input",async be=>{let Jt=be.target;await zr(n,Jt.value)}))}}e(g);return}w+1<l?b(()=>_(w+1),c):e(g)};_(),a=void 0},t)},C=()=>{let g=document.querySelector("#barMode");if(g){o=g,g.addEventListener("click",d,!0),r=void 0;return}i+=1,i<l?r=window.setTimeout(C,c):r=void 0};return C(),()=>{r!==void 0&&(window.clearTimeout(r),r=void 0),m(),o&&(o.removeEventListener("click",d,!0),o=null),a!==void 0&&(window.clearTimeout(a),a=void 0)}}function Rs(n,e=0){let t,a,r=null,o=0,i=new Set,s=10,l=100,c=()=>{i.forEach(C=>window.clearTimeout(C)),i.clear()},m=(C,g)=>{let _=window.setTimeout(()=>{i.delete(_),C()},g);return i.add(_),_},b=C=>{t!==void 0&&window.clearTimeout(t),t=window.setTimeout(()=>{c();let g=(_=0)=>{var h,y,A,N,q,D,z,T,$,O,L,G,F,M,P,E,H,V,ee,Q,Z,se,ce,ue,we,U,ae,De,Se,I,re,te,be,Jt,Cr,Tr,xr,_r;let w=document.querySelector('#commonMenu[data-name="barmode"] #topbarFusionPlus');if(w){let oe=w.parentElement;if(oe){if(!oe.querySelector("#asri-enhance-more")){let u=document.createElement("button");u.className="b3-menu__item asri-enhance",u.id="asri-enhance-more",u.innerHTML=`${S}<span class="b3-menu__label">${((h=n.i18n)==null?void 0:h.more)||"more"}</span><svg class="b3-menu__icon b3-menu__icon--small"><use xlink:href="#iconRight"></use></svg><div class="b3-menu__submenu"><div class="b3-menu__items"><button class="b3-menu__item" id="asri-enhance-detail-adjustment">${S}<span class="b3-menu__label">${((y=n.i18n)==null?void 0:y.detailAdjustment)||"detailAdjustment"}</span><svg class="b3-menu__icon b3-menu__icon--small"><use xlink:href="#iconRight"></use></svg><div class="b3-menu__submenu"><div class="b3-menu__items"></div></div></button><button class="b3-menu__item" id="asri-enhance-texture">${S}<span class="b3-menu__label">${((A=n.i18n)==null?void 0:A.texture)||"texture"}</span><svg class="b3-menu__icon b3-menu__icon--small"><use xlink:href="#iconRight"></use></svg><div class="b3-menu__submenu"><div class="b3-menu__items"></div></div></button><button class="b3-menu__item" id="asri-enhance-immersive">${S}<span class="b3-menu__label">${((N=n.i18n)==null?void 0:N.immersive)||"immersiveEdit"}</span><svg class="b3-menu__icon b3-menu__icon--small"><use xlink:href="#iconRight"></use></svg><div class="b3-menu__submenu"><div class="b3-menu__items"></div></div></button><button class="b3-menu__separator"></button><button class="b3-menu__item" id="asri-enhance-list-bullet-line">${S}<span class="b3-menu__label">${((q=n.i18n)==null?void 0:q.listBulletLine)||"listBulletLine"}</span></button><button class="b3-menu__item" id="asri-enhance-vertical-tab">${S}<span class="b3-menu__label">${((D=n.i18n)==null?void 0:D.verticalTab)||"verticalTab"}</span></button><button class="b3-menu__item" id="asri-enhance-sidememo">${S}<span class="b3-menu__label">${((z=n.i18n)==null?void 0:z.sidememo)||"sidememo"}</span></button><button class="b3-menu__item" id="asri-enhance-smooth-caret">${S}<span class="b3-menu__label">${((T=n.i18n)==null?void 0:T.smoothCaret)||"smoothCaret"}</span></button><button class="b3-menu__item" id="asri-enhance-fluid-cursor">${S}<span class="b3-menu__label">${(($=n.i18n)==null?void 0:$.fluidCursor)||"fluidCursor"}</span></button><button class="b3-menu__item" id="asri-enhance-island-layout">${S}<span class="b3-menu__label">${((O=n.i18n)==null?void 0:O.islandLayout)||"islandLayout"}</span></button></div></div>`,w.nextSibling?oe.insertBefore(u,w.nextSibling):oe.appendChild(u)}let Ar=oe.querySelector("#asri-enhance-list-bullet-line");Ar&&(Ar.onclick=u=>$o(n,u));let Lr=oe.querySelector("#asri-enhance-vertical-tab");Lr&&(Lr.onclick=u=>Vo(n,u));let Mr=oe.querySelector("#asri-enhance-sidememo");Mr&&(Mr.onclick=u=>pi(n,u));let Pr=oe.querySelector("#asri-enhance-smooth-caret");Pr&&(Pr.onclick=u=>Fi(n,u));let Sr=oe.querySelector("#asri-enhance-fluid-cursor");Sr&&(Sr.onclick=u=>qi(n,u));let Hr=oe.querySelector("#asri-enhance-island-layout");Hr&&(Hr.onclick=u=>Gi(n,u));let Ir=oe.querySelector("#asri-enhance-detail-adjustment");if(Ir){let u=Ir.querySelector(".b3-menu__submenu .b3-menu__items");if(u&&!u.querySelector("#asri-enhance-windowtransparencyvalue")){let f=document.createElement("div");f.className="menu-item__subtitle",f.style.userSelect="none",f.style.padding="0 14px",f.textContent=((L=n.i18n)==null?void 0:L.windowTransparencyValueSubtitle)||"windowTransparencyValueSubtitle",u.appendChild(f)}if(u&&!u.querySelector("#asri-enhance-wholewindowtransparency")){let f=document.createElement("button");f.className="b3-menu__item",f.id="asri-enhance-wholewindowtransparency",f.innerHTML=`${S}<span class="b3-menu__label">${((G=n.i18n)==null?void 0:G.wholeWindowTransparency)||"wholeWindowTransparency"}</span>`,u.appendChild(f)}let Ce=u==null?void 0:u.querySelector("#asri-enhance-wholewindowtransparency");if(Ce&&(Ce.onclick=f=>Ri(n,f)),u&&!u.querySelector("#asri-enhance-windowtransparencyvalue")){let f=document.createElement("button");f.className="b3-menu__item",f.id="asri-enhance-windowtransparencyvalue",f.innerHTML=`<div aria-label="${((F=n.i18n)==null?void 0:F.windowTransparencyValue)||"windowTransparencyValue"}: 0.5" class="b3-tooltips b3-tooltips__n"><input style="box-sizing: border-box" type="range" class="b3-slider fn__block" min="0" max="1" step="0.05" value="0.5"></div>`,u.appendChild(f)}let ye=u==null?void 0:u.querySelector("#asri-enhance-windowtransparencyvalue");if(ye){ye.onclick=ie=>Si(n,ie);let f=ye.querySelector("input[type='range']");f&&(p(n,"config.json").then(ie=>{var ut,mt,dt;let Be=ie==null?void 0:ie["asri-enhance-windowtransparencyvalue"];if(Be!==void 0){let ht=parseFloat(Be);f.value=String(ht);let pt=(mt=(ut=f.parentElement)==null?void 0:ut.getAttribute("aria-label"))==null?void 0:mt.split(":")[0];pt&&((dt=f.parentElement)==null||dt.setAttribute("aria-label",`${pt}: ${ht}`))}}).catch(()=>{}),f.addEventListener("input",async ie=>{var dt,ht,pt;let Be=ie.target,ut=parseFloat(Be.value);await Ii(n,ut);let mt=(ht=(dt=Be.parentElement)==null?void 0:dt.getAttribute("aria-label"))==null?void 0:ht.split(":")[0];mt&&((pt=Be.parentElement)==null||pt.setAttribute("aria-label",`${mt}: ${ut}`))}))}if(u){let f=document.createElement("button");f.className="b3-menu__separator",u.appendChild(f)}if(u&&!u.querySelector("#asri-enhance-sidebar-top-sticky")){let f=document.createElement("button");f.className="b3-menu__item",f.id="asri-enhance-sidebar-top-sticky",f.innerHTML=`${S}<span class="b3-menu__label">${((M=n.i18n)==null?void 0:M.sidebarTopSticky)||"sidebarTopSticky"}</span>`,u.appendChild(f)}let Y=u==null?void 0:u.querySelector("#asri-enhance-sidebar-top-sticky");if(Y&&(Y.onclick=f=>yi(n,f)),u&&!u.querySelector("#asri-enhance-singlecolumnslashmenu")){let f=document.createElement("button");f.className="b3-menu__item",f.id="asri-enhance-singlecolumnslashmenu",f.innerHTML=`${S}<span class="b3-menu__label">${((P=n.i18n)==null?void 0:P.singleColumnSlashMenu)||"singleColumnSlashMenu"}</span>`,u.appendChild(f)}let tt=u==null?void 0:u.querySelector("#asri-enhance-singlecolumnslashmenu");if(tt&&(tt.onclick=f=>_i(n,f)),u&&!u.querySelector("#asri-enhance-cardsearchlist")){let f=document.createElement("button");f.className="b3-menu__item",f.id="asri-enhance-cardsearchlist",f.innerHTML=`${S}<span class="b3-menu__label">${((E=n.i18n)==null?void 0:E.cardSearchList)||"cardSearchList"}</span>`,u.appendChild(f)}let nt=u==null?void 0:u.querySelector("#asri-enhance-cardsearchlist");if(nt&&(nt.onclick=f=>Li(n,f)),u){let f=document.createElement("button");f.className="b3-menu__separator",u.appendChild(f)}if(u&&!u.querySelector("#asri-enhance-colored-heading")){let f=document.createElement("button");f.className="b3-menu__item",f.id="asri-enhance-colored-heading",f.innerHTML=`${S}<span class="b3-menu__label">${((H=n.i18n)==null?void 0:H.coloredHeading)||"coloredHeading"}</span>`,u.appendChild(f)}let at=u==null?void 0:u.querySelector("#asri-enhance-colored-heading");if(at&&(at.onclick=f=>_o(n,f)),u&&!u.querySelector("#asri-enhance-heading-level-hint")){let f=document.createElement("button");if(f.className="b3-menu__item",f.id="asri-enhance-heading-level-hint",f.innerHTML=`${S}<span class="b3-menu__label">${((V=n.i18n)==null?void 0:V.headingLevelHint)||"headingLevelHint"}</span>`,u.querySelector("#asri-enhance-colored-tree")){let ie=u.querySelector("#asri-enhance-colored-tree");u.insertBefore(f,ie)}else u.appendChild(f)}let rt=u==null?void 0:u.querySelector("#asri-enhance-heading-level-hint");if(rt&&(rt.onclick=f=>Lo(n,f)),u&&!u.querySelector("#asri-enhance-colored-tree")){let f=document.createElement("button");f.className="b3-menu__item",f.id="asri-enhance-colored-tree",f.innerHTML=`${S}<span class="b3-menu__label">${((ee=n.i18n)==null?void 0:ee.coloredTree)||"coloredTree"}</span>`,u.appendChild(f)}let ot=u==null?void 0:u.querySelector("#asri-enhance-colored-tree");if(ot&&(ot.onclick=f=>Po(n,f)),u&&!u.querySelector("#asri-enhance-colored-list")){let f=document.createElement("button");if(f.className="b3-menu__item",f.id="asri-enhance-colored-list",f.innerHTML=`${S}<span class="b3-menu__label">${((Q=n.i18n)==null?void 0:Q.coloredList)||"coloredList"}</span>`,u.querySelector("#asri-enhance-colored-tree")){let ie=u.querySelector("#asri-enhance-colored-tree");ie&&ie.nextSibling?u.insertBefore(f,ie.nextSibling):u.appendChild(f)}else u.appendChild(f)}let it=u==null?void 0:u.querySelector("#asri-enhance-colored-list");if(it&&(it.onclick=f=>Ho(n,f)),u&&!u.querySelector("#asri-enhance-moreanimations")){let f=document.createElement("button");f.className="b3-menu__item",f.id="asri-enhance-moreanimations",f.innerHTML=`${S}<span class="b3-menu__label">${((Z=n.i18n)==null?void 0:Z.moreAnimations)||"moreAnimations"}</span>`,u.appendChild(f)}let st=u==null?void 0:u.querySelector("#asri-enhance-moreanimations");if(st&&(st.onclick=f=>Ti(n,f)),u&&!u.querySelector("#asri-enhance-global-frosted-glass")){let f=document.createElement("button");f.className="b3-menu__item",f.id="asri-enhance-global-frosted-glass",f.innerHTML=`${S}<span class="b3-menu__label">${((se=n.i18n)==null?void 0:se.globalFrostedGlass)||"globalFrostedGlass"}</span>`,u.appendChild(f)}let lt=u==null?void 0:u.querySelector("#asri-enhance-global-frosted-glass");if(lt&&(lt.onclick=f=>gi(n,f)),u){let f=document.createElement("button");f.className="b3-menu__separator",u.appendChild(f)}if(u&&!u.querySelector("#asri-enhance-hide-tab")){let f=document.createElement("button");f.className="b3-menu__item",f.id="asri-enhance-hide-tab",f.innerHTML=`${S}<span class="b3-menu__label">${((ce=n.i18n)==null?void 0:ce.hideTab)||"hideTab"}</span>`,u.appendChild(f)}let ct=u==null?void 0:u.querySelector("#asri-enhance-hide-tab");if(ct&&(ct.onclick=f=>Ei(n,f)),u&&!u.querySelector("#asri-enhance-hide-breadcrumb")){let f=document.createElement("button");f.className="b3-menu__item",f.id="asri-enhance-hide-breadcrumb",f.innerHTML=`${S}<span class="b3-menu__label">${((ue=n.i18n)==null?void 0:ue.hideBreadcrumb)||"hideBreadcrumb"}</span>`,u.appendChild(f)}let v=u==null?void 0:u.querySelector("#asri-enhance-hide-breadcrumb");v&&(v.onclick=f=>wi(n,f))}let Rr=oe.querySelector("#asri-enhance-texture");if(Rr){let u=Rr.querySelector(".b3-menu__submenu .b3-menu__items");if(u&&!u.querySelector("#asri-enhance-paper")){let v=document.createElement("button");v.className="b3-menu__item",v.id="asri-enhance-paper",v.innerHTML=`${S}<span class="b3-menu__label">${((we=n.i18n)==null?void 0:we.paper)||"paper"}</span>`,u.appendChild(v)}if(u&&!u.querySelector("#asri-enhance-noise")){let v=document.createElement("button");v.className="b3-menu__item",v.id="asri-enhance-noise",v.innerHTML=`${S}<span class="b3-menu__label">${((U=n.i18n)==null?void 0:U.noise)||"noise"}</span>`,u.appendChild(v)}if(u&&!u.querySelector("#asri-enhance-acrylic")){let v=document.createElement("button");v.className="b3-menu__item",v.id="asri-enhance-acrylic",v.innerHTML=`${S}<span class="b3-menu__label">${((ae=n.i18n)==null?void 0:ae.acrylic)||"acrylic"}</span>`,u.appendChild(v)}if(u&&!u.querySelector("#asri-enhance-checkerboard")){let v=document.createElement("button");v.className="b3-menu__item",v.id="asri-enhance-checkerboard",v.innerHTML=`${S}<span class="b3-menu__label">${((De=n.i18n)==null?void 0:De.checkerboard)||"checkerboard"}</span>`,u.appendChild(v)}if(u&&!u.querySelector("#asri-enhance-grid")){let v=document.createElement("button");v.className="b3-menu__item",v.id="asri-enhance-grid",v.innerHTML=`${S}<span class="b3-menu__label">${((Se=n.i18n)==null?void 0:Se.grid)||"grid"}</span>`,u.appendChild(v)}if(u&&!u.querySelector("#asri-enhance-polkadot")){let v=document.createElement("button");v.className="b3-menu__item",v.id="asri-enhance-polkadot",v.innerHTML=`${S}<span class="b3-menu__label">${((I=n.i18n)==null?void 0:I.polkadot)||"polkadot"}</span>`,u.appendChild(v)}if(u&&!u.querySelector("#asri-enhance-crossdot")){let v=document.createElement("button");v.className="b3-menu__item",v.id="asri-enhance-crossdot",v.innerHTML=`${S}<span class="b3-menu__label">${((re=n.i18n)==null?void 0:re.crossdot)||"crossdot"}</span>`,u.appendChild(v)}if(u&&!u.querySelector("#asri-enhance-honeycomb")){let v=document.createElement("button");v.className="b3-menu__item",v.id="asri-enhance-honeycomb",v.innerHTML=`${S}<span class="b3-menu__label">${((te=n.i18n)==null?void 0:te.honeycomb)||"honeycomb"}</span>`,u.appendChild(v)}if(u&&!u.querySelector("#asri-enhance-wood")){let v=document.createElement("button");v.className="b3-menu__item",v.id="asri-enhance-wood",v.innerHTML=`${S}<span class="b3-menu__label">${((be=n.i18n)==null?void 0:be.wood)||"wood"}</span>`,u.appendChild(v)}if(u&&!u.querySelector("#asri-enhance-camouflage")){let v=document.createElement("button");v.className="b3-menu__item",v.id="asri-enhance-camouflage",v.innerHTML=`${S}<span class="b3-menu__label">${((Jt=n.i18n)==null?void 0:Jt.camouflage)||"camouflage"}</span>`,u.appendChild(v)}if(u&&!u.querySelector("#asri-enhance-fiber")){let v=document.createElement("button");v.className="b3-menu__item",v.id="asri-enhance-fiber",v.innerHTML=`${S}<span class="b3-menu__label">${((Cr=n.i18n)==null?void 0:Cr.fiber)||"fiber"}</span>`,u.appendChild(v)}if(u&&!u.querySelector("#asri-enhance-fabric")){let v=document.createElement("button");v.className="b3-menu__item",v.id="asri-enhance-fabric",v.innerHTML=`${S}<span class="b3-menu__label">${((Tr=n.i18n)==null?void 0:Tr.fabric)||"fabric"}</span>`,u.appendChild(v)}let Ce=u==null?void 0:u.querySelector("#asri-enhance-paper");Ce&&(Ce.onclick=v=>Vi(n,v));let ye=u==null?void 0:u.querySelector("#asri-enhance-noise");ye&&(ye.onclick=v=>Ui(n,v));let Y=u==null?void 0:u.querySelector("#asri-enhance-acrylic");Y&&(Y.onclick=v=>Qi(n,v));let tt=u==null?void 0:u.querySelector("#asri-enhance-checkerboard");tt&&(tt.onclick=v=>ts(n,v));let nt=u==null?void 0:u.querySelector("#asri-enhance-grid");nt&&(nt.onclick=v=>rs(n,v));let at=u==null?void 0:u.querySelector("#asri-enhance-polkadot");at&&(at.onclick=v=>ss(n,v));let rt=u==null?void 0:u.querySelector("#asri-enhance-crossdot");rt&&(rt.onclick=v=>us(n,v));let ot=u==null?void 0:u.querySelector("#asri-enhance-honeycomb");ot&&(ot.onclick=v=>hs(n,v));let it=u==null?void 0:u.querySelector("#asri-enhance-wood");it&&(it.onclick=v=>gs(n,v));let st=u==null?void 0:u.querySelector("#asri-enhance-camouflage");st&&(st.onclick=v=>vs(n,v));let lt=u==null?void 0:u.querySelector("#asri-enhance-fiber");lt&&(lt.onclick=v=>ws(n,v));let ct=u==null?void 0:u.querySelector("#asri-enhance-fabric");ct&&(ct.onclick=v=>xs(n,v))}let Nr=oe.querySelector("#asri-enhance-immersive");if(Nr){let u=Nr.querySelector(".b3-menu__submenu .b3-menu__items");if(u&&!u.querySelector("#asri-enhance-typewriter")){let Y=document.createElement("button");Y.className="b3-menu__item",Y.id="asri-enhance-typewriter",Y.innerHTML=`${S}<span class="b3-menu__label">${((xr=n.i18n)==null?void 0:xr.typewriter)||"typewriterMode"}</span>`,u.appendChild(Y)}if(u&&!u.querySelector("#asri-enhance-focus")){let Y=document.createElement("button");Y.className="b3-menu__item",Y.id="asri-enhance-focus",Y.innerHTML=`${S}<span class="b3-menu__label">${((_r=n.i18n)==null?void 0:_r.focus)||"focusMode"}</span>`,u.appendChild(Y)}let Ce=u==null?void 0:u.querySelector("#asri-enhance-typewriter");Ce&&(Ce.onclick=Y=>Sn(n,Y));let ye=u==null?void 0:u.querySelector("#asri-enhance-focus");ye&&(ye.onclick=Y=>Hn(n,Y))}}return}_+1<s&&m(()=>g(_+1),l)};g(),t=void 0},e)},d=()=>{let C=document.querySelector("#barMode");if(C){r=C,C.addEventListener("click",b,!0),a=void 0;return}o+=1,o<s?a=window.setTimeout(d,l):a=void 0};return d(),()=>{a!==void 0&&(window.clearTimeout(a),a=void 0),c(),r&&(r.removeEventListener("click",b,!0),r=null),t!==void 0&&(window.clearTimeout(t),t=void 0)}}var yr=!1,Pe=null,br=0,pe=null,Qe=null,Je=null,et=null;function vr(){return document.querySelector(".protyle-hint.hint--menu:not(.fn__none)")}function Oe(){if(yr=!1,pe=null,Pe!==null&&(clearInterval(Pe),Pe=null),Qe){try{Qe.disconnect()}catch(n){}Qe=null}if(Je){try{Je.disconnect()}catch(n){}Je=null}}function Er(n){return!!(n&&document.body.contains(n)&&!n.classList.contains("fn__none"))}function kr(){if(pe){if(!Qe){Qe=new MutationObserver(()=>{Er(pe)||Oe()});try{Qe.observe(pe,{attributes:!0,attributeFilter:["class","style"]})}catch(n){}}if(!Je){Je=new MutationObserver(()=>{Er(pe)||Oe()});try{Je.observe(document.body,{childList:!0,subtree:!0})}catch(n){}}}}function cc(){let n=vr();return n?(pe=n,kr(),!0):(br=0,Pe=setInterval(()=>{br+=1;let e=vr();e?(pe=e,clearInterval(Pe),Pe=null,kr()):br>=10&&(clearInterval(Pe),Pe=null,Oe())},100),!1)}function uc(n){return n?Array.from(n.querySelectorAll(".b3-list-item")):[]}function Fs(n){return n?n.querySelector(".b3-list-item--focus"):null}function mc(n){return n.map(e=>{let t=e.getBoundingClientRect();return{el:e,x:t.left+t.width/2,y:t.top+t.height/2}})}function dc(n,e,t){if(!e||n.length===0)return null;let a=e.getBoundingClientRect(),r={x:a.left+a.width/2,y:a.top+a.height/2,el:e},o=mc(n),i=Math.max(a.width/2,10),s;switch(t){case"ArrowUp":s=d=>d.y<r.y-1&&Math.abs(d.x-r.x)<=i;break;case"ArrowDown":s=d=>d.y>r.y+1&&Math.abs(d.x-r.x)<=i;break;case"ArrowLeft":s=d=>d.x<r.x-1;break;case"ArrowRight":s=d=>d.x>r.x+1;break;default:return null}let l=o.filter(d=>d.el!==e&&s(d));if(l.length===0)return null;let c=(d,C)=>{let g=d.x-C.x,_=d.y-C.y;return g*g+_*_},m=l[0],b=c(m,r);for(let d=1;d<l.length;d++){let C=c(l[d],r);C<b&&(m=l[d],b=C)}return m.el}function Ns(n){if(!pe||!n)return;let e=Fs(pe);if(e!==n){e&&e.classList.remove("b3-list-item--focus"),n.classList.add("b3-list-item--focus");try{n.scrollIntoView({block:"nearest",inline:"nearest"})}catch(t){}}}function hc(n,e){var a,r;let t=n.indexOf(e);return t===-1?(a=n[0])!=null?a:null:t+1<n.length?n[t+1]:(r=n[0])!=null?r:null}function pc(n,e){var a,r;let t=n.indexOf(e);return t===-1?(a=n[n.length-1])!=null?a:null:t-1>=0?n[t-1]:(r=n[n.length-1])!=null?r:null}function $s(n,e){let t=e.getBoundingClientRect(),a=t.top+t.height/2,r=[];for(let o of n){if(o===e)continue;let i=o.getBoundingClientRect(),s=i.top+i.height/2,l=Math.min(t.height,i.height)/2;Math.abs(s-a)<=l&&r.push(o)}return r}function fc(n){return n.map(e=>({el:e,x:e.getBoundingClientRect().left})).sort((e,t)=>e.x-t.x).map(e=>e.el)}function gc(n){return n.map(e=>({el:e,x:e.getBoundingClientRect().left})).sort((e,t)=>t.x-e.x).map(e=>e.el)}var bc=n=>{var l,c;if(n.key==="/"){Oe(),yr=!0,cc();return}if(!yr)return;if(n.key==="Escape"){Oe();return}if(!["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(n.key))return;let t=pe||vr();if(!t||!Er(t)){Oe();return}n.preventDefault(),n.stopPropagation(),pe=t,kr();let a=uc(t);if(a.length===0)return;let r=Fs(t);r||(r=a[0],r.classList.add("b3-list-item--focus"));let o=dc(a,r,n.key);if(o){Ns(o);return}let i=null,s=n.key;if(s==="ArrowDown")i=hc(a,r);else if(s==="ArrowUp")i=pc(a,r);else if(s==="ArrowRight"){let m=$s(a,r);m.length>0&&(i=(l=fc(m)[0])!=null?l:null)}else if(s==="ArrowLeft"){let m=$s(a,r);m.length>0&&(i=(c=gc(m)[0])!=null?c:null)}i&&i!==r&&Ns(i)};function Os(){typeof document!="undefined"&&(et||(et=bc,document.addEventListener("keydown",et,{capture:!0})))}function Ds(){typeof document!="undefined"&&(et&&(document.removeEventListener("keydown",et,{capture:!0}),et=null),Oe())}var wr=class extends Bs.Plugin{constructor(){super(...arguments);this.unsubscribeBarModeClick=null;this.unsubscribeTopbarFusionPlus=null;this.asriConfigClickHandler=null;this.themeModeObserver=null;this.themeModeChangeTimers=[];this.paletteDisableMouseUpHandler=null;this.paletteDisableDebounceTimer=null}async applyAllConfigs(t){await Promise.all([jr(this,t).catch(()=>{}),Yr(this,t).catch(()=>{}),Zr(this,t).catch(()=>{}),eo(this,t).catch(()=>{}),ao(this,t).catch(()=>{}),io(this,t).catch(()=>{}),co(this,t).catch(()=>{}),ho(this,t).catch(()=>{}),go(this,t).catch(()=>{}),vo(this,t).catch(()=>{}),wo(this,t).catch(()=>{}),xo(this,t).catch(()=>{}),Ao(this,t).catch(()=>{}),So(this,t).catch(()=>{}),Io(this,t).catch(()=>{}),Mo(this,t).catch(()=>{}),Fo(this,t).catch(()=>{}),Wo(this,t).catch(()=>{}),fi(this,t).catch(()=>{}),bi(this,t).catch(()=>{}),vi(this,t).catch(()=>{}),ki(this,t).catch(()=>{}),Ci(this,t).catch(()=>{}),xi(this,t).catch(()=>{}),Ai(this,t).catch(()=>{}),Mi(this,t).catch(()=>{}),Hi(this,t).catch(()=>{}),Ni(this,t).catch(()=>{}),Oi(this,t).catch(()=>{}),zi(this,t).catch(()=>{}),Ki(this,t).catch(()=>{}),Wi(this,t).catch(()=>{}),Xi(this,t).catch(()=>{}),Ji(this,t).catch(()=>{}),ns(this,t).catch(()=>{}),os(this,t).catch(()=>{}),ls(this,t).catch(()=>{}),ms(this,t).catch(()=>{}),ps(this,t).catch(()=>{}),bs(this,t).catch(()=>{}),Es(this,t).catch(()=>{}),Cs(this,t).catch(()=>{}),_s(this,t).catch(()=>{}),Ss(this,t).catch(()=>{}),Hs(this,t).catch(()=>{}),qr(this,t).catch(()=>{})])}async onload(){var r,o;this.unsubscribeBarModeClick=Is(this,()=>{}),this.unsubscribeTopbarFusionPlus=Rs(this),this.asriConfigClickHandler=i=>{queueMicrotask(()=>{let s=i.target;if(!s||s.closest("#asri-enhance-amber")||s.closest("#asri-enhance-sakura")||s.closest("#asri-enhance-wilderness")||s.closest("#asri-enhance-midnight")||s.closest("#asri-enhance-salt")||s.closest("#asri-enhance-rosepine")||s.closest("#asri-enhance-topaz")||s.closest("#asri-enhance-oxygen")||s.closest("#asri-enhance-shade")||s.closest("#asri-enhance-gruvbox")||s.closest("#asri-enhance-glitch")||s.closest("#asri-enhance-nostalgia"))return;let l=s.closest(".asri-config");l&&l.id!=="topbarFusionPlus"&&l.id!=="asriChroma"&&(Rn.forEach(c=>{$r(this,c,"config.json").catch(()=>{})}),gt(this,"config.json").catch(()=>{}))})},document.addEventListener("click",this.asriConfigClickHandler,!0),this.paletteDisableMouseUpHandler=i=>{queueMicrotask(()=>{var c,m;let s=i.target;if(!s)return;if(((c=s.id)==null?void 0:c.startsWith("prst-palette"))||s.closest("[id^='prst-palette']")!==null||s.id==="pickColor"||s.closest("#pickColor")!==null||s.id==="followSysAccent"||s.closest("#followSysAccent")!==null||s.id==="followCoverImgColor"||s.closest("#followCoverImgColor")!==null){this.paletteDisableDebounceTimer!==null&&clearTimeout(this.paletteDisableDebounceTimer);let b=null;if((m=s.id)!=null&&m.startsWith("prst-palette"))b=s.id.replace("prst-palette-","");else{let d=s.closest("[id^='prst-palette']");d&&(b=d.id.replace("prst-palette-",""))}this.paletteDisableDebounceTimer=window.setTimeout(()=>{Or(this,"config.json").then(()=>{gt(this,"config.json").then(()=>{if(b){let d=document.documentElement;d&&d.getAttribute("data-asri-palette")!==b&&d.setAttribute("data-asri-palette",b)}p(this,"config.json").then(d=>{this.applyAllConfigs(d).catch(()=>{})}).catch(()=>{})}).catch(()=>{})}).catch(()=>{}),this.paletteDisableDebounceTimer=null},200)}})},document.addEventListener("mouseup",this.paletteDisableMouseUpHandler,!1);let t=await p(this,"config.json"),a=document.documentElement;a&&(this.themeModeObserver=new MutationObserver(i=>{queueMicrotask(()=>{for(let s of i)if(s.type==="attributes"&&s.attributeName==="data-theme-mode"){this.themeModeChangeTimers.forEach(m=>{clearTimeout(m)}),this.themeModeChangeTimers=[],p(this,"config.json").then(m=>{this.applyAllConfigs(m).catch(()=>{})}).catch(()=>{});let l=window.setTimeout(()=>{p(this,"config.json").then(m=>{this.applyAllConfigs(m).catch(()=>{})}).catch(()=>{})},100);this.themeModeChangeTimers.push(l);let c=window.setTimeout(()=>{p(this,"config.json").then(m=>{this.applyAllConfigs(m).catch(()=>{})}).catch(()=>{})},500);this.themeModeChangeTimers.push(c)}})}),this.themeModeObserver.observe(a,{attributes:!0,attributeFilter:["data-theme-mode"]})),await this.applyAllConfigs(t),Os(),this.addCommand({langKey:"asri-enhance-typewriter",langText:((r=this.i18n)==null?void 0:r.typewriter)||"\u5207\u6362\u6253\u5B57\u673A\u6A21\u5F0F",hotkey:"",callback:()=>{Sn(this)}}),this.addCommand({langKey:"asri-enhance-focus",langText:((o=this.i18n)==null?void 0:o.focus)||"\u5207\u6362\u805A\u7126\u6A21\u5F0F",hotkey:"",callback:()=>{Hn(this)}}),setTimeout(()=>{this.applyAllConfigs(t).catch(()=>{})},100),setTimeout(()=>{this.applyAllConfigs(t).catch(()=>{})},500)}onunload(){this.unsubscribeBarModeClick&&(this.unsubscribeBarModeClick(),this.unsubscribeBarModeClick=null),this.unsubscribeTopbarFusionPlus&&(this.unsubscribeTopbarFusionPlus(),this.unsubscribeTopbarFusionPlus=null),this.asriConfigClickHandler&&(document.removeEventListener("click",this.asriConfigClickHandler,!0),this.asriConfigClickHandler=null),this.themeModeObserver&&(this.themeModeObserver.disconnect(),this.themeModeObserver=null),this.themeModeChangeTimers.forEach(a=>{clearTimeout(a)}),this.themeModeChangeTimers=[],this.paletteDisableMouseUpHandler&&(document.removeEventListener("mouseup",this.paletteDisableMouseUpHandler,!0),this.paletteDisableMouseUpHandler=null),this.paletteDisableDebounceTimer!==null&&(clearTimeout(this.paletteDisableDebounceTimer),this.paletteDisableDebounceTimer=null),Oo(),Ds(),cn(),yn(),vn(),Cn(),An(),Pn(),Bt();let t=document.documentElement;t&&Array.from(t.attributes).forEach(r=>{r.name.startsWith("data-asri-enhance-")&&t.removeAttribute(r.name)})}async uninstall(){this.onunload(),await Fr(this,"config.json").catch(()=>{})}};module.exports=wr;
