var _o=Object.defineProperty;var Ao=(n,e,t)=>e in n?_o(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var B=(n,e,t)=>Ao(n,typeof e!="symbol"?e+"":e,t);var Co=require("siyuan");var Ut="asri-enhance-",Yt=["amber","sakura","wilderness","midnight","salt","rosepine","topaz","oxygen","shade","gruvbox","glitch","nostalgia"];async function E(n,e,t){if(!n.saveData)throw new Error("Plugin saveData method is not available");try{await n.saveData(e,t)}catch(a){throw a}}async function d(n,e){if(!n.loadData)return null;try{return await n.loadData(e)||null}catch(t){return null}}async function Ra(n,e,t="config.json"){let a=document.documentElement;if(!a)return;let r=a.getAttribute("data-theme-mode")||"light";a.getAttribute("data-asri-palette")===e&&a.removeAttribute("data-asri-palette");let i=await d(n,t);if(!i)return;let o=`${Ut}${e}`,s=i[o];s!==void 0&&(typeof s=="boolean"?delete i[o]:s&&typeof s=="object"&&(s[r]=!1,i[o]=s),await E(n,t,i))}async function $a(n,e="config.json"){let t=await d(n,e);if(!t)return;let a=!1;Object.keys(t).forEach(r=>{r.startsWith(Ut)&&(delete t[r],a=!0)}),a&&await E(n,e,t)}async function Na(n,e="config.json"){let t=document.documentElement;if(!t)return;let a=t.getAttribute("data-theme-mode")||"light",r=await d(n,e);if(!r)return;let i=!1;Yt.forEach(o=>{let s=`${Ut}${o}`,l=r[s];l!==void 0&&(typeof l=="boolean"?(delete r[s],i=!0):l&&typeof l=="object"&&l[a]===!0&&(l[a]=!1,r[s]=l,i=!0))}),i&&await E(n,e,r)}var Xt="config.json",_e="asri-enhance-follow-time",Ce="data-asri-enhance-follow-time",Qe=null,Ze=0;function Fa(){Qe===null&&(Ze=0,document.documentElement.style.setProperty("--asri-enhance-follow-time-vary",Ze.toString()),Qe=window.setInterval(()=>{Ze=(Ze+3)%361,document.documentElement.style.setProperty("--asri-enhance-follow-time-vary",Ze.toString())},2e3))}function Zt(){Qe!==null&&(window.clearInterval(Qe),Qe=null),document.documentElement.style.removeProperty("--asri-enhance-follow-time-vary")}async function Oa(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t||t.hasAttribute(Ce))return;let r=t.getAttribute("data-theme-mode")||"light",i=await d(n,Xt)||{},o=i[_e]||{light:!1,dark:!1},s=()=>{t.setAttribute(Ce,"true"),t.removeAttribute("data-asri-palette"),o[r]=!0,i[_e]=o,Fa()};document.startViewTransition?await document.startViewTransition(()=>{s()}).finished.catch(()=>{}):s(),await E(n,Xt,i).catch(()=>{})}async function Da(n,e){let t=document.documentElement;if(!t)return;let a=t.getAttribute("data-theme-mode")||"light",r=e!==void 0?e:await d(n,Xt);if(r&&r[_e]){let i=r[_e];(typeof i=="boolean"?i:i[a]===!0)?(t.setAttribute(Ce,"true"),t.removeAttribute("data-asri-palette"),Fa()):(t.removeAttribute(Ce),Zt())}else t.removeAttribute(Ce),Zt()}async function Je(n,e="config.json"){let t=document.documentElement;t&&(t.removeAttribute(Ce),Zt());let a=await d(n,e);a&&a[_e]!==void 0&&(delete a[_e],await E(n,e,a))}var _t="config.json";async function K(n,e,t){let a=document.documentElement;if(!a)return;let r=a.getAttribute("data-theme-mode")||"light";if(a.getAttribute("data-asri-palette")===e.name)return;let o=await d(n,_t)||{},s=o[e.configKey]||{light:!1,dark:!1},l=()=>{a.removeAttribute("data-asri-palette"),a.setAttribute("data-asri-palette",e.name),s[r]=!0;for(let c of e.otherConfigKeys)if(o[c]){let m=o[c];typeof m=="object"&&(m[r]=!1,o[c]=m)}if(o[e.configKey]=s,o["asri-enhance-follow-time"]){let c=o["asri-enhance-follow-time"];typeof c=="object"&&(c[r]=!1,o["asri-enhance-follow-time"]=c),a.removeAttribute("data-asri-enhance-follow-time"),Je(n,_t).catch(()=>{})}};document.startViewTransition?await document.startViewTransition(()=>{l()}).finished.catch(()=>{}):l(),await E(n,_t,o).catch(()=>{})}async function j(n,e,t){let a=document.documentElement;if(!a)return;let r=a.getAttribute("data-theme-mode")||"light",i=t!==void 0?t:await d(n,_t);if(i&&i[e.configKey]){let o=i[e.configKey];(typeof o=="boolean"?o:o[r]===!0)?(a.removeAttribute("data-asri-palette"),a.setAttribute("data-asri-palette",e.name),a.removeAttribute("data-asri-enhance-follow-time")):a.getAttribute("data-asri-palette")===e.name&&a.removeAttribute("data-asri-palette")}}var Ba={name:"amber",configKey:"asri-enhance-amber",otherConfigKeys:["asri-enhance-sakura","asri-enhance-wilderness","asri-enhance-midnight","asri-enhance-salt","asri-enhance-rosepine","asri-enhance-topaz","asri-enhance-oxygen","asri-enhance-shade","asri-enhance-gruvbox","asri-enhance-glitch","asri-enhance-nostalgia"]};async function qa(n,e){return K(n,Ba,e)}async function za(n,e){return j(n,Ba,e)}var Ga={name:"sakura",configKey:"asri-enhance-sakura",otherConfigKeys:["asri-enhance-amber","asri-enhance-wilderness","asri-enhance-midnight","asri-enhance-salt","asri-enhance-rosepine","asri-enhance-topaz","asri-enhance-oxygen","asri-enhance-shade","asri-enhance-gruvbox","asri-enhance-glitch","asri-enhance-nostalgia"]};async function Ka(n,e){return K(n,Ga,e)}async function ja(n,e){return j(n,Ga,e)}var Va={name:"wilderness",configKey:"asri-enhance-wilderness",otherConfigKeys:["asri-enhance-sakura","asri-enhance-amber","asri-enhance-midnight","asri-enhance-salt","asri-enhance-rosepine","asri-enhance-topaz","asri-enhance-oxygen","asri-enhance-shade","asri-enhance-gruvbox","asri-enhance-glitch","asri-enhance-nostalgia"]};async function Wa(n,e){return K(n,Va,e)}async function Ua(n,e){return j(n,Va,e)}var Ya={name:"midnight",configKey:"asri-enhance-midnight",otherConfigKeys:["asri-enhance-sakura","asri-enhance-amber","asri-enhance-wilderness","asri-enhance-salt","asri-enhance-rosepine","asri-enhance-topaz","asri-enhance-oxygen","asri-enhance-shade","asri-enhance-gruvbox","asri-enhance-glitch","asri-enhance-nostalgia"]};async function Xa(n,e){return K(n,Ya,e)}async function Za(n,e){return j(n,Ya,e)}var Qa={name:"salt",configKey:"asri-enhance-salt",otherConfigKeys:["asri-enhance-sakura","asri-enhance-amber","asri-enhance-wilderness","asri-enhance-midnight","asri-enhance-rosepine","asri-enhance-topaz","asri-enhance-oxygen","asri-enhance-shade","asri-enhance-gruvbox","asri-enhance-glitch","asri-enhance-nostalgia"]};async function Ja(n,e){return K(n,Qa,e)}async function er(n,e){return j(n,Qa,e)}var tr={name:"rosepine",configKey:"asri-enhance-rosepine",otherConfigKeys:["asri-enhance-sakura","asri-enhance-amber","asri-enhance-wilderness","asri-enhance-midnight","asri-enhance-salt","asri-enhance-topaz","asri-enhance-oxygen","asri-enhance-shade","asri-enhance-gruvbox","asri-enhance-glitch","asri-enhance-nostalgia"]};async function nr(n,e){return K(n,tr,e)}async function ar(n,e){return j(n,tr,e)}var rr={name:"topaz",configKey:"asri-enhance-topaz",otherConfigKeys:["asri-enhance-sakura","asri-enhance-amber","asri-enhance-wilderness","asri-enhance-midnight","asri-enhance-salt","asri-enhance-rosepine","asri-enhance-oxygen","asri-enhance-shade","asri-enhance-gruvbox","asri-enhance-glitch","asri-enhance-nostalgia"]};async function ir(n,e){return K(n,rr,e)}async function or(n,e){return j(n,rr,e)}var sr={name:"oxygen",configKey:"asri-enhance-oxygen",otherConfigKeys:["asri-enhance-sakura","asri-enhance-amber","asri-enhance-wilderness","asri-enhance-midnight","asri-enhance-salt","asri-enhance-rosepine","asri-enhance-topaz","asri-enhance-shade","asri-enhance-gruvbox","asri-enhance-glitch","asri-enhance-nostalgia"]};async function lr(n,e){return K(n,sr,e)}async function cr(n,e){return j(n,sr,e)}var ur={name:"shade",configKey:"asri-enhance-shade",otherConfigKeys:["asri-enhance-sakura","asri-enhance-amber","asri-enhance-wilderness","asri-enhance-midnight","asri-enhance-salt","asri-enhance-rosepine","asri-enhance-topaz","asri-enhance-oxygen","asri-enhance-gruvbox","asri-enhance-glitch","asri-enhance-nostalgia"]};async function mr(n,e){return K(n,ur,e)}async function hr(n,e){return j(n,ur,e)}var dr={name:"gruvbox",configKey:"asri-enhance-gruvbox",otherConfigKeys:["asri-enhance-sakura","asri-enhance-amber","asri-enhance-wilderness","asri-enhance-midnight","asri-enhance-salt","asri-enhance-rosepine","asri-enhance-topaz","asri-enhance-oxygen","asri-enhance-shade","asri-enhance-glitch","asri-enhance-nostalgia"]};async function pr(n,e){return K(n,dr,e)}async function fr(n,e){return j(n,dr,e)}var gr={name:"glitch",configKey:"asri-enhance-glitch",otherConfigKeys:["asri-enhance-sakura","asri-enhance-amber","asri-enhance-wilderness","asri-enhance-midnight","asri-enhance-salt","asri-enhance-rosepine","asri-enhance-topaz","asri-enhance-oxygen","asri-enhance-shade","asri-enhance-gruvbox","asri-enhance-nostalgia"]};async function br(n,e){return K(n,gr,e)}async function yr(n,e){return j(n,gr,e)}var vr={name:"nostalgia",configKey:"asri-enhance-nostalgia",otherConfigKeys:["asri-enhance-amber","asri-enhance-sakura","asri-enhance-wilderness","asri-enhance-midnight","asri-enhance-salt","asri-enhance-rosepine","asri-enhance-topaz","asri-enhance-oxygen","asri-enhance-shade","asri-enhance-gruvbox","asri-enhance-glitch"]};async function kr(n,e){return K(n,vr,e)}async function Er(n,e){return j(n,vr,e)}var Qt="config.json",Jt="asri-enhance-coloredheading";async function wr(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t)return;let a=t.hasAttribute("data-asri-enhance-coloredheading"),r=await d(n,Qt)||{};a?(t.removeAttribute("data-asri-enhance-coloredheading"),r[Jt]=!1):(t.setAttribute("data-asri-enhance-coloredheading","true"),r[Jt]=!0),await E(n,Qt,r).catch(()=>{})}async function xr(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await d(n,Qt);a&&a[Jt]===!0?t.setAttribute("data-asri-enhance-coloredheading","true"):t.removeAttribute("data-asri-enhance-coloredheading")}var en="config.json",tn="asri-enhance-headinglevelhint",et="data-asri-enhance-headinglevelhint";async function Tr(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t)return;let a=t.hasAttribute(et),r=await d(n,en)||{};a?(t.removeAttribute(et),r[tn]=!1):(t.setAttribute(et,"true"),r[tn]=!0),await E(n,en,r).catch(()=>{})}async function Cr(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await d(n,en);a&&a[tn]===!0?t.setAttribute(et,"true"):t.removeAttribute(et)}var nn="config.json",an="asri-enhance-colored-tree";async function _r(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t)return;let a=t.hasAttribute("data-asri-enhance-colored-tree"),r=await d(n,nn)||{};a?(t.removeAttribute("data-asri-enhance-colored-tree"),r[an]=!1):(t.setAttribute("data-asri-enhance-colored-tree","true"),r[an]=!0),await E(n,nn,r).catch(()=>{})}async function Ar(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await d(n,nn);a&&a[an]===!0?t.setAttribute("data-asri-enhance-colored-tree","true"):t.removeAttribute("data-asri-enhance-colored-tree")}var on="config.json",sn="asri-enhance-listbulletline",Lo=".asri-enhance-bullet-highlight,.asri-enhance-bullet-line",ln="asri-enhance-bullet-highlight",fe="asri-enhance-bullet-line",Ae="--asri-enhance-bullet-line-height",Le=null,tt=null,re=null,At=new Set,Lr=()=>{document.querySelectorAll(Lo).forEach(n=>{n.classList.remove(ln,fe),n.style.removeProperty(Ae)}),At.clear()},Po=n=>{n.classList.remove(ln,fe),n.style.removeProperty(Ae)},Mo=(n,e,t)=>{if(n.classList.add(ln),e&&t){let a=n.getBoundingClientRect(),r=t.getBoundingClientRect();n.style.setProperty(Ae,`${a.top-r.top}px`),n.classList.add(fe)}},rn=n=>{var r,i,o,s;let e=window.getSelection(),t=[];if(n){let l=n;for(;l;){let c=l;if(((r=c.dataset)==null?void 0:r.type)==="NodeListItem"&&t.push(c),(i=c.classList)!=null&&i.contains("protyle-wysiwyg"))break;l=c.parentElement}}else if(e&&e.rangeCount){let l=e.getRangeAt(0).startContainer;for(;l&&l.nodeType!==Node.ELEMENT_NODE;)l=l.parentElement;for(;l;){let c=l;if(((o=c.dataset)==null?void 0:o.type)==="NodeListItem"&&t.push(c),(s=c.classList)!=null&&s.contains("protyle-wysiwyg"))break;l=c.parentElement}}let a=new Set(t);At.forEach(l=>{a.has(l)||Po(l)}),t.forEach((l,c)=>{let m=c<t.length-1,k=m?t[c+1]:void 0;if(!At.has(l))Mo(l,m,k);else if(m&&k){let b=l.getBoundingClientRect(),T=k.getBoundingClientRect(),p=`${b.top-T.top}px`;l.style.getPropertyValue(Ae)!==p&&l.style.setProperty(Ae,p),l.classList.contains(fe)||l.classList.add(fe)}else l.classList.contains(fe)&&(l.classList.remove(fe),l.style.removeProperty(Ae))}),At=a},Pr=()=>{Le||(Le=()=>{re&&clearTimeout(re),re=setTimeout(()=>{rn(),re=null},50)},tt=n=>{var t;let e=n.composedPath()[0];(t=e.closest)!=null&&t.call(e,".protyle-action")&&(re&&clearTimeout(re),re=setTimeout(()=>{rn(e),re=null},50))},document.addEventListener("selectionchange",Le),document.addEventListener("click",tt,{capture:!0}),rn())},cn=()=>{if(!Le){Lr();return}re&&(clearTimeout(re),re=null),document.removeEventListener("selectionchange",Le),tt&&(document.removeEventListener("click",tt,{capture:!0}),tt=null),Le=null,Lr()};async function Mr(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t)return;let a=t.hasAttribute("data-asri-enhance-listbulletline"),r=await d(n,on)||{};a?(t.removeAttribute("data-asri-enhance-listbulletline"),r[sn]=!1,cn()):(t.setAttribute("data-asri-enhance-listbulletline","true"),r[sn]=!0,Pr()),await E(n,on,r).catch(()=>{})}async function Sr(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await d(n,on);a&&a[sn]===!0?(t.setAttribute("data-asri-enhance-listbulletline","true"),Pr()):(t.removeAttribute("data-asri-enhance-listbulletline"),cn())}var Hr=()=>{cn()};var Pe=[],Ir=window.fetch,Lt=!1;function So(){if(Lt)return;let n=Ir,e=new Proxy(n,{apply(t,a,r){try{let[i,o]=r,s=i instanceof URL?i.href:String(i),l=null;try{if(o&&typeof o=="object"){let c=o.body;if(typeof c=="string")l=c;else if(c instanceof URLSearchParams)l=c.toString();else if(c&&typeof c=="object")try{l=JSON.stringify(c)}catch(m){l=null}}}catch(c){l=null}Pe.forEach(c=>{try{let m=c.pattern.test(s),k=l?c.pattern.test(l):!1;(m||k)&&queueMicrotask(()=>{try{c.callback(s,o)}catch(b){}})}catch(m){}})}catch(i){}return Reflect.apply(n,a,r)}});try{window.fetch=e,Lt=!0}catch(t){}try{let t=XMLHttpRequest.prototype.open,a=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.open=function(r,i,o,s,l){try{this.__asri_intercept_url=i instanceof URL?i.href:String(i)}catch(c){}return t.apply(this,arguments)},XMLHttpRequest.prototype.send=function(r){try{let i=this.__asri_intercept_url||"",o=null;try{if(typeof r=="string")o=r;else if(r instanceof URLSearchParams)o=r.toString();else if(r&&typeof r=="object")try{o=JSON.stringify(r)}catch(s){o=null}}catch(s){o=null}(i||o)&&Pe.forEach(s=>{try{let l=i?s.pattern.test(i):!1,c=o?s.pattern.test(o):!1;(l||c)&&queueMicrotask(()=>{try{s.callback(i,r)}catch(m){}})}catch(l){}})}catch(i){}return a.apply(this,arguments)}}catch(t){}}function Pt(n,e){let a={pattern:n instanceof RegExp?n:new RegExp(String(n)),callback:e};return Pe.push(a),So(),{disconnect:()=>{let i=Pe.indexOf(a);if(i!==-1&&Pe.splice(i,1),Pe.length===0&&Lt){try{window.fetch=Ir}catch(o){}Lt=!1}}}}var un="config.json",mn="asri-enhance-vertical-tab",It=150,Fr=null,Ht=!1,Mt=!1,Rr=0,$r=0,nt=null,at=null,ge=null,be=null,hn=null,St=null,Me=null;function Ho(n=10,e=100){return new Promise(t=>{let a=0,r=()=>{let i=document.querySelector(".layout__center");if(i){t(i);return}if(a++,a>=n){t(null);return}setTimeout(r,e)};r()})}function Io(){let n=document.documentElement,e=getComputedStyle(n).getPropertyValue("--asri-enhance-vertical-tab-width");if(e){let t=parseFloat(e);return isNaN(t)?It:t}return It}function Rt(n){document.documentElement.style.setProperty("--asri-enhance-vertical-tab-width",`${n}px`)}function Ro(){Rt(It)}function $o(n){let e=i=>{i.preventDefault(),i.stopPropagation(),Mt=!0,Rr=i.clientX,$r=Io(),document.body.style.userSelect="none",document.body.style.cursor="col-resize",nt=o=>{if(!Mt)return;o.preventDefault();let s=o.clientX-Rr;be=Math.max(100,Math.min(300,$r+s)),ge!==null&&cancelAnimationFrame(ge),ge=requestAnimationFrame(()=>{be!==null&&(Rt(be),be=null),ge=null})},at=()=>{Mt&&(Mt=!1,document.body.style.userSelect="",document.body.style.cursor="",ge!==null&&(cancelAnimationFrame(ge),ge=null),be!==null&&(Rt(be),be=null),nt&&(document.removeEventListener("mousemove",nt),nt=null),at&&(document.removeEventListener("mouseup",at),at=null))},document.addEventListener("mousemove",nt),document.addEventListener("mouseup",at)},t=i=>{i.preventDefault(),i.stopPropagation(),Ro()},a=n.__asriMousedownHandler,r=n.__asriDblclickHandler;a&&n.removeEventListener("mousedown",a),r&&n.removeEventListener("dblclick",r),n.__asriMousedownHandler=e,n.__asriDblclickHandler=t,n.addEventListener("mousedown",e),n.addEventListener("dblclick",t)}function Nr(n){if(Ht)return;let e=n.querySelectorAll('[data-type="wnd"]');if(e.length===0)return;let t=null,a=1/0,r=1/0;if(e.forEach(i=>{let o=i.getBoundingClientRect(),s=o.top,l=o.left;(s<a||s===a&&l<r)&&(a=s,r=l,t=i)}),Ht=!0,e.forEach(i=>{if(i!==t){i.classList.remove("asri-enhance-verticaltab"),i.classList.remove("asri-enhance-verticaltab-toponly"),i.classList.remove("asri-enhance-verticaltab-dockr-expand-spacing");let o=i.querySelector(".layout__resize.layout__resize--lr.asri-enhance-verticaltab-resize");o&&o.remove()}}),t){!t.classList.contains("asri-enhance-verticaltab")&&t.classList.add("asri-enhance-verticaltab"),hn=t;let s=t.getBoundingClientRect().top,l=1,c=!1;e.forEach(k=>{if(k!==t){let b=k.getBoundingClientRect();Math.abs(b.top-s)<=l&&(c=!0)}}),c?t.classList.remove("asri-enhance-verticaltab-toponly"):t.classList.add("asri-enhance-verticaltab-toponly");let m=Array.from(t.children).find(k=>k.classList.contains("fn__flex"));if(m&&m.parentElement){let k=m.parentElement.querySelector(".layout__resize.layout__resize--lr.asri-enhance-verticaltab-resize");k||(k=document.createElement("div"),k.className="layout__resize layout__resize--lr asri-enhance-verticaltab-resize",m.parentElement.insertBefore(k,m.nextSibling)),$o(k)}Or(t)}Ht=!1}function No(){let n=St!=null?St:document.querySelector("#toolbar");if(!n)return 0;St=n;let e=getComputedStyle(n).getPropertyValue("--topbar-right-spacing");if(!e)return 0;let t=parseFloat(e);return isNaN(t)?0:t}function Or(n){let e=n!=null?n:hn;if(!e)return;let t=document.querySelector(".layout__center");if(!t)return;document.querySelector(".layout__dockr > .fn__flex:not(.fn__none)")!==null?t.classList.remove("asri-enhance-dockr-fold"):t.classList.add("asri-enhance-dockr-fold"),No()>0?e.classList.add("asri-enhance-verticaltab-dockr-expand-spacing"):e.classList.remove("asri-enhance-verticaltab-dockr-expand-spacing")}async function Dr(){let n=await Ho();if(n&&(Rt(It),Nr(n),!Me))try{let e=Pt("setUILayout",()=>{let t=document.querySelector(".layout__center");t&&queueMicrotask(()=>{try{Nr(t),Or()}catch(a){}})});Me=()=>{try{e.disconnect()}catch(t){}Me=null}}catch(e){}}function $t(){if(Me){try{Me()}catch(a){}Me=null}let n=document.querySelector(".layout__center");n&&n.classList.remove("asri-enhance-dockr-fold"),document.querySelectorAll('[data-type="wnd"]').forEach(a=>{a.classList.remove("asri-enhance-verticaltab"),a.classList.remove("asri-enhance-verticaltab-toponly"),a.classList.remove("asri-enhance-verticaltab-dockr-expand-spacing");let r=a.querySelector(".layout__resize.layout__resize--lr.asri-enhance-verticaltab-resize");if(r){let i=r.__asriMousedownHandler,o=r.__asriDblclickHandler;i&&(r.removeEventListener("mousedown",i),delete r.__asriMousedownHandler),o&&(r.removeEventListener("dblclick",o),delete r.__asriDblclickHandler),r.remove()}});let t=document.documentElement;t&&t.style.removeProperty("--asri-enhance-vertical-tab-width"),Ht=!1,hn=null}async function Br(n,e){e&&(e.preventDefault(),e.stopPropagation()),Fr=n;let t=document.documentElement;if(!t)return;let a=t.hasAttribute("data-asri-enhance-vertical-tab"),r=await d(n,un)||{};a?(t.removeAttribute("data-asri-enhance-vertical-tab"),r[mn]=!1,$t()):(t.setAttribute("data-asri-enhance-vertical-tab","true"),r[mn]=!0,Dr().catch(()=>{})),await E(n,un,r).catch(()=>{})}async function qr(n,e){Fr=n;let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await d(n,un);a&&a[mn]===!0?(t.setAttribute("data-asri-enhance-vertical-tab","true"),Dr().catch(()=>{})):(t.removeAttribute("data-asri-enhance-vertical-tab"),$t())}function gn(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var ve=gn();function Ur(n){ve=n}var st={exec:()=>null};function I(n,e=""){let t=typeof n=="string"?n:n.source,a={replace:(r,i)=>{let o=typeof i=="string"?i:i.source;return o=o.replace(X.caret,"$1"),t=t.replace(r,o),a},getRegex:()=>new RegExp(t,e)};return a}var Fo=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch(n){return!1}})(),X={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:n=>new RegExp(`^( {0,3}${n})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}#`),htmlBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}<(?:[a-z].*>|!--)`,"i")},Oo=/^(?:[ \t]*(?:\n|$))+/,Do=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Bo=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,lt=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,qo=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,bn=/(?:[*+-]|\d{1,9}[.)])/,Yr=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Xr=I(Yr).replace(/bull/g,bn).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),zo=I(Yr).replace(/bull/g,bn).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),yn=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Go=/^[^\n]+/,vn=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,Ko=I(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",vn).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),jo=I(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,bn).getRegex(),qt="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",kn=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Vo=I("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",kn).replace("tag",qt).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Zr=I(yn).replace("hr",lt).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",qt).getRegex(),Wo=I(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Zr).getRegex(),En={blockquote:Wo,code:Do,def:Ko,fences:Bo,heading:qo,hr:lt,html:Vo,lheading:Xr,list:jo,newline:Oo,paragraph:Zr,table:st,text:Go},zr=I("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",lt).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",qt).getRegex(),Uo={...En,lheading:zo,table:zr,paragraph:I(yn).replace("hr",lt).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",zr).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",qt).getRegex()},Yo={...En,html:I(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",kn).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:st,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:I(yn).replace("hr",lt).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Xr).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Xo=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Zo=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Qr=/^( {2,}|\\)\n(?!\s*$)/,Qo=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,zt=/[\p{P}\p{S}]/u,wn=/[\s\p{P}\p{S}]/u,Jr=/[^\s\p{P}\p{S}]/u,Jo=I(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,wn).getRegex(),ei=/(?!~)[\p{P}\p{S}]/u,es=/(?!~)[\s\p{P}\p{S}]/u,ts=/(?:[^\s\p{P}\p{S}]|~)/u,ns=I(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",Fo?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),ti=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,as=I(ti,"u").replace(/punct/g,zt).getRegex(),rs=I(ti,"u").replace(/punct/g,ei).getRegex(),ni="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",is=I(ni,"gu").replace(/notPunctSpace/g,Jr).replace(/punctSpace/g,wn).replace(/punct/g,zt).getRegex(),os=I(ni,"gu").replace(/notPunctSpace/g,ts).replace(/punctSpace/g,es).replace(/punct/g,ei).getRegex(),ss=I("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Jr).replace(/punctSpace/g,wn).replace(/punct/g,zt).getRegex(),ls=I(/\\(punct)/,"gu").replace(/punct/g,zt).getRegex(),cs=I(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),us=I(kn).replace("(?:-->|$)","-->").getRegex(),ms=I("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",us).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Ot=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,hs=I(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",Ot).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),ai=I(/^!?\[(label)\]\[(ref)\]/).replace("label",Ot).replace("ref",vn).getRegex(),ri=I(/^!?\[(ref)\](?:\[\])?/).replace("ref",vn).getRegex(),ds=I("reflink|nolink(?!\\()","g").replace("reflink",ai).replace("nolink",ri).getRegex(),Gr=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,xn={_backpedal:st,anyPunctuation:ls,autolink:cs,blockSkip:ns,br:Qr,code:Zo,del:st,emStrongLDelim:as,emStrongRDelimAst:is,emStrongRDelimUnd:ss,escape:Xo,link:hs,nolink:ri,punctuation:Jo,reflink:ai,reflinkSearch:ds,tag:ms,text:Qo,url:st},ps={...xn,link:I(/^!?\[(label)\]\((.*?)\)/).replace("label",Ot).getRegex(),reflink:I(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Ot).getRegex()},dn={...xn,emStrongRDelimAst:os,emStrongLDelim:rs,url:I(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",Gr).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:I(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",Gr).getRegex()},fs={...dn,br:I(Qr).replace("{2,}","*").getRegex(),text:I(dn.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Nt={normal:En,gfm:Uo,pedantic:Yo},rt={normal:xn,gfm:dn,breaks:fs,pedantic:ps},gs={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Kr=n=>gs[n];function ce(n,e){if(e){if(X.escapeTest.test(n))return n.replace(X.escapeReplace,Kr)}else if(X.escapeTestNoEncode.test(n))return n.replace(X.escapeReplaceNoEncode,Kr);return n}function jr(n){try{n=encodeURI(n).replace(X.percentDecode,"%")}catch(e){return null}return n}function Vr(n,e){var i;let t=n.replace(X.findPipe,(o,s,l)=>{let c=!1,m=s;for(;--m>=0&&l[m]==="\\";)c=!c;return c?"|":" |"}),a=t.split(X.splitPipe),r=0;if(a[0].trim()||a.shift(),a.length>0&&!((i=a.at(-1))!=null&&i.trim())&&a.pop(),e)if(a.length>e)a.splice(e);else for(;a.length<e;)a.push("");for(;r<a.length;r++)a[r]=a[r].trim().replace(X.slashPipe,"|");return a}function it(n,e,t){let a=n.length;if(a===0)return"";let r=0;for(;r<a;){let i=n.charAt(a-r-1);if(i===e&&!t)r++;else if(i!==e&&t)r++;else break}return n.slice(0,a-r)}function bs(n,e){if(n.indexOf(e[1])===-1)return-1;let t=0;for(let a=0;a<n.length;a++)if(n[a]==="\\")a++;else if(n[a]===e[0])t++;else if(n[a]===e[1]&&(t--,t<0))return a;return t>0?-2:-1}function Wr(n,e,t,a,r){let i=e.href,o=e.title||null,s=n[1].replace(r.other.outputLinkReplace,"$1");a.state.inLink=!0;let l={type:n[0].charAt(0)==="!"?"image":"link",raw:t,href:i,title:o,text:s,tokens:a.inlineTokens(s)};return a.state.inLink=!1,l}function ys(n,e,t){let a=n.match(t.other.indentCodeCompensation);if(a===null)return e;let r=a[1];return e.split(`
`).map(i=>{let o=i.match(t.other.beginningSpace);if(o===null)return i;let[s]=o;return s.length>=r.length?i.slice(r.length):i}).join(`
`)}var Dt=class{constructor(n){B(this,"options");B(this,"rules");B(this,"lexer");this.options=n||ve}space(n){let e=this.rules.block.newline.exec(n);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(n){let e=this.rules.block.code.exec(n);if(e){let t=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?t:it(t,`
`)}}}fences(n){let e=this.rules.block.fences.exec(n);if(e){let t=e[0],a=ys(t,e[3]||"",this.rules);return{type:"code",raw:t,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:a}}}heading(n){let e=this.rules.block.heading.exec(n);if(e){let t=e[2].trim();if(this.rules.other.endingHash.test(t)){let a=it(t,"#");(this.options.pedantic||!a||this.rules.other.endingSpaceChar.test(a))&&(t=a.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:t,tokens:this.lexer.inline(t)}}}hr(n){let e=this.rules.block.hr.exec(n);if(e)return{type:"hr",raw:it(e[0],`
`)}}blockquote(n){let e=this.rules.block.blockquote.exec(n);if(e){let t=it(e[0],`
`).split(`
`),a="",r="",i=[];for(;t.length>0;){let o=!1,s=[],l;for(l=0;l<t.length;l++)if(this.rules.other.blockquoteStart.test(t[l]))s.push(t[l]),o=!0;else if(!o)s.push(t[l]);else break;t=t.slice(l);let c=s.join(`
`),m=c.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");a=a?`${a}
${c}`:c,r=r?`${r}
${m}`:m;let k=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(m,i,!0),this.lexer.state.top=k,t.length===0)break;let b=i.at(-1);if((b==null?void 0:b.type)==="code")break;if((b==null?void 0:b.type)==="blockquote"){let T=b,p=T.raw+`
`+t.join(`
`),_=this.blockquote(p);i[i.length-1]=_,a=a.substring(0,a.length-T.raw.length)+_.raw,r=r.substring(0,r.length-T.text.length)+_.text;break}else if((b==null?void 0:b.type)==="list"){let T=b,p=T.raw+`
`+t.join(`
`),_=this.list(p);i[i.length-1]=_,a=a.substring(0,a.length-b.raw.length)+_.raw,r=r.substring(0,r.length-T.raw.length)+_.raw,t=p.substring(i.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:a,tokens:i,text:r}}}list(n){var t,a;let e=this.rules.block.list.exec(n);if(e){let r=e[1].trim(),i=r.length>1,o={type:"list",raw:"",ordered:i,start:i?+r.slice(0,-1):"",loose:!1,items:[]};r=i?`\\d{1,9}\\${r.slice(-1)}`:`\\${r}`,this.options.pedantic&&(r=i?r:"[*+-]");let s=this.rules.other.listItemRegex(r),l=!1;for(;n;){let m=!1,k="",b="";if(!(e=s.exec(n))||this.rules.block.hr.test(n))break;k=e[0],n=n.substring(k.length);let T=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,h=>" ".repeat(3*h.length)),p=n.split(`
`,1)[0],_=!T.trim(),C=0;if(this.options.pedantic?(C=2,b=T.trimStart()):_?C=e[1].length+1:(C=e[2].search(this.rules.other.nonSpaceChar),C=C>4?1:C,b=T.slice(C),C+=e[1].length),_&&this.rules.other.blankLine.test(p)&&(k+=p+`
`,n=n.substring(p.length+1),m=!0),!m){let h=this.rules.other.nextBulletRegex(C),y=this.rules.other.hrRegex(C),S=this.rules.other.fencesBeginRegex(C),F=this.rules.other.headingBeginRegex(C),q=this.rules.other.htmlBeginRegex(C);for(;n;){let D=n.split(`
`,1)[0],z;if(p=D,this.options.pedantic?(p=p.replace(this.rules.other.listReplaceNesting,"  "),z=p):z=p.replace(this.rules.other.tabCharGlobal,"    "),S.test(p)||F.test(p)||q.test(p)||h.test(p)||y.test(p))break;if(z.search(this.rules.other.nonSpaceChar)>=C||!p.trim())b+=`
`+z.slice(C);else{if(_||T.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||S.test(T)||F.test(T)||y.test(T))break;b+=`
`+p}!_&&!p.trim()&&(_=!0),k+=D+`
`,n=n.substring(D.length+1),T=z.slice(C)}}o.loose||(l?o.loose=!0:this.rules.other.doubleBlankLine.test(k)&&(l=!0)),o.items.push({type:"list_item",raw:k,task:!!this.options.gfm&&this.rules.other.listIsTask.test(b),loose:!1,text:b,tokens:[]}),o.raw+=k}let c=o.items.at(-1);if(c)c.raw=c.raw.trimEnd(),c.text=c.text.trimEnd();else return;o.raw=o.raw.trimEnd();for(let m of o.items){if(this.lexer.state.top=!1,m.tokens=this.lexer.blockTokens(m.text,[]),m.task){if(m.text=m.text.replace(this.rules.other.listReplaceTask,""),((t=m.tokens[0])==null?void 0:t.type)==="text"||((a=m.tokens[0])==null?void 0:a.type)==="paragraph"){m.tokens[0].raw=m.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),m.tokens[0].text=m.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let b=this.lexer.inlineQueue.length-1;b>=0;b--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[b].src)){this.lexer.inlineQueue[b].src=this.lexer.inlineQueue[b].src.replace(this.rules.other.listReplaceTask,"");break}}let k=this.rules.other.listTaskCheckbox.exec(m.raw);if(k){let b={type:"checkbox",raw:k[0]+" ",checked:k[0]!=="[ ]"};m.checked=b.checked,o.loose?m.tokens[0]&&["paragraph","text"].includes(m.tokens[0].type)&&"tokens"in m.tokens[0]&&m.tokens[0].tokens?(m.tokens[0].raw=b.raw+m.tokens[0].raw,m.tokens[0].text=b.raw+m.tokens[0].text,m.tokens[0].tokens.unshift(b)):m.tokens.unshift({type:"paragraph",raw:b.raw,text:b.raw,tokens:[b]}):m.tokens.unshift(b)}}if(!o.loose){let k=m.tokens.filter(T=>T.type==="space"),b=k.length>0&&k.some(T=>this.rules.other.anyLine.test(T.raw));o.loose=b}}if(o.loose)for(let m of o.items){m.loose=!0;for(let k of m.tokens)k.type==="text"&&(k.type="paragraph")}return o}}html(n){let e=this.rules.block.html.exec(n);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(n){let e=this.rules.block.def.exec(n);if(e){let t=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),a=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",r=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:t,raw:e[0],href:a,title:r}}}table(n){var o;let e=this.rules.block.table.exec(n);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let t=Vr(e[1]),a=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),r=(o=e[3])!=null&&o.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],i={type:"table",raw:e[0],header:[],align:[],rows:[]};if(t.length===a.length){for(let s of a)this.rules.other.tableAlignRight.test(s)?i.align.push("right"):this.rules.other.tableAlignCenter.test(s)?i.align.push("center"):this.rules.other.tableAlignLeft.test(s)?i.align.push("left"):i.align.push(null);for(let s=0;s<t.length;s++)i.header.push({text:t[s],tokens:this.lexer.inline(t[s]),header:!0,align:i.align[s]});for(let s of r)i.rows.push(Vr(s,i.header.length).map((l,c)=>({text:l,tokens:this.lexer.inline(l),header:!1,align:i.align[c]})));return i}}lheading(n){let e=this.rules.block.lheading.exec(n);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(n){let e=this.rules.block.paragraph.exec(n);if(e){let t=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:t,tokens:this.lexer.inline(t)}}}text(n){let e=this.rules.block.text.exec(n);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(n){let e=this.rules.inline.escape.exec(n);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(n){let e=this.rules.inline.tag.exec(n);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(n){let e=this.rules.inline.link.exec(n);if(e){let t=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(t)){if(!this.rules.other.endAngleBracket.test(t))return;let i=it(t.slice(0,-1),"\\");if((t.length-i.length)%2===0)return}else{let i=bs(e[2],"()");if(i===-2)return;if(i>-1){let o=(e[0].indexOf("!")===0?5:4)+e[1].length+i;e[2]=e[2].substring(0,i),e[0]=e[0].substring(0,o).trim(),e[3]=""}}let a=e[2],r="";if(this.options.pedantic){let i=this.rules.other.pedanticHrefTitle.exec(a);i&&(a=i[1],r=i[3])}else r=e[3]?e[3].slice(1,-1):"";return a=a.trim(),this.rules.other.startAngleBracket.test(a)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(t)?a=a.slice(1):a=a.slice(1,-1)),Wr(e,{href:a&&a.replace(this.rules.inline.anyPunctuation,"$1"),title:r&&r.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(n,e){let t;if((t=this.rules.inline.reflink.exec(n))||(t=this.rules.inline.nolink.exec(n))){let a=(t[2]||t[1]).replace(this.rules.other.multipleSpaceGlobal," "),r=e[a.toLowerCase()];if(!r){let i=t[0].charAt(0);return{type:"text",raw:i,text:i}}return Wr(t,r,t[0],this.lexer,this.rules)}}emStrong(n,e,t=""){let a=this.rules.inline.emStrongLDelim.exec(n);if(!(!a||a[3]&&t.match(this.rules.other.unicodeAlphaNumeric))&&(!(a[1]||a[2])||!t||this.rules.inline.punctuation.exec(t))){let r=[...a[0]].length-1,i,o,s=r,l=0,c=a[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(c.lastIndex=0,e=e.slice(-1*n.length+r);(a=c.exec(e))!=null;){if(i=a[1]||a[2]||a[3]||a[4]||a[5]||a[6],!i)continue;if(o=[...i].length,a[3]||a[4]){s+=o;continue}else if((a[5]||a[6])&&r%3&&!((r+o)%3)){l+=o;continue}if(s-=o,s>0)continue;o=Math.min(o,o+s+l);let m=[...a[0]][0].length,k=n.slice(0,r+a.index+m+o);if(Math.min(r,o)%2){let T=k.slice(1,-1);return{type:"em",raw:k,text:T,tokens:this.lexer.inlineTokens(T)}}let b=k.slice(2,-2);return{type:"strong",raw:k,text:b,tokens:this.lexer.inlineTokens(b)}}}}codespan(n){let e=this.rules.inline.code.exec(n);if(e){let t=e[2].replace(this.rules.other.newLineCharGlobal," "),a=this.rules.other.nonSpaceChar.test(t),r=this.rules.other.startingSpaceChar.test(t)&&this.rules.other.endingSpaceChar.test(t);return a&&r&&(t=t.substring(1,t.length-1)),{type:"codespan",raw:e[0],text:t}}}br(n){let e=this.rules.inline.br.exec(n);if(e)return{type:"br",raw:e[0]}}del(n){let e=this.rules.inline.del.exec(n);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(n){let e=this.rules.inline.autolink.exec(n);if(e){let t,a;return e[2]==="@"?(t=e[1],a="mailto:"+t):(t=e[1],a=t),{type:"link",raw:e[0],text:t,href:a,tokens:[{type:"text",raw:t,text:t}]}}}url(n){var t,a;let e;if(e=this.rules.inline.url.exec(n)){let r,i;if(e[2]==="@")r=e[0],i="mailto:"+r;else{let o;do o=e[0],e[0]=(a=(t=this.rules.inline._backpedal.exec(e[0]))==null?void 0:t[0])!=null?a:"";while(o!==e[0]);r=e[0],e[1]==="www."?i="http://"+e[0]:i=e[0]}return{type:"link",raw:e[0],text:r,href:i,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(n){let e=this.rules.inline.text.exec(n);if(e){let t=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:t}}}},ie=class pn{constructor(e){B(this,"tokens");B(this,"options");B(this,"state");B(this,"inlineQueue");B(this,"tokenizer");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||ve,this.options.tokenizer=this.options.tokenizer||new Dt,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let t={other:X,block:Nt.normal,inline:rt.normal};this.options.pedantic?(t.block=Nt.pedantic,t.inline=rt.pedantic):this.options.gfm&&(t.block=Nt.gfm,this.options.breaks?t.inline=rt.breaks:t.inline=rt.gfm),this.tokenizer.rules=t}static get rules(){return{block:Nt,inline:rt}}static lex(e,t){return new pn(t).lex(e)}static lexInline(e,t){return new pn(t).inlineTokens(e)}lex(e){e=e.replace(X.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){let a=this.inlineQueue[t];this.inlineTokens(a.src,a.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],a=!1){var r,i,o;for(this.options.pedantic&&(e=e.replace(X.tabCharGlobal,"    ").replace(X.spaceLine,""));e;){let s;if((i=(r=this.options.extensions)==null?void 0:r.block)!=null&&i.some(c=>(s=c.call({lexer:this},e,t))?(e=e.substring(s.raw.length),t.push(s),!0):!1))continue;if(s=this.tokenizer.space(e)){e=e.substring(s.raw.length);let c=t.at(-1);s.raw.length===1&&c!==void 0?c.raw+=`
`:t.push(s);continue}if(s=this.tokenizer.code(e)){e=e.substring(s.raw.length);let c=t.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=(c.raw.endsWith(`
`)?"":`
`)+s.raw,c.text+=`
`+s.text,this.inlineQueue.at(-1).src=c.text):t.push(s);continue}if(s=this.tokenizer.fences(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.heading(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.hr(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.blockquote(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.list(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.html(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.def(e)){e=e.substring(s.raw.length);let c=t.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=(c.raw.endsWith(`
`)?"":`
`)+s.raw,c.text+=`
`+s.raw,this.inlineQueue.at(-1).src=c.text):this.tokens.links[s.tag]||(this.tokens.links[s.tag]={href:s.href,title:s.title},t.push(s));continue}if(s=this.tokenizer.table(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.lheading(e)){e=e.substring(s.raw.length),t.push(s);continue}let l=e;if((o=this.options.extensions)!=null&&o.startBlock){let c=1/0,m=e.slice(1),k;this.options.extensions.startBlock.forEach(b=>{k=b.call({lexer:this},m),typeof k=="number"&&k>=0&&(c=Math.min(c,k))}),c<1/0&&c>=0&&(l=e.substring(0,c+1))}if(this.state.top&&(s=this.tokenizer.paragraph(l))){let c=t.at(-1);a&&(c==null?void 0:c.type)==="paragraph"?(c.raw+=(c.raw.endsWith(`
`)?"":`
`)+s.raw,c.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):t.push(s),a=l.length!==e.length,e=e.substring(s.raw.length);continue}if(s=this.tokenizer.text(e)){e=e.substring(s.raw.length);let c=t.at(-1);(c==null?void 0:c.type)==="text"?(c.raw+=(c.raw.endsWith(`
`)?"":`
`)+s.raw,c.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):t.push(s);continue}if(e){let c="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){var l,c,m,k,b,T;let a=e,r=null;if(this.tokens.links){let p=Object.keys(this.tokens.links);if(p.length>0)for(;(r=this.tokenizer.rules.inline.reflinkSearch.exec(a))!=null;)p.includes(r[0].slice(r[0].lastIndexOf("[")+1,-1))&&(a=a.slice(0,r.index)+"["+"a".repeat(r[0].length-2)+"]"+a.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(r=this.tokenizer.rules.inline.anyPunctuation.exec(a))!=null;)a=a.slice(0,r.index)+"++"+a.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let i;for(;(r=this.tokenizer.rules.inline.blockSkip.exec(a))!=null;)i=r[2]?r[2].length:0,a=a.slice(0,r.index+i)+"["+"a".repeat(r[0].length-i-2)+"]"+a.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);a=(m=(c=(l=this.options.hooks)==null?void 0:l.emStrongMask)==null?void 0:c.call({lexer:this},a))!=null?m:a;let o=!1,s="";for(;e;){o||(s=""),o=!1;let p;if((b=(k=this.options.extensions)==null?void 0:k.inline)!=null&&b.some(C=>(p=C.call({lexer:this},e,t))?(e=e.substring(p.raw.length),t.push(p),!0):!1))continue;if(p=this.tokenizer.escape(e)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.tag(e)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.link(e)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(p.raw.length);let C=t.at(-1);p.type==="text"&&(C==null?void 0:C.type)==="text"?(C.raw+=p.raw,C.text+=p.text):t.push(p);continue}if(p=this.tokenizer.emStrong(e,a,s)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.codespan(e)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.br(e)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.del(e)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.autolink(e)){e=e.substring(p.raw.length),t.push(p);continue}if(!this.state.inLink&&(p=this.tokenizer.url(e))){e=e.substring(p.raw.length),t.push(p);continue}let _=e;if((T=this.options.extensions)!=null&&T.startInline){let C=1/0,h=e.slice(1),y;this.options.extensions.startInline.forEach(S=>{y=S.call({lexer:this},h),typeof y=="number"&&y>=0&&(C=Math.min(C,y))}),C<1/0&&C>=0&&(_=e.substring(0,C+1))}if(p=this.tokenizer.inlineText(_)){e=e.substring(p.raw.length),p.raw.slice(-1)!=="_"&&(s=p.raw.slice(-1)),o=!0;let C=t.at(-1);(C==null?void 0:C.type)==="text"?(C.raw+=p.raw,C.text+=p.text):t.push(p);continue}if(e){let C="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(C);break}else throw new Error(C)}}return t}},Bt=class{constructor(n){B(this,"options");B(this,"parser");this.options=n||ve}space(n){return""}code({text:n,lang:e,escaped:t}){var i;let a=(i=(e||"").match(X.notSpaceStart))==null?void 0:i[0],r=n.replace(X.endingNewline,"")+`
`;return a?'<pre><code class="language-'+ce(a)+'">'+(t?r:ce(r,!0))+`</code></pre>
`:"<pre><code>"+(t?r:ce(r,!0))+`</code></pre>
`}blockquote({tokens:n}){return`<blockquote>
${this.parser.parse(n)}</blockquote>
`}html({text:n}){return n}def(n){return""}heading({tokens:n,depth:e}){return`<h${e}>${this.parser.parseInline(n)}</h${e}>
`}hr(n){return`<hr>
`}list(n){let e=n.ordered,t=n.start,a="";for(let o=0;o<n.items.length;o++){let s=n.items[o];a+=this.listitem(s)}let r=e?"ol":"ul",i=e&&t!==1?' start="'+t+'"':"";return"<"+r+i+`>
`+a+"</"+r+`>
`}listitem(n){return`<li>${this.parser.parse(n.tokens)}</li>
`}checkbox({checked:n}){return"<input "+(n?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:n}){return`<p>${this.parser.parseInline(n)}</p>
`}table(n){let e="",t="";for(let r=0;r<n.header.length;r++)t+=this.tablecell(n.header[r]);e+=this.tablerow({text:t});let a="";for(let r=0;r<n.rows.length;r++){let i=n.rows[r];t="";for(let o=0;o<i.length;o++)t+=this.tablecell(i[o]);a+=this.tablerow({text:t})}return a&&(a=`<tbody>${a}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+a+`</table>
`}tablerow({text:n}){return`<tr>
${n}</tr>
`}tablecell(n){let e=this.parser.parseInline(n.tokens),t=n.header?"th":"td";return(n.align?`<${t} align="${n.align}">`:`<${t}>`)+e+`</${t}>
`}strong({tokens:n}){return`<strong>${this.parser.parseInline(n)}</strong>`}em({tokens:n}){return`<em>${this.parser.parseInline(n)}</em>`}codespan({text:n}){return`<code>${ce(n,!0)}</code>`}br(n){return"<br>"}del({tokens:n}){return`<del>${this.parser.parseInline(n)}</del>`}link({href:n,title:e,tokens:t}){let a=this.parser.parseInline(t),r=jr(n);if(r===null)return a;n=r;let i='<a href="'+n+'"';return e&&(i+=' title="'+ce(e)+'"'),i+=">"+a+"</a>",i}image({href:n,title:e,text:t,tokens:a}){a&&(t=this.parser.parseInline(a,this.parser.textRenderer));let r=jr(n);if(r===null)return ce(t);n=r;let i=`<img src="${n}" alt="${t}"`;return e&&(i+=` title="${ce(e)}"`),i+=">",i}text(n){return"tokens"in n&&n.tokens?this.parser.parseInline(n.tokens):"escaped"in n&&n.escaped?n.text:ce(n.text)}},Tn=class{strong({text:n}){return n}em({text:n}){return n}codespan({text:n}){return n}del({text:n}){return n}html({text:n}){return n}text({text:n}){return n}link({text:n}){return""+n}image({text:n}){return""+n}br(){return""}checkbox({raw:n}){return n}},oe=class fn{constructor(e){B(this,"options");B(this,"renderer");B(this,"textRenderer");this.options=e||ve,this.options.renderer=this.options.renderer||new Bt,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Tn}static parse(e,t){return new fn(t).parse(e)}static parseInline(e,t){return new fn(t).parseInline(e)}parse(e){var a,r;let t="";for(let i=0;i<e.length;i++){let o=e[i];if((r=(a=this.options.extensions)==null?void 0:a.renderers)!=null&&r[o.type]){let l=o,c=this.options.extensions.renderers[l.type].call({parser:this},l);if(c!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(l.type)){t+=c||"";continue}}let s=o;switch(s.type){case"space":{t+=this.renderer.space(s);break}case"hr":{t+=this.renderer.hr(s);break}case"heading":{t+=this.renderer.heading(s);break}case"code":{t+=this.renderer.code(s);break}case"table":{t+=this.renderer.table(s);break}case"blockquote":{t+=this.renderer.blockquote(s);break}case"list":{t+=this.renderer.list(s);break}case"checkbox":{t+=this.renderer.checkbox(s);break}case"html":{t+=this.renderer.html(s);break}case"def":{t+=this.renderer.def(s);break}case"paragraph":{t+=this.renderer.paragraph(s);break}case"text":{t+=this.renderer.text(s);break}default:{let l='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(l),"";throw new Error(l)}}}return t}parseInline(e,t=this.renderer){var r,i;let a="";for(let o=0;o<e.length;o++){let s=e[o];if((i=(r=this.options.extensions)==null?void 0:r.renderers)!=null&&i[s.type]){let c=this.options.extensions.renderers[s.type].call({parser:this},s);if(c!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){a+=c||"";continue}}let l=s;switch(l.type){case"escape":{a+=t.text(l);break}case"html":{a+=t.html(l);break}case"link":{a+=t.link(l);break}case"image":{a+=t.image(l);break}case"checkbox":{a+=t.checkbox(l);break}case"strong":{a+=t.strong(l);break}case"em":{a+=t.em(l);break}case"codespan":{a+=t.codespan(l);break}case"br":{a+=t.br(l);break}case"del":{a+=t.del(l);break}case"text":{a+=t.text(l);break}default:{let c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return a}},Ft,ot=(Ft=class{constructor(n){B(this,"options");B(this,"block");this.options=n||ve}preprocess(n){return n}postprocess(n){return n}processAllTokens(n){return n}emStrongMask(n){return n}provideLexer(){return this.block?ie.lex:ie.lexInline}provideParser(){return this.block?oe.parse:oe.parseInline}},B(Ft,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens","emStrongMask"])),B(Ft,"passThroughHooksRespectAsync",new Set(["preprocess","postprocess","processAllTokens"])),Ft),vs=class{constructor(...n){B(this,"defaults",gn());B(this,"options",this.setOptions);B(this,"parse",this.parseMarkdown(!0));B(this,"parseInline",this.parseMarkdown(!1));B(this,"Parser",oe);B(this,"Renderer",Bt);B(this,"TextRenderer",Tn);B(this,"Lexer",ie);B(this,"Tokenizer",Dt);B(this,"Hooks",ot);this.use(...n)}walkTokens(n,e){var a,r;let t=[];for(let i of n)switch(t=t.concat(e.call(this,i)),i.type){case"table":{let o=i;for(let s of o.header)t=t.concat(this.walkTokens(s.tokens,e));for(let s of o.rows)for(let l of s)t=t.concat(this.walkTokens(l.tokens,e));break}case"list":{let o=i;t=t.concat(this.walkTokens(o.items,e));break}default:{let o=i;(r=(a=this.defaults.extensions)==null?void 0:a.childTokens)!=null&&r[o.type]?this.defaults.extensions.childTokens[o.type].forEach(s=>{let l=o[s].flat(1/0);t=t.concat(this.walkTokens(l,e))}):o.tokens&&(t=t.concat(this.walkTokens(o.tokens,e)))}}return t}use(...n){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return n.forEach(t=>{let a={...t};if(a.async=this.defaults.async||a.async||!1,t.extensions&&(t.extensions.forEach(r=>{if(!r.name)throw new Error("extension name required");if("renderer"in r){let i=e.renderers[r.name];i?e.renderers[r.name]=function(...o){let s=r.renderer.apply(this,o);return s===!1&&(s=i.apply(this,o)),s}:e.renderers[r.name]=r.renderer}if("tokenizer"in r){if(!r.level||r.level!=="block"&&r.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let i=e[r.level];i?i.unshift(r.tokenizer):e[r.level]=[r.tokenizer],r.start&&(r.level==="block"?e.startBlock?e.startBlock.push(r.start):e.startBlock=[r.start]:r.level==="inline"&&(e.startInline?e.startInline.push(r.start):e.startInline=[r.start]))}"childTokens"in r&&r.childTokens&&(e.childTokens[r.name]=r.childTokens)}),a.extensions=e),t.renderer){let r=this.defaults.renderer||new Bt(this.defaults);for(let i in t.renderer){if(!(i in r))throw new Error(`renderer '${i}' does not exist`);if(["options","parser"].includes(i))continue;let o=i,s=t.renderer[o],l=r[o];r[o]=(...c)=>{let m=s.apply(r,c);return m===!1&&(m=l.apply(r,c)),m||""}}a.renderer=r}if(t.tokenizer){let r=this.defaults.tokenizer||new Dt(this.defaults);for(let i in t.tokenizer){if(!(i in r))throw new Error(`tokenizer '${i}' does not exist`);if(["options","rules","lexer"].includes(i))continue;let o=i,s=t.tokenizer[o],l=r[o];r[o]=(...c)=>{let m=s.apply(r,c);return m===!1&&(m=l.apply(r,c)),m}}a.tokenizer=r}if(t.hooks){let r=this.defaults.hooks||new ot;for(let i in t.hooks){if(!(i in r))throw new Error(`hook '${i}' does not exist`);if(["options","block"].includes(i))continue;let o=i,s=t.hooks[o],l=r[o];ot.passThroughHooks.has(i)?r[o]=c=>{if(this.defaults.async&&ot.passThroughHooksRespectAsync.has(i))return(async()=>{let k=await s.call(r,c);return l.call(r,k)})();let m=s.call(r,c);return l.call(r,m)}:r[o]=(...c)=>{if(this.defaults.async)return(async()=>{let k=await s.apply(r,c);return k===!1&&(k=await l.apply(r,c)),k})();let m=s.apply(r,c);return m===!1&&(m=l.apply(r,c)),m}}a.hooks=r}if(t.walkTokens){let r=this.defaults.walkTokens,i=t.walkTokens;a.walkTokens=function(o){let s=[];return s.push(i.call(this,o)),r&&(s=s.concat(r.call(this,o))),s}}this.defaults={...this.defaults,...a}}),this}setOptions(n){return this.defaults={...this.defaults,...n},this}lexer(n,e){return ie.lex(n,e!=null?e:this.defaults)}parser(n,e){return oe.parse(n,e!=null?e:this.defaults)}parseMarkdown(n){return(e,t)=>{let a={...t},r={...this.defaults,...a},i=this.onError(!!r.silent,!!r.async);if(this.defaults.async===!0&&a.async===!1)return i(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return i(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return i(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(r.hooks&&(r.hooks.options=r,r.hooks.block=n),r.async)return(async()=>{let o=r.hooks?await r.hooks.preprocess(e):e,s=await(r.hooks?await r.hooks.provideLexer():n?ie.lex:ie.lexInline)(o,r),l=r.hooks?await r.hooks.processAllTokens(s):s;r.walkTokens&&await Promise.all(this.walkTokens(l,r.walkTokens));let c=await(r.hooks?await r.hooks.provideParser():n?oe.parse:oe.parseInline)(l,r);return r.hooks?await r.hooks.postprocess(c):c})().catch(i);try{r.hooks&&(e=r.hooks.preprocess(e));let o=(r.hooks?r.hooks.provideLexer():n?ie.lex:ie.lexInline)(e,r);r.hooks&&(o=r.hooks.processAllTokens(o)),r.walkTokens&&this.walkTokens(o,r.walkTokens);let s=(r.hooks?r.hooks.provideParser():n?oe.parse:oe.parseInline)(o,r);return r.hooks&&(s=r.hooks.postprocess(s)),s}catch(o){return i(o)}}}onError(n,e){return t=>{if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,n){let a="<p>An error occurred:</p><pre>"+ce(t.message+"",!0)+"</pre>";return e?Promise.resolve(a):a}if(e)return Promise.reject(t);throw t}}},ye=new vs;function x(n,e){return ye.parse(n,e)}x.options=x.setOptions=function(n){return ye.setOptions(n),x.defaults=ye.defaults,Ur(x.defaults),x};x.getDefaults=gn;x.defaults=ve;x.use=function(...n){return ye.use(...n),x.defaults=ye.defaults,Ur(x.defaults),x};x.walkTokens=function(n,e){return ye.walkTokens(n,e)};x.parseInline=ye.parseInline;x.Parser=oe;x.parser=oe.parse;x.Renderer=Bt;x.TextRenderer=Tn;x.Lexer=ie;x.lexer=ie.lex;x.Tokenizer=Dt;x.Hooks=ot;x.parse=x;var lc=x.options,cc=x.setOptions,uc=x.use,mc=x.walkTokens,hc=x.parseInline;var dc=oe.parse,pc=ie.lex;var ks=/^(\${1,2})(?!\$)((?:\\.|[^\\\n])*?(?:\\.|[^\\\n\$]))\1(?=[\s?!\.,:？！。，：]|$)/,Es=/^(\${1,2})(?!\$)((?:\\.|[^\\\n])*?(?:\\.|[^\\\n\$]))\1/,ws=/^(\${1,2})\n((?:\\[^]|[^\\])+?)\n\1(?:\n|$)/;function Cn(n={}){return{extensions:[xs(n,ii(n,!1)),Ts(n,ii(n,!0))]}}function ii(n,e){return t=>{try{let a=typeof window!="undefined"&&window.katex?window.katex:null;if(a&&typeof a.renderToString=="function")try{return a.renderToString(t.text,{...n,displayMode:t.displayMode})+(e?`
`:"")}catch(r){}}catch(a){}return t.raw+(e?`
`:"")}}function xs(n,e){let t=n&&n.nonStandard,a=t?Es:ks;return{name:"inlineKatex",level:"inline",start(r){let i,o=r;for(;o;){if(i=o.indexOf("$"),i===-1)return;if((t?i>-1:i===0||o.charAt(i-1)===" ")&&o.substring(i).match(a))return i;o=o.substring(i+1).replace(/^\$+/,"")}},tokenizer(r,i){let o=r.match(a);if(o)return{type:"inlineKatex",raw:o[0],text:o[2].trim(),displayMode:o[1].length===2}},renderer:e}}function Ts(n,e){return{name:"blockKatex",level:"block",tokenizer(t,a){let r=t.match(ws);if(r)return{type:"blockKatex",raw:r[0],text:r[2].trim(),displayMode:r[1].length===2}},renderer:e}}var Gt=null;try{x&&typeof x.use=="function"&&typeof Cn=="function"&&x.use(Cn({throwOnError:!1}))}catch(n){}try{let n=window==null?void 0:window.hljs;x&&typeof x.setOptions=="function"&&x.setOptions({highlight:(e,t)=>{try{if(n){if(t&&n.getLanguage&&n.getLanguage(t))return n.highlight(e,{language:t}).value;if(n.highlightAuto)return n.highlightAuto(e).value}}catch(a){}return e}})}catch(n){}function _n(n){try{let e=window==null?void 0:window.hljs;if(!e)return;Array.from(n.querySelectorAll("pre code")).forEach(a=>{try{if(typeof e.highlightElement=="function")e.highlightElement(a);else{let i=(a.className||"").match(/language-([a-z0-9-]+)/i),o=i&&i[1]||"",s=a.textContent||"";o&&e.getLanguage&&e.getLanguage(o)?a.innerHTML=e.highlight(s,{language:o}).value:e.highlightAuto&&(a.innerHTML=e.highlightAuto(s).value)}}catch(r){}})}catch(e){}}async function Cs(){var n;try{await fetch("/api/notification/pushMsg",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({msg:(n=Gt==null?void 0:Gt.i18n)==null?void 0:n.mergedSideMemoEditTip,timeout:3e3})})}catch(e){}}async function oi(){try{let n=document.head,e=(o,s)=>{try{if(document.getElementById(o))return;let l=document.createElement("link");l.id=o,l.rel="stylesheet",l.type="text/css",l.href=s,n.appendChild(l)}catch(l){}},t=(o,s)=>new Promise((l,c)=>{try{if(document.getElementById(o)){l();return}let m=document.createElement("script");m.id=o,m.src=s,m.async=!0,m.onload=()=>{try{l()}catch(k){}},m.onerror=()=>{try{c()}catch(k){}},n.appendChild(m)}catch(m){c(m)}}),a=!window.katex,r=!window.hljs;if(!a&&!r)return!0;let i=[];a&&(i.push({type:"link",id:"protyleKatexStyle",href:"/stage/protyle/js/katex/katex.min.css?v=0.16.9"}),i.push({type:"script",id:"protyleKatexScript",src:"/stage/protyle/js/katex/katex.min.js?v=0.16.9"}),i.push({type:"script",id:"protyleKatexMhchemScript",src:"/stage/protyle/js/katex/mhchem.min.js?v=0.16.9"})),r&&(i.push({type:"link",id:"protyleHljsStyle",href:"/stage/protyle/js/highlight.js/styles/github.min.css?v=11.11.1"}),i.push({type:"script",id:"protyleHljsScript",src:"/stage/protyle/js/highlight.js/highlight.min.js?v=11.11.1"}));for(let o of i)try{o.type==="link"?e(o.id,o.href):await t(o.id,o.src)}catch(s){}}catch(n){}return window.katex!==void 0||window.hljs!==void 0}var Ln="config.json",Pn="asri-enhance-side-memo",Se=null;function An(n){try{if(!n||n.__asriNoRightClickAttached)return;n.__asriNoRightClickAttached=!0;let e=t=>{try{if(t.type==="contextmenu"){t.preventDefault(),t.stopPropagation();return}let a=t;if(typeof a.button=="number"&&a.button===2){try{a.preventDefault()}catch(r){}try{a.stopPropagation()}catch(r){}}}catch(a){}};try{n.addEventListener("contextmenu",e,{capture:!0,passive:!1}),n.addEventListener("mousedown",e,{capture:!0,passive:!1}),n.addEventListener("mouseup",e,{capture:!0,passive:!1})}catch(t){}}catch(e){}}function me(){Array.from(document.querySelectorAll(".protyle-title")).forEach(r=>{try{let i=r.getBoundingClientRect().height;r.style.setProperty("--asri-enhance-sidememo-title-height",`${i}px`)}catch(i){}});let e=document.documentElement,t=!!(e&&e.hasAttribute("data-asri-enhance-side-memo"));if(Array.from(document.querySelectorAll(".protyle-content")).forEach(r=>{try{let i=r.querySelector('[data-type*="inline-memo"], [memo]')!==null;t&&i?(r.classList.add("asri-enhance-sidememo"),r.classList.remove("asri-enhance-sidememo-none")):(r.classList.remove("asri-enhance-sidememo"),r.classList.add("asri-enhance-sidememo-none"))}catch(i){}}),t)ct();else try{Array.from(document.querySelectorAll(".asri-enhance-sidememo-container")).forEach(i=>{try{i.remove()}catch(o){}})}catch(r){}}function ct(){if(Array.from(document.querySelectorAll(".asri-enhance-sidememo .protyle-top .protyle-title")).forEach(t=>{try{let a=t.querySelector(".asri-enhance-sidememo-container");a||(a=document.createElement("div"),a.className="asri-enhance-sidememo-container protyle-custom",t.appendChild(a));try{let i=t.closest(".protyle-top");i&&(t.classList.contains("fn__none")?i.classList.add("asri-enhance-sidememo-protyle-title-none"):i.classList.remove("asri-enhance-sidememo-protyle-title-none"))}catch(i){}try{An(a)}catch(i){}try{let i=getComputedStyle(t).position;(!i||i==="static")&&(t.style.position="relative")}catch(i){}let r=t.closest(".protyle-content");if(r){_s(a,r);try{An(a)}catch(i){}}}catch(a){}}),Array.from(document.querySelectorAll(".protyle-top .protyle-title > .asri-enhance-sidememo-container")).forEach(t=>{let a=t.parentElement;if(a)if(a.closest(".asri-enhance-sidememo"))try{An(t)}catch(r){}else try{try{let r=a.closest(".protyle-top");r&&r.classList.remove("asri-enhance-sidememo-protyle-title-none")}catch(r){}t.remove()}catch(r){}}),!Se){Se=t=>{try{let a=t.target;if(!a||!a.closest)return;let r=a.closest(".asri-enhance-sidememo-inlinememo-item-title, .asri-enhance-sidememo-blockmemo-item-title, .asri-enhance-sidememo-filememo-item-title");if(!r)return;let i=r.closest(".asri-enhance-sidememo-inlinememo-item, .asri-enhance-sidememo-blockmemo-item, .asri-enhance-sidememo-filememo-item");if(!i)return;try{t.preventDefault(),t.stopPropagation()}catch(o){}try{let o=i.classList.toggle("asri-enhance-sidememo-item-fold");try{let s=i.getAttribute("asri-enhance-sidememo-uid");if(s){let l=`[data-type*="inline-memo"][asri-enhance-sidememo-uid="${s}"], [memo][asri-enhance-sidememo-uid="${s}"]`;Array.from(document.querySelectorAll(l)).forEach(m=>{if(m&&m.setAttribute)if(o)m.setAttribute("asri-enhance-sidememo-fold","true");else try{m.removeAttribute("asri-enhance-sidememo-fold")}catch(k){}})}}catch(s){}try{me(),ct()}catch(s){}}catch(o){}}catch(a){}};try{document.addEventListener("contextmenu",Se,!0)}catch(t){}}}function _s(n,e){for(Array.from(e.querySelectorAll('[data-type*="inline-memo"], [memo]')).forEach(h=>{try{let y=h.__asriSidememoHandlers;y&&(y.enter&&h.removeEventListener("mouseenter",y.enter),y.leave&&h.removeEventListener("mouseleave",y.leave),delete h.__asriSidememoHandlers)}catch(y){}});n.firstChild;){let h=n.firstChild;try{let y=h.__asriSidememoHandlers;if(y){y.enter&&h.removeEventListener("mouseenter",y.enter),y.leave&&h.removeEventListener("mouseleave",y.leave),y.click&&h.removeEventListener("click",y.click),y.mousedown&&h.removeEventListener("mousedown",y.mousedown),y._preMove&&document.removeEventListener("mousemove",y._preMove),y._preUp&&document.removeEventListener("mouseup",y._preUp),y._dragMove&&document.removeEventListener("mousemove",y._dragMove),y._dragUp&&document.removeEventListener("mouseup",y._dragUp),y._timer&&clearTimeout(y._timer);try{y._asriContainer&&y._asriContainer.classList.remove("asri-enhance-sidememo-container-resize"),y._asriParent&&y._asriParent.classList.remove("asri-enhance-sidememo-container-resize")}catch(S){}delete h.__asriSidememoHandlers}}catch(y){}n.removeChild(h)}let a=Array.from(e.querySelectorAll('[data-type*="inline-memo"], [memo]')),r=[],i=a.filter(h=>{var y;return h.hasAttribute("data-type")&&((y=h.getAttribute("data-type"))==null?void 0:y.split(/\s+/).includes("inline-memo"))&&!h.closest(".av__gallery-content")}),o=new Set,s=[];i.forEach((h,y)=>{if(o.has(h))return;let S=h.getAttribute("data-inline-memo-content")||"",F=[h];o.add(h);for(let q=y+1;q<i.length;q++){let D=i[q];if(o.has(D))continue;let z=D.getAttribute("data-inline-memo-content")||"";if(S===z&&c(F[F.length-1],D))F.push(D),o.add(D);else break}s.push({elements:F,content:S})});function l(h){return h?/^[\u200B\u200C\u200D\u200E\u200F\uFEFF]*$/.test(h):!0}function c(h,y){if(!h.parentElement||!y.parentElement||h.parentElement!==y.parentElement)return!1;let S=Array.from(h.parentElement.childNodes),F=S.indexOf(h),q=S.indexOf(y);if(q<=F)return!1;for(let D=F+1;D<q;D++){let z=S[D];if(z.nodeType===Node.TEXT_NODE){let w=z.textContent||"";if(!l(w))return!1}if(z.nodeType===Node.ELEMENT_NODE)return!1}return!0}let m=a.filter(h=>h.hasAttribute("memo")&&!h.classList.contains("protyle-wysiwyg")),k=a.filter(h=>h.hasAttribute("memo")&&h.classList.contains("protyle-wysiwyg")),b=[...s,...m,...k];b.sort((h,y)=>{let S,F;"elements"in h?S=h.elements[0]:S=h,"elements"in y?F=y.elements[0]:F=y;let q=S.compareDocumentPosition(F);return q&Node.DOCUMENT_POSITION_FOLLOWING?-1:q&Node.DOCUMENT_POSITION_PRECEDING?1:0}),b.forEach((h,y)=>{var S,F;try{let q="elements"in h,D=h instanceof HTMLElement&&h.hasAttribute("memo")&&!h.classList.contains("protyle-wysiwyg"),z=h instanceof HTMLElement&&h.hasAttribute("memo")&&h.classList.contains("protyle-wysiwyg");if(q){let{elements:w,content:R}=h,O=w.map(v=>(v.textContent||"").trim()).join(""),A=document.createElement("div");A.className="asri-enhance-sidememo-inlinememo-item",A.style.position="absolute";let G=document.createElement("div");G.className="asri-enhance-sidememo-inlinememo-item-title",G.textContent=O;let $=document.createElement("div");$.className="asri-enhance-sidememo-inlinememo-item-content";try{let v=typeof x=="function"?x(R):x&&(x.parse||x.default)?x.parse?x.parse(R):x.default?x.default(R):R:R;$.innerHTML=v;try{_n($)}catch(H){}}catch(v){$.textContent=R}A.appendChild(G),A.appendChild($);try{w.some(v=>v.getAttribute&&v.getAttribute("asri-enhance-sidememo-fold")==="true")&&A.classList.add("asri-enhance-sidememo-item-fold")}catch(v){}let L=0;try{let v=w[0].getBoundingClientRect(),H=(S=n.parentElement)==null?void 0:S.getBoundingClientRect();if(H)L=Math.max(0,v.top-H.bottom+4);else{let V=e.getBoundingClientRect();L=Math.max(0,v.top-V.top)}}catch(v){}let M=w[0].getAttribute("asri-enhance-sidememo-uid");if(!M){M=`asri-enhance-sidememo-${Math.random().toString(36).slice(2,10)}${Date.now().toString(36)}`;try{w.forEach(v=>v.setAttribute("asri-enhance-sidememo-uid",M))}catch(v){}}A.setAttribute("asri-enhance-sidememo-uid",M),A.style.top=`${L}px`,r.push({el:A,top:L,height:0,uid:M,sourceEls:w,index:y,type:"inline"})}else if(D){let w=h,R=(w.textContent||"").trim(),O=w.getAttribute("memo")||"",A=document.createElement("div");A.className="asri-enhance-sidememo-blockmemo-item",A.style.position="absolute";let G=document.createElement("div");G.className="asri-enhance-sidememo-blockmemo-item-title",G.textContent=R;let $=document.createElement("div");$.className="asri-enhance-sidememo-blockmemo-item-content";try{let v=typeof x=="function"?x(O):x&&(x.parse||x.default)?x.parse?x.parse(O):x.default?x.default(O):O:O;$.innerHTML=v;try{_n($)}catch(H){}}catch(v){$.textContent=O}A.appendChild(G),A.appendChild($);try{w.getAttribute&&w.getAttribute("asri-enhance-sidememo-fold")==="true"&&A.classList.add("asri-enhance-sidememo-item-fold")}catch(v){}let L=0;try{let v=w.getBoundingClientRect(),H=(F=n.parentElement)==null?void 0:F.getBoundingClientRect();if(H)L=Math.max(0,v.top-H.bottom+4);else{let V=e.getBoundingClientRect();L=Math.max(0,v.top-V.top)}}catch(v){}let M=w.getAttribute("asri-enhance-sidememo-uid");if(!M){M=`asri-enhance-sidememo-${Math.random().toString(36).slice(2,10)}${Date.now().toString(36)}`;try{w.setAttribute("asri-enhance-sidememo-uid",M)}catch(v){}}A.setAttribute("asri-enhance-sidememo-uid",M),A.style.top=`${L}px`,r.push({el:A,top:L,height:0,uid:M,sourceEl:w,index:y,type:"block"})}else if(z){let w=h,R="";try{let v=w.previousElementSibling;if(v&&v.classList.contains("protyle-top")){let H=v.querySelector(".protyle-title .protyle-title__input");H&&(R=(H.textContent||"").trim())}}catch(v){}R||(R=(w.textContent||"").trim());let O=w.getAttribute("memo")||"",A=document.createElement("div");A.className="asri-enhance-sidememo-filememo-item",A.style.position="absolute";let G=document.createElement("div");G.className="asri-enhance-sidememo-filememo-item-title",G.textContent=R;let $=document.createElement("div");$.className="asri-enhance-sidememo-filememo-item-content";try{let v=typeof x=="function"?x(O):x&&(x.parse||x.default)?x.parse?x.parse(O):x.default?x.default(O):O:O;$.innerHTML=v;try{_n($)}catch(H){}}catch(v){$.textContent=O}A.appendChild(G),A.appendChild($);try{w.getAttribute&&w.getAttribute("asri-enhance-sidememo-fold")==="true"&&A.classList.add("asri-enhance-sidememo-item-fold")}catch(v){}let L=20,M=w.getAttribute("asri-enhance-sidememo-uid");if(!M){M=`asri-enhance-sidememo-${Math.random().toString(36).slice(2,10)}${Date.now().toString(36)}`;try{w.setAttribute("asri-enhance-sidememo-uid",M)}catch(v){}}A.setAttribute("asri-enhance-sidememo-uid",M),A.style.top=`${L}px`,r.push({el:A,top:L,height:0,uid:M,sourceEl:w,index:y,type:"file"})}}catch(q){}});let T=document.createDocumentFragment();r.forEach(h=>T.appendChild(h.el)),n.appendChild(T),r.forEach(h=>{try{h.height=Math.ceil(h.el.getBoundingClientRect().height)}catch(y){h.height=0}});let p=8,_=0;r.forEach(h=>{let y=Math.max(0,h.top),S=Math.max(y,_);h.el.style.top=`${S}px`,_=S+h.height+p});let C=(h,y)=>{try{if(!h)return;let S=h.hasAttribute&&h.getAttribute("data-type")==="inline-memo",F=h.hasAttribute("memo")&&h.classList.contains("protyle-wysiwyg");if(!S&&!F)return;if(y)try{if(h.getAttribute&&h.getAttribute("asri-enhance-sidememo-fold")==="true")return}catch(R){}let q=h.closest(".protyle-wysiwyg");if(!q)return;let D=q.previousElementSibling;if(!D||!D.classList||!D.classList.contains("protyle-top")||D.classList.contains("asri-enhance-sidememo-protyle-title-none")||!q.closest(".asri-enhance-sidememo"))return;let w=document.querySelector(".tooltip--memo#tooltip");if(!w)return;try{y?w.classList.add("asri-enhance-sidememo-tooltip-memo-none"):w.classList.remove("asri-enhance-sidememo-tooltip-memo-none")}catch(R){}}catch(S){}};r.forEach(h=>{try{let y=h.sourceEls||(h.sourceEl?[h.sourceEl]:[]);if(y.length===0)return;let S=()=>{y.forEach(w=>w.classList.add("asri-enhance-sidememo-highlight"))},F=()=>{y.forEach(w=>w.classList.remove("asri-enhance-sidememo-highlight"))},q=()=>{h.el.classList.add("asri-enhance-sidememo-highlight");try{y.forEach(w=>C(w,!0))}catch(w){}},D=()=>{h.el.classList.remove("asri-enhance-sidememo-highlight");try{y.forEach(w=>C(w,!1))}catch(w){}};h.el.addEventListener("mouseenter",S),h.el.addEventListener("mouseleave",F),y.forEach(w=>{w.addEventListener("mouseenter",q),w.addEventListener("mouseleave",D)});let z=w=>{if(w.button!==0)return;let R=w.clientX,O=w.clientY,A=M=>{R=M.clientX,O=M.clientY,(Math.abs(M.clientX-w.clientX)>6||Math.abs(M.clientY-w.clientY)>6)&&(h.el.__asriSidememoHandlers&&h.el.__asriSidememoHandlers._timer&&(clearTimeout(h.el.__asriSidememoHandlers._timer),h.el.__asriSidememoHandlers._timer=null),document.removeEventListener("mousemove",A),document.removeEventListener("mouseup",G))},G=()=>{h.el.__asriSidememoHandlers&&h.el.__asriSidememoHandlers._timer&&(clearTimeout(h.el.__asriSidememoHandlers._timer),h.el.__asriSidememoHandlers._timer=null),document.removeEventListener("mousemove",A),document.removeEventListener("mouseup",G)};document.addEventListener("mousemove",A),document.addEventListener("mouseup",G);let $=window.setTimeout(()=>{var ue;document.removeEventListener("mousemove",A),document.removeEventListener("mouseup",G);let M=R,v=(ue=y[0])==null?void 0:ue.closest(".asri-enhance-sidememo");if(!v)return;let H=n;try{H.classList.add("asri-enhance-sidememo-container-resize")}catch(W){}let V=getComputedStyle(v).getPropertyValue("--asri-enhance-sidememo-container-width")||"",Z=Math.max(50,Math.min(600,Math.round(parseFloat(V)||200))),Y=null,U=null,J=null,te=null;Y=W=>{try{let Q=Math.round(Z+(M-W.clientX));te=Math.max(50,Math.min(600,Q)),J===null&&(J=requestAnimationFrame(()=>{try{te!==null&&v.style.setProperty("--asri-enhance-sidememo-container-width",`${te}px`)}catch(de){}J=null,te=null}))}catch(Q){}},U=()=>{try{Y&&document.removeEventListener("mousemove",Y),U&&document.removeEventListener("mouseup",U)}catch(Q){}try{J!==null&&(cancelAnimationFrame(J),J=null,te=null)}catch(Q){}let W=h.el.__asriSidememoHandlers;if(W){try{W._asriContainer&&W._asriContainer.classList.remove("asri-enhance-sidememo-container-resize"),W._asriParent&&W._asriParent.classList.remove("asri-enhance-sidememo-container-resize")}catch(Q){}W._dragMove=null,W._dragUp=null,W._asriParent=null,W._asriContainer=null}try{setTimeout(()=>{try{me(),ct()}catch(Q){}},200)}catch(Q){}};let ne=h.el.__asriSidememoHandlers||{};ne._dragMove=Y,ne._dragUp=U,ne._asriParent=v,ne._asriContainer=H,h.el.__asriSidememoHandlers=ne,document.addEventListener("mousemove",Y),document.addEventListener("mouseup",U)},300),L=h.el.__asriSidememoHandlers||{};L._preMove=A,L._preUp=G,L._timer=$,h.el.__asriSidememoHandlers=L};try{let w=h.el.querySelector(".asri-enhance-sidememo-inlinememo-item-title, .asri-enhance-sidememo-blockmemo-item-title, .asri-enhance-sidememo-filememo-item-title");if(w){let R=$=>{try{$.preventDefault(),$.stopPropagation()}catch(L){}try{if(h.type==="file"){let v=y[0];try{let H=v.previousElementSibling;if(H&&H.classList.contains("protyle-top")){let V=H.querySelector(".protyle-title .protyle-attr--memo");if(V){let Z=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window,button:0});V.dispatchEvent(Z);return}}}catch(H){}}let L=y[0],M=y.length>1;if(L!=null&&L.hasAttribute&&L.hasAttribute("memo")){let v=null;try{let U=L.querySelector(":scope > .protyle-attr");U&&(v=U.querySelector(".protyle-attr--memo"))}catch(U){v=null}let H=(v!=null?v:L).getBoundingClientRect(),V=Math.round(H.left+H.width/2),Z=Math.round(H.top+H.height/2),Y=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window,button:0,clientX:V,clientY:Z});try{v?v.dispatchEvent(Y):L.dispatchEvent(Y)}catch(U){}}else if(M)Cs().catch(()=>{});else{let v=L.getBoundingClientRect(),H=Math.round(v.left+v.width/2),V=Math.round(v.top+v.height/2),Z=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0,view:window,button:2,clientX:H,clientY:V});try{L.dispatchEvent(Z)}catch(Y){}}}catch(L){}};w.addEventListener("click",R);let O=$=>{try{$.preventDefault(),$.stopPropagation()}catch(L){}try{let L=h.el.classList.toggle("asri-enhance-sidememo-item-fold");try{let M=h.el.getAttribute("asri-enhance-sidememo-uid");if(M){let v=`[data-type*="inline-memo"][asri-enhance-sidememo-uid="${M}"], [memo][asri-enhance-sidememo-uid="${M}"]`;Array.from(document.querySelectorAll(v)).forEach(V=>{if(V&&V.setAttribute)if(L)V.setAttribute("asri-enhance-sidememo-fold","true");else try{V.removeAttribute("asri-enhance-sidememo-fold")}catch(Z){}})}}catch(M){}}catch(L){}try{me(),ct()}catch(L){}};w.addEventListener("contextmenu",O);let A=h.el.__asriSidememoHandlers||{},G=Object.assign(A,{enter:S,leave:F,click:R,titleRightClick:O,mousedown:z});h.el.__asriSidememoHandlers=G,h.el.addEventListener("mousedown",z)}else{let R=h.el.__asriSidememoHandlers||{},O=Object.assign(R,{enter:S,leave:F,mousedown:z});h.el.__asriSidememoHandlers=O,h.el.addEventListener("mousedown",z)}}catch(w){let R=h.el.__asriSidememoHandlers||{},O=Object.assign(R,{enter:S,leave:F,mousedown:z});h.el.__asriSidememoHandlers=O,h.el.addEventListener("mousedown",z)}try{y.forEach(w=>{w.__asriSidememoHandlers={enter:q,leave:D}})}catch(w){}}catch(y){}})}var He=null;function Kt(){try{if(Se){try{document.removeEventListener("contextmenu",Se,!0)}catch(a){}Se=null}Array.from(document.querySelectorAll(".asri-enhance-sidememo-container")).forEach(a=>{try{Array.from(a.children).forEach(r=>{try{let i=r.__asriSidememoHandlers;if(i){if(i.enter&&r.removeEventListener("mouseenter",i.enter),i.leave&&r.removeEventListener("mouseleave",i.leave),i.click&&r.removeEventListener("click",i.click),i.mousedown&&r.removeEventListener("mousedown",i.mousedown),i._preMove&&document.removeEventListener("mousemove",i._preMove),i._preUp&&document.removeEventListener("mouseup",i._preUp),i._dragMove&&document.removeEventListener("mousemove",i._dragMove),i._dragUp&&document.removeEventListener("mouseup",i._dragUp),i.titleRightClick)try{let o=r.querySelector(".asri-enhance-sidememo-inlinememo-item-title, .asri-enhance-sidememo-blockmemo-item-title, .asri-enhance-sidememo-filememo-item-title");o&&o.removeEventListener("contextmenu",i.titleRightClick)}catch(o){}if(i._timer&&clearTimeout(i._timer),i._asriContainer)try{i._asriContainer.classList.remove("asri-enhance-sidememo-container-resize")}catch(o){}if(i._asriParent)try{i._asriParent.classList.remove("asri-enhance-sidememo-container-resize")}catch(o){}delete r.__asriSidememoHandlers}}catch(i){}});try{a.remove()}catch(r){}}catch(r){}}),Array.from(document.querySelectorAll(".protyle-content")).forEach(a=>{try{a.classList.remove("asri-enhance-sidememo"),a.classList.remove("asri-enhance-sidememo-none"),Array.from(a.querySelectorAll('[data-type*="inline-memo"], [memo]')).forEach(i=>{try{let o=i.__asriSidememoHandlers;o&&(o.enter&&i.removeEventListener("mouseenter",o.enter),o.leave&&i.removeEventListener("mouseleave",o.leave),delete i.__asriSidememoHandlers);try{i.removeAttribute("asri-enhance-sidememo-uid")}catch(s){}try{i.classList.remove("asri-enhance-sidememo-highlight")}catch(s){}}catch(o){}})}catch(r){}}),Array.from(document.querySelectorAll(".asri-enhance-sidememo-container-resize")).forEach(a=>{try{a.classList.remove("asri-enhance-sidememo-container-resize")}catch(r){}})}catch(n){}}async function si(){if(!He)try{let n=Pt(/setUILayout|transactions|setBlockAttrs|getDoc|renameDoc/,e=>{try{setTimeout(()=>{try{me(),ct()}catch(t){}},200)}catch(t){}});He=()=>{try{n.disconnect()}catch(e){}He=null}}catch(n){}}function jt(){if(He){try{He()}catch(n){}He=null}}async function li(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t)return;let a=t.hasAttribute("data-asri-enhance-side-memo"),r=await d(n,Ln)||{};a?(t.removeAttribute("data-asri-enhance-side-memo"),r[Pn]=!1,Kt(),me(),jt()):(t.setAttribute("data-asri-enhance-side-memo","true"),r[Pn]=!0,await oi().catch(()=>{}),me(),si().catch(()=>{})),await E(n,Ln,r).catch(()=>{})}async function ci(n,e){Gt=n;let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await d(n,Ln);a&&a[Pn]===!0?(t.setAttribute("data-asri-enhance-side-memo","true"),await oi().catch(()=>{}),me(),si().catch(()=>{})):(t.removeAttribute("data-asri-enhance-side-memo"),Kt(),me(),jt())}var Mn="config.json",Sn="asri-enhance-global-frosted-glass";async function ui(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t)return;let a=t.hasAttribute("data-asri-enhance-global-frosted-glass"),r=await d(n,Mn)||{};a?(t.removeAttribute("data-asri-enhance-global-frosted-glass"),r[Sn]=!1):(t.setAttribute("data-asri-enhance-global-frosted-glass","true"),r[Sn]=!0),await E(n,Mn,r).catch(()=>{})}async function mi(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await d(n,Mn);a&&a[Sn]===!0?t.setAttribute("data-asri-enhance-global-frosted-glass","true"):t.removeAttribute("data-asri-enhance-global-frosted-glass")}var Hn="config.json",In="asri-enhance-sidebar-top-sticky";async function hi(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t)return;let a=t.hasAttribute("data-asri-enhance-sidebar-top-sticky"),r=await d(n,Hn)||{};a?(t.removeAttribute("data-asri-enhance-sidebar-top-sticky"),r[In]=!1):(t.setAttribute("data-asri-enhance-sidebar-top-sticky","true"),r[In]=!0),await E(n,Hn,r).catch(()=>{})}async function di(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await d(n,Hn);a&&a[In]===!0?t.setAttribute("data-asri-enhance-sidebar-top-sticky","true"):t.removeAttribute("data-asri-enhance-sidebar-top-sticky")}var Rn="config.json",$n="asri-enhance-cover-image-fade";async function pi(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t)return;let a=t.hasAttribute("data-asri-enhance-cover-image-fade"),r=await d(n,Rn)||{};a?(t.removeAttribute("data-asri-enhance-cover-image-fade"),r[$n]=!1):(t.setAttribute("data-asri-enhance-cover-image-fade","true"),r[$n]=!0),await E(n,Rn,r).catch(()=>{})}async function fi(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await d(n,Rn);a&&a[$n]===!0?t.setAttribute("data-asri-enhance-cover-image-fade","true"):t.removeAttribute("data-asri-enhance-cover-image-fade")}var Nn="config.json",Fn="asri-enhance-hide-tab-breadcrumb";async function gi(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t)return;let a=t.hasAttribute("data-asri-enhance-hide-tab-breadcrumb"),r=await d(n,Nn)||{};a?(t.removeAttribute("data-asri-enhance-hide-tab-breadcrumb"),r[Fn]=!1):(t.setAttribute("data-asri-enhance-hide-tab-breadcrumb","true"),r[Fn]=!0),await E(n,Nn,r).catch(()=>{})}async function bi(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await d(n,Nn);a&&a[Fn]===!0?t.setAttribute("data-asri-enhance-hide-tab-breadcrumb","true"):t.removeAttribute("data-asri-enhance-hide-tab-breadcrumb")}var On="config.json",Dn="asri-enhance-moreanimations";async function yi(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t)return;let a=t.hasAttribute("data-asri-enhance-moreanimations"),r=await d(n,On)||{};a?(t.removeAttribute("data-asri-enhance-moreanimations"),r[Dn]=!1):(t.setAttribute("data-asri-enhance-moreanimations","true"),r[Dn]=!0),await E(n,On,r).catch(()=>{})}async function vi(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await d(n,On);a&&a[Dn]===!0?t.setAttribute("data-asri-enhance-moreanimations","true"):t.removeAttribute("data-asri-enhance-moreanimations")}var Bn="config.json",qn="asri-enhance-singlecolumnslashmenu",ut="data-asri-enhance-singlecolumnslashmenu";async function ki(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t)return;let a=t.hasAttribute(ut),r=await d(n,Bn)||{};a?(t.removeAttribute(ut),r[qn]=!1):(t.setAttribute(ut,"true"),r[qn]=!0),await E(n,Bn,r).catch(()=>{})}async function Ei(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await d(n,Bn);a&&a[qn]===!0?t.setAttribute(ut,"true"):t.removeAttribute(ut)}var zn="config.json",wi="asri-enhance-windowtransparencyvalue",Gn="data-asri-enhance-windowtransparencyvalue";async function xi(n,e){e&&(e.preventDefault(),e.stopPropagation())}async function Ti(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await d(n,zn),r=a==null?void 0:a[wi];r!=null?t.setAttribute(Gn,String(r)):t.setAttribute(Gn,"0.5")}async function Ci(n,e){let t=await d(n,zn)||{};t[wi]=e,await E(n,zn,t);let a=document.documentElement;a&&a.setAttribute(Gn,String(e))}var Kn="config.json",jn="asri-enhance-wholewindowtransparency",mt="data-asri-enhance-wholewindowtransparency";async function _i(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t)return;let a=t.hasAttribute(mt),r=await d(n,Kn)||{};a?(t.removeAttribute(mt),r[jn]=!1):(t.setAttribute(mt,"true"),r[jn]=!0),await E(n,Kn,r).catch(()=>{})}async function Ai(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await d(n,Kn);a&&a[jn]===!0?t.setAttribute(mt,"true"):t.removeAttribute(mt)}var Vn="config.json",Wn="asri-enhance-smoothcaret",Un="asri-enhance-smooth-caret-item",ht=null,dt=null,ke=[],Vt=0,Wt=null,Li=()=>{var o;(o=document.getElementById(Un))==null||o.remove();let n=document.createElement("div");n.id=Un,document.body.appendChild(n);let e=!1,t=s=>{if(s===Wt)return Vt;let l=s;for(;l&&l!==document.documentElement;){let c=window.getComputedStyle(l),m=c.zIndex;if((c.position!=="static"&&m!=="auto"||c.position==="fixed"||c.position==="sticky"||parseFloat(c.opacity)<1||c.transform!=="none"||c.perspective!=="none"||c.willChange!=="auto")&&m!=="auto"){let b=parseInt(m)||0;return Vt=b,Wt=s,b}l=l.parentElement}return Vt=0,Wt=s,0},a=()=>{var m,k;e=!1;let s=window.getSelection(),l=(k=(m=s.focusNode)==null?void 0:m.parentElement)==null?void 0:k.closest("[contenteditable]"),c=l==null?void 0:l.closest('.protyle-wysiwyg[data-readonly="false"]');if(s.rangeCount&&l&&c){let b=s.getRangeAt(0),T=b.getClientRects()[0];if(!T||T.height===0)try{let p=b.cloneRange(),_=document.createTextNode("\u200B");p.insertNode(_),p.selectNode(_),T=p.getBoundingClientRect(),_.parentNode.removeChild(_)}catch(p){}if(T){n.classList.remove("asri-enhance-smooth-caret-item-none"),n.style.transform=`translate3d(${T.left-1}px, ${T.top+T.height/2-T.height*.6}px, 0)`,n.style.height=`${T.height*1.2}px`;let p=t(l);n.style.zIndex=(p+1).toString();return}}n.classList.add("asri-enhance-smooth-caret-item-none")},r=()=>{e||(window.requestAnimationFrame(a),e=!0)},i=()=>{ke.forEach(l=>clearTimeout(l)),ke=[],[200,400,600].forEach(l=>{let c=window.setTimeout(()=>{r();let m=ke.indexOf(c);m>-1&&ke.splice(m,1)},l);ke.push(c)})};dt=i,ht=r,document.addEventListener("selectionchange",r),document.addEventListener("scroll",r,{capture:!0,passive:!0}),document.addEventListener("keyup",i),document.addEventListener("mouseup",i),a()},Pi=()=>{var n;(n=document.getElementById(Un))==null||n.remove(),ke.forEach(e=>clearTimeout(e)),ke=[],Vt=0,Wt=null,ht&&(document.removeEventListener("selectionchange",ht),document.removeEventListener("scroll",ht,{capture:!0}),ht=null),dt&&(document.removeEventListener("keyup",dt),document.removeEventListener("mouseup",dt),dt=null)};async function Mi(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t)return;let a=t.hasAttribute("data-asri-enhance-smoothcaret"),r=await d(n,Vn)||{};a?(t.removeAttribute("data-asri-enhance-smoothcaret"),r[Wn]=!1,Pi()):(t.setAttribute("data-asri-enhance-smoothcaret","true"),r[Wn]=!0,Li()),await E(n,Vn,r).catch(()=>{})}async function Si(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await d(n,Vn);a&&a[Wn]===!0?(t.setAttribute("data-asri-enhance-smoothcaret","true"),Li()):(t.removeAttribute("data-asri-enhance-smoothcaret"),Pi())}var Yn="config.json",Xn="asri-enhance-island-layout";async function Hi(n,e){e&&(e.preventDefault(),e.stopPropagation());let t=document.documentElement;if(!t)return;let a=t.hasAttribute("data-asri-enhance-island-layout"),r=await d(n,Yn)||{};a?(t.removeAttribute("data-asri-enhance-island-layout"),r[Xn]=!1,As()):(t.setAttribute("data-asri-enhance-island-layout","true"),r[Xn]=!0,Ii()),await E(n,Yn,r).catch(()=>{})}function Ii(){var e;let n=window;if(typeof window!="undefined"&&n.process&&n.require)try{let{BrowserWindow:t}=n.require("@electron/remote");n.process.platform==="darwin"&&((e=t.getFocusedWindow())==null||e.setWindowButtonPosition({x:16,y:22}))}catch(t){}}function As(){var e;let n=window;if(typeof window!="undefined"&&n.process&&n.require)try{let{BrowserWindow:t}=n.require("@electron/remote");n.process.platform==="darwin"&&((e=t.getFocusedWindow())==null||e.setWindowButtonPosition({x:16,y:16}))}catch(t){}}async function Ri(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await d(n,Yn);a&&a[Xn]===!0?(t.setAttribute("data-asri-enhance-island-layout","true"),Ii()):t.removeAttribute("data-asri-enhance-island-layout")}var Zn="config.json",Qn="asri-enhance-paper",pt="data-asri-enhance-paper",$i=["asri-enhance-noise","asri-enhance-acrylic","asri-enhance-checkerboard","asri-enhance-grid","asri-enhance-polkadot","asri-enhance-crossdot","asri-enhance-honeycomb","asri-enhance-wood","asri-enhance-camouflage","asri-enhance-fiber","asri-enhance-fabric"],Ls=["data-asri-enhance-noise","data-asri-enhance-acrylic","data-asri-enhance-checkerboard","data-asri-enhance-grid","data-asri-enhance-polkadot","data-asri-enhance-crossdot","data-asri-enhance-honeycomb","data-asri-enhance-wood","data-asri-enhance-camouflage","data-asri-enhance-fiber","data-asri-enhance-fabric"];function Ni(n,e){e.preventDefault(),e.stopPropagation(),d(n,Zn).then(t=>{let r=!((t==null?void 0:t[Qn])||!1),i={...t,[Qn]:r};r&&$i.forEach(o=>{i[o]=!1}),E(n,Zn,i).then(()=>{Ls.forEach(o=>{document.documentElement.removeAttribute(o)}),r?document.documentElement.setAttribute(pt,"true"):document.documentElement.removeAttribute(pt)}).catch(()=>{})}).catch(()=>{})}async function Fi(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await d(n,Zn),r=a==null?void 0:a[Qn],i=$i.some(o=>(a==null?void 0:a[o])===!0||(a==null?void 0:a[o])==="true");r===!0||r==="true"?i?t.removeAttribute(pt):t.setAttribute(pt,"true"):t.removeAttribute(pt)}var Jn="config.json",ea="asri-enhance-noise",ft="data-asri-enhance-noise",Oi=["asri-enhance-paper","asri-enhance-acrylic","asri-enhance-checkerboard","asri-enhance-grid","asri-enhance-polkadot","asri-enhance-crossdot","asri-enhance-honeycomb","asri-enhance-wood","asri-enhance-camouflage","asri-enhance-fiber","asri-enhance-fabric"],Ps=["data-asri-enhance-paper","data-asri-enhance-acrylic","data-asri-enhance-checkerboard","data-asri-enhance-grid","data-asri-enhance-polkadot","data-asri-enhance-crossdot","data-asri-enhance-honeycomb","data-asri-enhance-wood","data-asri-enhance-camouflage","data-asri-enhance-fiber","data-asri-enhance-fabric"];function Di(n,e){e.preventDefault(),e.stopPropagation(),d(n,Jn).then(t=>{let r=!((t==null?void 0:t[ea])||!1),i={...t,[ea]:r};r&&Oi.forEach(o=>{i[o]=!1}),E(n,Jn,i).then(()=>{Ps.forEach(o=>{document.documentElement.removeAttribute(o)}),r?document.documentElement.setAttribute(ft,"true"):document.documentElement.removeAttribute(ft)}).catch(()=>{})}).catch(()=>{})}async function Bi(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await d(n,Jn),r=a==null?void 0:a[ea],i=Oi.some(o=>(a==null?void 0:a[o])===!0||(a==null?void 0:a[o])==="true");r===!0||r==="true"?i?t.removeAttribute(ft):t.setAttribute(ft,"true"):t.removeAttribute(ft)}var ta="config.json",na="asri-enhance-acrylic",gt="data-asri-enhance-acrylic",qi=["asri-enhance-paper","asri-enhance-noise","asri-enhance-checkerboard","asri-enhance-grid","asri-enhance-polkadot","asri-enhance-crossdot","asri-enhance-honeycomb","asri-enhance-wood","asri-enhance-camouflage","asri-enhance-fiber","asri-enhance-fabric"],Ms=["data-asri-enhance-paper","data-asri-enhance-noise","data-asri-enhance-checkerboard","data-asri-enhance-grid","data-asri-enhance-polkadot","data-asri-enhance-crossdot","data-asri-enhance-honeycomb","data-asri-enhance-wood","data-asri-enhance-camouflage","data-asri-enhance-fiber","data-asri-enhance-fabric"];function zi(n,e){e.preventDefault(),e.stopPropagation(),d(n,ta).then(t=>{let r=!((t==null?void 0:t[na])||!1),i={...t,[na]:r};r&&qi.forEach(o=>{i[o]=!1}),E(n,ta,i).then(()=>{Ms.forEach(o=>{document.documentElement.removeAttribute(o)}),r?document.documentElement.setAttribute(gt,"true"):document.documentElement.removeAttribute(gt)}).catch(()=>{})}).catch(()=>{})}async function Gi(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await d(n,ta),r=a==null?void 0:a[na],i=qi.some(o=>(a==null?void 0:a[o])===!0||(a==null?void 0:a[o])==="true");r===!0||r==="true"?i?t.removeAttribute(gt):t.setAttribute(gt,"true"):t.removeAttribute(gt)}var aa="config.json",ra="asri-enhance-checkerboard",bt="data-asri-enhance-checkerboard",Ki=["asri-enhance-paper","asri-enhance-noise","asri-enhance-acrylic","asri-enhance-grid","asri-enhance-polkadot","asri-enhance-crossdot","asri-enhance-honeycomb","asri-enhance-wood","asri-enhance-camouflage","asri-enhance-fiber","asri-enhance-fabric"],Ss=["data-asri-enhance-paper","data-asri-enhance-noise","data-asri-enhance-acrylic","data-asri-enhance-grid","data-asri-enhance-polkadot","data-asri-enhance-crossdot","data-asri-enhance-honeycomb","data-asri-enhance-wood","data-asri-enhance-camouflage","data-asri-enhance-fiber","data-asri-enhance-fabric"];function ji(n,e){e.preventDefault(),e.stopPropagation(),d(n,aa).then(t=>{let r=!((t==null?void 0:t[ra])||!1),i={...t,[ra]:r};r&&Ki.forEach(o=>{i[o]=!1}),E(n,aa,i).then(()=>{Ss.forEach(o=>{document.documentElement.removeAttribute(o)}),r?document.documentElement.setAttribute(bt,"true"):document.documentElement.removeAttribute(bt)}).catch(()=>{})}).catch(()=>{})}async function Vi(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await d(n,aa),r=a==null?void 0:a[ra],i=Ki.some(o=>(a==null?void 0:a[o])===!0||(a==null?void 0:a[o])==="true");r===!0||r==="true"?i?t.removeAttribute(bt):t.setAttribute(bt,"true"):t.removeAttribute(bt)}var ia="config.json",oa="asri-enhance-grid",yt="data-asri-enhance-grid",Wi=["asri-enhance-paper","asri-enhance-noise","asri-enhance-acrylic","asri-enhance-checkerboard","asri-enhance-polkadot","asri-enhance-crossdot","asri-enhance-honeycomb","asri-enhance-wood","asri-enhance-camouflage","asri-enhance-fiber","asri-enhance-fabric"],Hs=["data-asri-enhance-paper","data-asri-enhance-noise","data-asri-enhance-acrylic","data-asri-enhance-checkerboard","data-asri-enhance-polkadot","data-asri-enhance-crossdot","data-asri-enhance-honeycomb","data-asri-enhance-wood","data-asri-enhance-camouflage","data-asri-enhance-fiber","data-asri-enhance-fabric"];function Ui(n,e){e.preventDefault(),e.stopPropagation(),d(n,ia).then(t=>{let r=!((t==null?void 0:t[oa])||!1),i={...t,[oa]:r};r&&Wi.forEach(o=>{i[o]=!1}),E(n,ia,i).then(()=>{Hs.forEach(o=>{document.documentElement.removeAttribute(o)}),r?document.documentElement.setAttribute(yt,"true"):document.documentElement.removeAttribute(yt)}).catch(()=>{})}).catch(()=>{})}async function Yi(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await d(n,ia),r=a==null?void 0:a[oa],i=Wi.some(o=>(a==null?void 0:a[o])===!0||(a==null?void 0:a[o])==="true");r===!0||r==="true"?i?t.removeAttribute(yt):t.setAttribute(yt,"true"):t.removeAttribute(yt)}var sa="config.json",la="asri-enhance-polkadot",vt="data-asri-enhance-polkadot",Xi=["asri-enhance-paper","asri-enhance-noise","asri-enhance-acrylic","asri-enhance-checkerboard","asri-enhance-grid","asri-enhance-crossdot","asri-enhance-honeycomb","asri-enhance-wood","asri-enhance-camouflage","asri-enhance-fiber","asri-enhance-fabric"],Is=["data-asri-enhance-paper","data-asri-enhance-noise","data-asri-enhance-acrylic","data-asri-enhance-checkerboard","data-asri-enhance-grid","data-asri-enhance-crossdot","data-asri-enhance-honeycomb","data-asri-enhance-wood","data-asri-enhance-camouflage","data-asri-enhance-fiber","data-asri-enhance-fabric"];function Zi(n,e){e.preventDefault(),e.stopPropagation(),d(n,sa).then(t=>{let r=!((t==null?void 0:t[la])||!1),i={...t,[la]:r};r&&Xi.forEach(o=>{i[o]=!1}),E(n,sa,i).then(()=>{Is.forEach(o=>{document.documentElement.removeAttribute(o)}),r?document.documentElement.setAttribute(vt,"true"):document.documentElement.removeAttribute(vt)}).catch(()=>{})}).catch(()=>{})}async function Qi(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await d(n,sa),r=a==null?void 0:a[la],i=Xi.some(o=>(a==null?void 0:a[o])===!0||(a==null?void 0:a[o])==="true");r===!0||r==="true"?i?t.removeAttribute(vt):t.setAttribute(vt,"true"):t.removeAttribute(vt)}var ca="config.json",ua="asri-enhance-crossdot",kt="data-asri-enhance-crossdot",Ji=["asri-enhance-paper","asri-enhance-noise","asri-enhance-acrylic","asri-enhance-checkerboard","asri-enhance-grid","asri-enhance-polkadot","asri-enhance-honeycomb","asri-enhance-wood","asri-enhance-camouflage","asri-enhance-fiber","asri-enhance-fabric"],Rs=["data-asri-enhance-paper","data-asri-enhance-noise","data-asri-enhance-acrylic","data-asri-enhance-checkerboard","data-asri-enhance-grid","data-asri-enhance-polkadot","data-asri-enhance-honeycomb","data-asri-enhance-wood","data-asri-enhance-camouflage","data-asri-enhance-fiber","data-asri-enhance-fabric"];function eo(n,e){e.preventDefault(),e.stopPropagation(),d(n,ca).then(t=>{let r=!((t==null?void 0:t[ua])||!1),i={...t,[ua]:r};r&&Ji.forEach(o=>{i[o]=!1}),E(n,ca,i).then(()=>{Rs.forEach(o=>{document.documentElement.removeAttribute(o)}),r?document.documentElement.setAttribute(kt,"true"):document.documentElement.removeAttribute(kt)}).catch(()=>{})}).catch(()=>{})}async function to(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await d(n,ca),r=a==null?void 0:a[ua],i=Ji.some(o=>(a==null?void 0:a[o])===!0||(a==null?void 0:a[o])==="true");r===!0||r==="true"?i?t.removeAttribute(kt):t.setAttribute(kt,"true"):t.removeAttribute(kt)}var ma="config.json",ha="asri-enhance-honeycomb",Et="data-asri-enhance-honeycomb",no=["asri-enhance-paper","asri-enhance-noise","asri-enhance-acrylic","asri-enhance-checkerboard","asri-enhance-grid","asri-enhance-polkadot","asri-enhance-crossdot","asri-enhance-wood","asri-enhance-camouflage","asri-enhance-fiber","asri-enhance-fabric"],$s=["data-asri-enhance-paper","data-asri-enhance-noise","data-asri-enhance-acrylic","data-asri-enhance-checkerboard","data-asri-enhance-grid","data-asri-enhance-polkadot","data-asri-enhance-crossdot","data-asri-enhance-wood","data-asri-enhance-camouflage","data-asri-enhance-fiber","data-asri-enhance-fabric"];function ao(n,e){e.preventDefault(),e.stopPropagation(),d(n,ma).then(t=>{let r=!((t==null?void 0:t[ha])||!1),i={...t,[ha]:r};r&&no.forEach(o=>{i[o]=!1}),E(n,ma,i).then(()=>{$s.forEach(o=>{document.documentElement.removeAttribute(o)}),r?document.documentElement.setAttribute(Et,"true"):document.documentElement.removeAttribute(Et)}).catch(()=>{})}).catch(()=>{})}async function ro(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await d(n,ma),r=a==null?void 0:a[ha],i=no.some(o=>(a==null?void 0:a[o])===!0||(a==null?void 0:a[o])==="true");r===!0||r==="true"?i?t.removeAttribute(Et):t.setAttribute(Et,"true"):t.removeAttribute(Et)}var da="config.json",pa="asri-enhance-wood",wt="data-asri-enhance-wood",io=["asri-enhance-paper","asri-enhance-noise","asri-enhance-acrylic","asri-enhance-checkerboard","asri-enhance-grid","asri-enhance-polkadot","asri-enhance-crossdot","asri-enhance-honeycomb","asri-enhance-camouflage","asri-enhance-fiber","asri-enhance-fabric"],Ns=["data-asri-enhance-paper","data-asri-enhance-noise","data-asri-enhance-acrylic","data-asri-enhance-checkerboard","data-asri-enhance-grid","data-asri-enhance-polkadot","data-asri-enhance-crossdot","data-asri-enhance-honeycomb","data-asri-enhance-camouflage","data-asri-enhance-fiber","data-asri-enhance-fabric"];function oo(n,e){e.preventDefault(),e.stopPropagation(),d(n,da).then(t=>{let r=!((t==null?void 0:t[pa])||!1),i={...t,[pa]:r};r&&io.forEach(o=>{i[o]=!1}),E(n,da,i).then(()=>{Ns.forEach(o=>{document.documentElement.removeAttribute(o)}),r?document.documentElement.setAttribute(wt,"true"):document.documentElement.removeAttribute(wt)}).catch(()=>{})}).catch(()=>{})}async function so(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await d(n,da),r=a==null?void 0:a[pa],i=io.some(o=>(a==null?void 0:a[o])===!0||(a==null?void 0:a[o])==="true");r===!0||r==="true"?i?t.removeAttribute(wt):t.setAttribute(wt,"true"):t.removeAttribute(wt)}var fa="config.json",ga="asri-enhance-camouflage",xt="data-asri-enhance-camouflage",lo=["asri-enhance-paper","asri-enhance-noise","asri-enhance-acrylic","asri-enhance-checkerboard","asri-enhance-grid","asri-enhance-polkadot","asri-enhance-crossdot","asri-enhance-honeycomb","asri-enhance-wood","asri-enhance-fiber","asri-enhance-fabric"],Fs=["data-asri-enhance-paper","data-asri-enhance-noise","data-asri-enhance-acrylic","data-asri-enhance-checkerboard","data-asri-enhance-grid","data-asri-enhance-polkadot","data-asri-enhance-crossdot","data-asri-enhance-honeycomb","data-asri-enhance-wood","data-asri-enhance-fiber","data-asri-enhance-fabric"];function co(n,e){e.preventDefault(),e.stopPropagation(),d(n,fa).then(t=>{let r=!((t==null?void 0:t[ga])||!1),i={...t,[ga]:r};r&&lo.forEach(o=>{i[o]=!1}),E(n,fa,i).then(()=>{Fs.forEach(o=>{document.documentElement.removeAttribute(o)}),r?document.documentElement.setAttribute(xt,"true"):document.documentElement.removeAttribute(xt)}).catch(()=>{})}).catch(()=>{})}async function uo(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await d(n,fa),r=a==null?void 0:a[ga],i=lo.some(o=>(a==null?void 0:a[o])===!0||(a==null?void 0:a[o])==="true");r===!0||r==="true"?i?t.removeAttribute(xt):t.setAttribute(xt,"true"):t.removeAttribute(xt)}var ba="config.json",ya="asri-enhance-fiber",Tt="data-asri-enhance-fiber",mo=["asri-enhance-paper","asri-enhance-noise","asri-enhance-acrylic","asri-enhance-checkerboard","asri-enhance-grid","asri-enhance-polkadot","asri-enhance-crossdot","asri-enhance-honeycomb","asri-enhance-wood","asri-enhance-camouflage","asri-enhance-fabric"],Os=["data-asri-enhance-paper","data-asri-enhance-noise","data-asri-enhance-acrylic","data-asri-enhance-checkerboard","data-asri-enhance-grid","data-asri-enhance-polkadot","data-asri-enhance-crossdot","data-asri-enhance-honeycomb","data-asri-enhance-wood","data-asri-enhance-camouflage","data-asri-enhance-fabric"];function ho(n,e){e.preventDefault(),e.stopPropagation(),d(n,ba).then(t=>{let r=!((t==null?void 0:t[ya])||!1),i={...t,[ya]:r};r&&mo.forEach(o=>{i[o]=!1}),E(n,ba,i).then(()=>{Os.forEach(o=>{document.documentElement.removeAttribute(o)}),r?document.documentElement.setAttribute(Tt,"true"):document.documentElement.removeAttribute(Tt)}).catch(()=>{})}).catch(()=>{})}async function po(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await d(n,ba),r=a==null?void 0:a[ya],i=mo.some(o=>(a==null?void 0:a[o])===!0||(a==null?void 0:a[o])==="true");r===!0||r==="true"?i?t.removeAttribute(Tt):t.setAttribute(Tt,"true"):t.removeAttribute(Tt)}var va="config.json",ka="asri-enhance-fabric",Ct="data-asri-enhance-fabric",fo=["asri-enhance-paper","asri-enhance-noise","asri-enhance-acrylic","asri-enhance-checkerboard","asri-enhance-grid","asri-enhance-polkadot","asri-enhance-crossdot","asri-enhance-honeycomb","asri-enhance-wood","asri-enhance-camouflage","asri-enhance-fiber"],Ds=["data-asri-enhance-paper","data-asri-enhance-noise","data-asri-enhance-acrylic","data-asri-enhance-checkerboard","data-asri-enhance-grid","data-asri-enhance-polkadot","data-asri-enhance-crossdot","data-asri-enhance-honeycomb","data-asri-enhance-wood","data-asri-enhance-camouflage","data-asri-enhance-fiber"];function go(n,e){e.preventDefault(),e.stopPropagation(),d(n,va).then(t=>{let r=!((t==null?void 0:t[ka])||!1),i={...t,[ka]:r};r&&fo.forEach(o=>{i[o]=!1}),E(n,va,i).then(()=>{Ds.forEach(o=>{document.documentElement.removeAttribute(o)}),r?document.documentElement.setAttribute(Ct,"true"):document.documentElement.removeAttribute(Ct)}).catch(()=>{})}).catch(()=>{})}async function bo(n,e){let t=document.documentElement;if(!t)return;let a=e!==void 0?e:await d(n,va),r=a==null?void 0:a[ka],i=fo.some(o=>(a==null?void 0:a[o])===!0||(a==null?void 0:a[o])==="true");r===!0||r==="true"?i?t.removeAttribute(Ct):t.setAttribute(Ct,"true"):t.removeAttribute(Ct)}var ee='<svg class="b3-menu__icon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M19 3h-4a2 2 0 0 0-2 2v12a4 4 0 0 0 8 0V5a2 2 0 0 0-2-2"></path><path d="m13 7.35l-2-2a2 2 0 0 0-2.828 0L5.344 8.178a2 2 0 0 0 0 2.828l9 9"></path><path d="M7.3 13H5a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h12m0-4v.01"></path></g></svg>',N='<svg class="b3-menu__icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em"><path d="M512 443.733333a68.266667 68.266667 0 1 1-0.034133 136.567467A68.266667 68.266667 0 0 1 512 443.733333z m0-238.933333a68.266667 68.266667 0 1 1-0.034133 136.567467A68.266667 68.266667 0 0 1 512 204.8z m0 477.866667a68.266667 68.266667 0 1 1-0.034133 136.567466A68.266667 68.266667 0 0 1 512 682.666667z" fill="currentColor"></path></svg>';function yo(n,e,t=200){let a,r,i=null,o=0,s=new Set,l=10,c=100,m=()=>{s.forEach(p=>window.clearTimeout(p)),s.clear()},k=(p,_)=>{let C=window.setTimeout(()=>{s.delete(C),p()},_);return s.add(C),C},b=p=>{a!==void 0&&window.clearTimeout(a),a=window.setTimeout(()=>{m();let _=(C=0)=>{var y,S,F,q,D,z,w,R,O,A,G,$,L,M;let h=document.querySelector('#commonMenu[data-name="barmode"] #pickColor');if(h){let v=h.parentElement;if(v){if(!v.querySelector("#asri-enhance-palette")){let P=document.createElement("button");P.className="b3-menu__item asri-enhance",P.id="asri-enhance-palette",P.innerHTML=`${N}<span class="b3-menu__label">${((y=n.i18n)==null?void 0:y.morePresetColors)||"morePresetColors"}</span><svg class="b3-menu__icon b3-menu__icon--small"><use xlink:href="#iconRight"></use></svg><div class="b3-menu__submenu"><div class="b3-menu__items"><button class="b3-menu__item" id="asri-enhance-sakura">${ee}<span class="b3-menu__label">${((S=n.i18n)==null?void 0:S.sakura)||"Sakura"}</span></button><button class="b3-menu__item" id="asri-enhance-amber">${ee}<span class="b3-menu__label">${((F=n.i18n)==null?void 0:F.amber)||"amber"}</span></button><button class="b3-menu__item" id="asri-enhance-wilderness">${ee}<span class="b3-menu__label">${((q=n.i18n)==null?void 0:q.wilderness)||"wilderness"}</span></button><button class="b3-menu__item" id="asri-enhance-midnight">${ee}<span class="b3-menu__label">${((D=n.i18n)==null?void 0:D.midnight)||"midnight"}</span></button><button class="b3-menu__item" id="asri-enhance-salt">${ee}<span class="b3-menu__label">${((z=n.i18n)==null?void 0:z.salt)||"salt"}</span></button><button class="b3-menu__item" id="asri-enhance-rosepine">${ee}<span class="b3-menu__label">${((w=n.i18n)==null?void 0:w.rosePine)||"Ros\xE9 Pine"}</span></button><button class="b3-menu__item" id="asri-enhance-topaz">${ee}<span class="b3-menu__label">${((R=n.i18n)==null?void 0:R.goldenTopaz)||"Golden Topaz"}</span></button><button class="b3-menu__item" id="asri-enhance-oxygen">${ee}<span class="b3-menu__label">${((O=n.i18n)==null?void 0:O.oxygen)||"Oxygen"}</span></button><button class="b3-menu__item" id="asri-enhance-shade">${ee}<span class="b3-menu__label">${((A=n.i18n)==null?void 0:A.shade)||"Shade"}</span></button><button class="b3-menu__item" id="asri-enhance-gruvbox">${ee}<span class="b3-menu__label">${((G=n.i18n)==null?void 0:G.gruvbox)||"Gruvbox"}</span></button><button class="b3-menu__item" id="asri-enhance-glitch">${ee}<span class="b3-menu__label">${(($=n.i18n)==null?void 0:$.glitch)||"glitch"}</span></button><button class="b3-menu__item" id="asri-enhance-nostalgia">${ee}<span class="b3-menu__label">${((L=n.i18n)==null?void 0:L.nostalgia)||"\u56DE\u5FC6"}</span></button></div></div>`;let pe=h,le=h.previousElementSibling;for(;le;){if(le.classList&&le.classList.contains("b3-menu__separator")){pe=le;break}le=le.previousElementSibling}v.insertBefore(P,pe)}let H=v.querySelector("#asri-enhance-amber");H&&(H.onclick=P=>qa(n,P));let V=v.querySelector("#asri-enhance-sakura");V&&(V.onclick=P=>Ka(n,P));let Z=v.querySelector("#asri-enhance-wilderness");Z&&(Z.onclick=P=>Wa(n,P));let Y=v.querySelector("#asri-enhance-midnight");Y&&(Y.onclick=P=>Xa(n,P));let U=v.querySelector("#asri-enhance-salt");U&&(U.onclick=P=>Ja(n,P));let J=v.querySelector("#asri-enhance-rosepine");J&&(J.onclick=P=>nr(n,P));let te=v.querySelector("#asri-enhance-topaz");te&&(te.onclick=P=>ir(n,P));let ne=v.querySelector("#asri-enhance-oxygen");ne&&(ne.onclick=P=>lr(n,P));let ue=v.querySelector("#asri-enhance-shade");ue&&(ue.onclick=P=>mr(n,P));let W=v.querySelector("#asri-enhance-gruvbox");W&&(W.onclick=P=>pr(n,P));let Q=v.querySelector("#asri-enhance-glitch");Q&&(Q.onclick=P=>br(n,P));let we=v.querySelector("#asri-enhance-nostalgia");we&&(we.onclick=P=>kr(n,P));let de=document.querySelector('#commonMenu[data-name="barmode"] #followCoverImgColor');if(de&&!v.querySelector("#asri-enhance-follow-time")){let P=document.createElement("button");P.className="b3-menu__item asri-enhance",P.id="asri-enhance-follow-time",P.innerHTML=`<svg class="b3-menu__icon"></svg><span class="b3-menu__label">${((M=n.i18n)==null?void 0:M.followTime)||"Follow Time"}</span>`,de.nextSibling?v.insertBefore(P,de.nextSibling):v.appendChild(P),P.onclick=pe=>Oa(n,pe)}}e(p);return}C+1<l?k(()=>_(C+1),c):e(p)};_(),a=void 0},t)},T=()=>{let p=document.querySelector("#barMode");if(p){i=p,p.addEventListener("click",b,!0),r=void 0;return}o+=1,o<l?r=window.setTimeout(T,c):r=void 0};return T(),()=>{r!==void 0&&(window.clearTimeout(r),r=void 0),m(),i&&(i.removeEventListener("click",b,!0),i=null),a!==void 0&&(window.clearTimeout(a),a=void 0)}}function vo(n,e=200){let t,a,r=null,i=0,o=new Set,s=10,l=100,c=()=>{o.forEach(T=>window.clearTimeout(T)),o.clear()},m=(T,p)=>{let _=window.setTimeout(()=>{o.delete(_),T()},p);return o.add(_),_},k=T=>{t!==void 0&&window.clearTimeout(t),t=window.setTimeout(()=>{c();let p=(_=0)=>{var h,y,S,F,q,D,z,w,R,O,A,G,$,L,M,v,H,V,Z,Y,U,J,te,ne,ue,W,Q,we,de,P,pe,le;let C=document.querySelector('#commonMenu[data-name="barmode"] #topbarFusionPlus');if(C){let ae=C.parentElement;if(ae){if(!ae.querySelector("#asri-enhance-more")){let u=document.createElement("button");u.className="b3-menu__item asri-enhance",u.id="asri-enhance-more",u.innerHTML=`${N}<span class="b3-menu__label">${((h=n.i18n)==null?void 0:h.more)||"more"}</span><svg class="b3-menu__icon b3-menu__icon--small"><use xlink:href="#iconRight"></use></svg><div class="b3-menu__submenu"><div class="b3-menu__items"><button class="b3-menu__item" id="asri-enhance-detail-adjustment">${N}<span class="b3-menu__label">${((y=n.i18n)==null?void 0:y.detailAdjustment)||"detailAdjustment"}</span><svg class="b3-menu__icon b3-menu__icon--small"><use xlink:href="#iconRight"></use></svg><div class="b3-menu__submenu"><div class="b3-menu__items"></div></div></button><button class="b3-menu__item" id="asri-enhance-texture">${N}<span class="b3-menu__label">${((S=n.i18n)==null?void 0:S.texture)||"texture"}</span><svg class="b3-menu__icon b3-menu__icon--small"><use xlink:href="#iconRight"></use></svg><div class="b3-menu__submenu"><div class="b3-menu__items"></div></div></button><button class="b3-menu__item" id="asri-enhance-list-bullet-line">${N}<span class="b3-menu__label">${((F=n.i18n)==null?void 0:F.listBulletLine)||"listBulletLine"}</span></button><button class="b3-menu__item" id="asri-enhance-vertical-tab">${N}<span class="b3-menu__label">${((q=n.i18n)==null?void 0:q.verticalTab)||"verticalTab"}</span></button><button class="b3-menu__item" id="asri-enhance-sidememo">${N}<span class="b3-menu__label">${((D=n.i18n)==null?void 0:D.sidememo)||"sidememo"}</span></button><button class="b3-menu__item" id="asri-enhance-smooth-caret">${N}<span class="b3-menu__label">${((z=n.i18n)==null?void 0:z.smoothCaret)||"smoothCaret"}</span></button><button class="b3-menu__item" id="asri-enhance-island-layout">${N}<span class="b3-menu__label">${((w=n.i18n)==null?void 0:w.islandLayout)||"islandLayout"}</span></button></div></div>`,C.nextSibling?ae.insertBefore(u,C.nextSibling):ae.appendChild(u)}let Aa=ae.querySelector("#asri-enhance-list-bullet-line");Aa&&(Aa.onclick=u=>Mr(n,u));let La=ae.querySelector("#asri-enhance-vertical-tab");La&&(La.onclick=u=>Br(n,u));let Pa=ae.querySelector("#asri-enhance-sidememo");Pa&&(Pa.onclick=u=>li(n,u));let Ma=ae.querySelector("#asri-enhance-smooth-caret");Ma&&(Ma.onclick=u=>Mi(n,u));let Sa=ae.querySelector("#asri-enhance-island-layout");Sa&&(Sa.onclick=u=>Hi(n,u));let Ha=ae.querySelector("#asri-enhance-detail-adjustment");if(Ha){let u=Ha.querySelector(".b3-menu__submenu .b3-menu__items");if(u&&!u.querySelector("#asri-enhance-windowtransparencyvalue")){let f=document.createElement("div");f.className="menu-item__subtitle",f.style.userSelect="none",f.style.padding="0 14px",f.textContent=((R=n.i18n)==null?void 0:R.windowTransparencyValueSubtitle)||"windowTransparencyValueSubtitle",u.appendChild(f)}if(u&&!u.querySelector("#asri-enhance-wholewindowtransparency")){let f=document.createElement("button");f.className="b3-menu__item",f.id="asri-enhance-wholewindowtransparency",f.innerHTML=`${N}<span class="b3-menu__label">${((O=n.i18n)==null?void 0:O.wholeWindowTransparency)||"wholeWindowTransparency"}</span>`,u.appendChild(f)}let Ne=u==null?void 0:u.querySelector("#asri-enhance-wholewindowtransparency");if(Ne&&(Ne.onclick=f=>_i(n,f)),u&&!u.querySelector("#asri-enhance-windowtransparencyvalue")){let f=document.createElement("button");f.className="b3-menu__item",f.id="asri-enhance-windowtransparencyvalue",f.innerHTML=`<div aria-label="${((A=n.i18n)==null?void 0:A.windowTransparencyValue)||"windowTransparencyValue"}: 0.5" class="b3-tooltips b3-tooltips__n"><input style="box-sizing: border-box" type="range" class="b3-slider fn__block" min="0" max="1" step="0.05" value="0.5"></div>`,u.appendChild(f)}let xe=u==null?void 0:u.querySelector("#asri-enhance-windowtransparencyvalue");if(xe){xe.onclick=g=>xi(n,g);let f=xe.querySelector("input[type='range']");f&&(d(n,"config.json").then(g=>{var Ve,We,Ue;let Te=g==null?void 0:g["asri-enhance-windowtransparencyvalue"];if(Te!==void 0){let Ye=parseFloat(Te);f.value=String(Ye);let Xe=(We=(Ve=f.parentElement)==null?void 0:Ve.getAttribute("aria-label"))==null?void 0:We.split(":")[0];Xe&&((Ue=f.parentElement)==null||Ue.setAttribute("aria-label",`${Xe}: ${Ye}`))}}).catch(()=>{}),f.addEventListener("input",async g=>{var Ue,Ye,Xe;let Te=g.target,Ve=parseFloat(Te.value);await Ci(n,Ve);let We=(Ye=(Ue=Te.parentElement)==null?void 0:Ue.getAttribute("aria-label"))==null?void 0:Ye.split(":")[0];We&&((Xe=Te.parentElement)==null||Xe.setAttribute("aria-label",`${We}: ${Ve}`))}))}if(u){let f=document.createElement("button");f.className="b3-menu__separator",u.appendChild(f)}if(u&&!u.querySelector("#asri-enhance-sidebar-top-sticky")){let f=document.createElement("button");f.className="b3-menu__item",f.id="asri-enhance-sidebar-top-sticky",f.innerHTML=`${N}<span class="b3-menu__label">${((G=n.i18n)==null?void 0:G.sidebarTopSticky)||"sidebarTopSticky"}</span>`,u.appendChild(f)}let Fe=u==null?void 0:u.querySelector("#asri-enhance-sidebar-top-sticky");if(Fe&&(Fe.onclick=f=>hi(n,f)),u&&!u.querySelector("#asri-enhance-singlecolumnslashmenu")){let f=document.createElement("button");f.className="b3-menu__item",f.id="asri-enhance-singlecolumnslashmenu",f.innerHTML=`${N}<span class="b3-menu__label">${(($=n.i18n)==null?void 0:$.singleColumnSlashMenu)||"singleColumnSlashMenu"}</span>`,u.appendChild(f)}let Oe=u==null?void 0:u.querySelector("#asri-enhance-singlecolumnslashmenu");if(Oe&&(Oe.onclick=f=>ki(n,f)),u){let f=document.createElement("button");f.className="b3-menu__separator",u.appendChild(f)}if(u&&!u.querySelector("#asri-enhance-cover-image-fade")){let f=document.createElement("button");f.className="b3-menu__item",f.id="asri-enhance-cover-image-fade",f.innerHTML=`${N}<span class="b3-menu__label">${((L=n.i18n)==null?void 0:L.coverImageFade)||"coverImageFade"}</span>`,u.appendChild(f)}let De=u==null?void 0:u.querySelector("#asri-enhance-cover-image-fade");if(De&&(De.onclick=f=>pi(n,f)),u&&!u.querySelector("#asri-enhance-colored-heading")){let f=document.createElement("button");f.className="b3-menu__item",f.id="asri-enhance-colored-heading",f.innerHTML=`${N}<span class="b3-menu__label">${((M=n.i18n)==null?void 0:M.coloredHeading)||"coloredHeading"}</span>`,u.appendChild(f)}let Be=u==null?void 0:u.querySelector("#asri-enhance-colored-heading");if(Be&&(Be.onclick=f=>wr(n,f)),u&&!u.querySelector("#asri-enhance-heading-level-hint")){let f=document.createElement("button");if(f.className="b3-menu__item",f.id="asri-enhance-heading-level-hint",f.innerHTML=`${N}<span class="b3-menu__label">${((v=n.i18n)==null?void 0:v.headingLevelHint)||"headingLevelHint"}</span>`,u.querySelector("#asri-enhance-colored-tree")){let g=u.querySelector("#asri-enhance-colored-tree");u.insertBefore(f,g)}else u.appendChild(f)}let qe=u==null?void 0:u.querySelector("#asri-enhance-heading-level-hint");if(qe&&(qe.onclick=f=>Tr(n,f)),u&&!u.querySelector("#asri-enhance-colored-tree")){let f=document.createElement("button");f.className="b3-menu__item",f.id="asri-enhance-colored-tree",f.innerHTML=`${N}<span class="b3-menu__label">${((H=n.i18n)==null?void 0:H.coloredTree)||"coloredTree"}</span>`,u.appendChild(f)}let ze=u==null?void 0:u.querySelector("#asri-enhance-colored-tree");if(ze&&(ze.onclick=f=>_r(n,f)),u&&!u.querySelector("#asri-enhance-moreanimations")){let f=document.createElement("button");f.className="b3-menu__item",f.id="asri-enhance-moreanimations",f.innerHTML=`${N}<span class="b3-menu__label">${((V=n.i18n)==null?void 0:V.moreAnimations)||"moreAnimations"}</span>`,u.appendChild(f)}let Ge=u==null?void 0:u.querySelector("#asri-enhance-moreanimations");if(Ge&&(Ge.onclick=f=>yi(n,f)),u&&!u.querySelector("#asri-enhance-global-frosted-glass")){let f=document.createElement("button");f.className="b3-menu__item",f.id="asri-enhance-global-frosted-glass",f.innerHTML=`${N}<span class="b3-menu__label">${((Z=n.i18n)==null?void 0:Z.globalFrostedGlass)||"globalFrostedGlass"}</span>`,u.appendChild(f)}let Ke=u==null?void 0:u.querySelector("#asri-enhance-global-frosted-glass");if(Ke&&(Ke.onclick=f=>ui(n,f)),u){let f=document.createElement("button");f.className="b3-menu__separator",u.appendChild(f)}if(u&&!u.querySelector("#asri-enhance-hide-tab-breadcrumb")){let f=document.createElement("button");f.className="b3-menu__item",f.id="asri-enhance-hide-tab-breadcrumb",f.innerHTML=`${N}<span class="b3-menu__label">${((Y=n.i18n)==null?void 0:Y.hideTabBreadcrumb)||"hideTabBreadcrumb"}</span>`,u.appendChild(f)}let je=u==null?void 0:u.querySelector("#asri-enhance-hide-tab-breadcrumb");je&&(je.onclick=f=>gi(n,f))}let Ia=ae.querySelector("#asri-enhance-texture");if(Ia){let u=Ia.querySelector(".b3-menu__submenu .b3-menu__items");if(u&&!u.querySelector("#asri-enhance-paper")){let g=document.createElement("button");g.className="b3-menu__item",g.id="asri-enhance-paper",g.innerHTML=`${N}<span class="b3-menu__label">${((U=n.i18n)==null?void 0:U.paper)||"paper"}</span>`,u.appendChild(g)}if(u&&!u.querySelector("#asri-enhance-noise")){let g=document.createElement("button");g.className="b3-menu__item",g.id="asri-enhance-noise",g.innerHTML=`${N}<span class="b3-menu__label">${((J=n.i18n)==null?void 0:J.noise)||"noise"}</span>`,u.appendChild(g)}if(u&&!u.querySelector("#asri-enhance-acrylic")){let g=document.createElement("button");g.className="b3-menu__item",g.id="asri-enhance-acrylic",g.innerHTML=`${N}<span class="b3-menu__label">${((te=n.i18n)==null?void 0:te.acrylic)||"acrylic"}</span>`,u.appendChild(g)}if(u&&!u.querySelector("#asri-enhance-checkerboard")){let g=document.createElement("button");g.className="b3-menu__item",g.id="asri-enhance-checkerboard",g.innerHTML=`${N}<span class="b3-menu__label">${((ne=n.i18n)==null?void 0:ne.checkerboard)||"checkerboard"}</span>`,u.appendChild(g)}if(u&&!u.querySelector("#asri-enhance-grid")){let g=document.createElement("button");g.className="b3-menu__item",g.id="asri-enhance-grid",g.innerHTML=`${N}<span class="b3-menu__label">${((ue=n.i18n)==null?void 0:ue.grid)||"grid"}</span>`,u.appendChild(g)}if(u&&!u.querySelector("#asri-enhance-polkadot")){let g=document.createElement("button");g.className="b3-menu__item",g.id="asri-enhance-polkadot",g.innerHTML=`${N}<span class="b3-menu__label">${((W=n.i18n)==null?void 0:W.polkadot)||"polkadot"}</span>`,u.appendChild(g)}if(u&&!u.querySelector("#asri-enhance-crossdot")){let g=document.createElement("button");g.className="b3-menu__item",g.id="asri-enhance-crossdot",g.innerHTML=`${N}<span class="b3-menu__label">${((Q=n.i18n)==null?void 0:Q.crossdot)||"crossdot"}</span>`,u.appendChild(g)}if(u&&!u.querySelector("#asri-enhance-honeycomb")){let g=document.createElement("button");g.className="b3-menu__item",g.id="asri-enhance-honeycomb",g.innerHTML=`${N}<span class="b3-menu__label">${((we=n.i18n)==null?void 0:we.honeycomb)||"honeycomb"}</span>`,u.appendChild(g)}if(u&&!u.querySelector("#asri-enhance-wood")){let g=document.createElement("button");g.className="b3-menu__item",g.id="asri-enhance-wood",g.innerHTML=`${N}<span class="b3-menu__label">${((de=n.i18n)==null?void 0:de.wood)||"wood"}</span>`,u.appendChild(g)}if(u&&!u.querySelector("#asri-enhance-camouflage")){let g=document.createElement("button");g.className="b3-menu__item",g.id="asri-enhance-camouflage",g.innerHTML=`${N}<span class="b3-menu__label">${((P=n.i18n)==null?void 0:P.camouflage)||"camouflage"}</span>`,u.appendChild(g)}if(u&&!u.querySelector("#asri-enhance-fiber")){let g=document.createElement("button");g.className="b3-menu__item",g.id="asri-enhance-fiber",g.innerHTML=`${N}<span class="b3-menu__label">${((pe=n.i18n)==null?void 0:pe.fiber)||"fiber"}</span>`,u.appendChild(g)}if(u&&!u.querySelector("#asri-enhance-fabric")){let g=document.createElement("button");g.className="b3-menu__item",g.id="asri-enhance-fabric",g.innerHTML=`${N}<span class="b3-menu__label">${((le=n.i18n)==null?void 0:le.fabric)||"fabric"}</span>`,u.appendChild(g)}let Ne=u==null?void 0:u.querySelector("#asri-enhance-paper");Ne&&(Ne.onclick=g=>Ni(n,g));let xe=u==null?void 0:u.querySelector("#asri-enhance-noise");xe&&(xe.onclick=g=>Di(n,g));let Fe=u==null?void 0:u.querySelector("#asri-enhance-acrylic");Fe&&(Fe.onclick=g=>zi(n,g));let Oe=u==null?void 0:u.querySelector("#asri-enhance-checkerboard");Oe&&(Oe.onclick=g=>ji(n,g));let De=u==null?void 0:u.querySelector("#asri-enhance-grid");De&&(De.onclick=g=>Ui(n,g));let Be=u==null?void 0:u.querySelector("#asri-enhance-polkadot");Be&&(Be.onclick=g=>Zi(n,g));let qe=u==null?void 0:u.querySelector("#asri-enhance-crossdot");qe&&(qe.onclick=g=>eo(n,g));let ze=u==null?void 0:u.querySelector("#asri-enhance-honeycomb");ze&&(ze.onclick=g=>ao(n,g));let Ge=u==null?void 0:u.querySelector("#asri-enhance-wood");Ge&&(Ge.onclick=g=>oo(n,g));let Ke=u==null?void 0:u.querySelector("#asri-enhance-camouflage");Ke&&(Ke.onclick=g=>co(n,g));let je=u==null?void 0:u.querySelector("#asri-enhance-fiber");je&&(je.onclick=g=>ho(n,g));let f=u==null?void 0:u.querySelector("#asri-enhance-fabric");f&&(f.onclick=g=>go(n,g))}}return}_+1<s&&m(()=>p(_+1),l)};p(),t=void 0},e)},b=()=>{let T=document.querySelector("#barMode");if(T){r=T,T.addEventListener("click",k,!0),a=void 0;return}i+=1,i<s?a=window.setTimeout(b,l):a=void 0};return b(),()=>{a!==void 0&&(window.clearTimeout(a),a=void 0),c(),r&&(r.removeEventListener("click",k,!0),r=null),t!==void 0&&(window.clearTimeout(t),t=void 0)}}var wa=!1,he=null,Ea=0,se=null,Ie=null,Re=null,$e=null;function xa(){return document.querySelector(".protyle-hint.hint--menu:not(.fn__none)")}function Ee(){if(wa=!1,se=null,he!==null&&(clearInterval(he),he=null),Ie){try{Ie.disconnect()}catch(n){}Ie=null}if(Re){try{Re.disconnect()}catch(n){}Re=null}}function Ta(n){return!!(n&&document.body.contains(n)&&!n.classList.contains("fn__none"))}function Ca(){if(se){if(!Ie){Ie=new MutationObserver(()=>{Ta(se)||Ee()});try{Ie.observe(se,{attributes:!0,attributeFilter:["class","style"]})}catch(n){}}if(!Re){Re=new MutationObserver(()=>{Ta(se)||Ee()});try{Re.observe(document.body,{childList:!0,subtree:!0})}catch(n){}}}}function Bs(){let n=xa();return n?(se=n,Ca(),!0):(Ea=0,he=setInterval(()=>{Ea+=1;let e=xa();e?(se=e,clearInterval(he),he=null,Ca()):Ea>=10&&(clearInterval(he),he=null,Ee())},100),!1)}function qs(n){return n?Array.from(n.querySelectorAll(".b3-list-item")):[]}function wo(n){return n?n.querySelector(".b3-list-item--focus"):null}function zs(n){return n.map(e=>{let t=e.getBoundingClientRect();return{el:e,x:t.left+t.width/2,y:t.top+t.height/2}})}function Gs(n,e,t){if(!e||n.length===0)return null;let a=e.getBoundingClientRect(),r={x:a.left+a.width/2,y:a.top+a.height/2,el:e},i=zs(n),o=Math.max(a.width/2,10),s;switch(t){case"ArrowUp":s=b=>b.y<r.y-1&&Math.abs(b.x-r.x)<=o;break;case"ArrowDown":s=b=>b.y>r.y+1&&Math.abs(b.x-r.x)<=o;break;case"ArrowLeft":s=b=>b.x<r.x-1;break;case"ArrowRight":s=b=>b.x>r.x+1;break;default:return null}let l=i.filter(b=>b.el!==e&&s(b));if(l.length===0)return null;let c=(b,T)=>{let p=b.x-T.x,_=b.y-T.y;return p*p+_*_},m=l[0],k=c(m,r);for(let b=1;b<l.length;b++){let T=c(l[b],r);T<k&&(m=l[b],k=T)}return m.el}function ko(n){if(!se||!n)return;let e=wo(se);if(e!==n){e&&e.classList.remove("b3-list-item--focus"),n.classList.add("b3-list-item--focus");try{n.scrollIntoView({block:"nearest",inline:"nearest"})}catch(t){}}}function Ks(n,e){var a,r;let t=n.indexOf(e);return t===-1?(a=n[0])!=null?a:null:t+1<n.length?n[t+1]:(r=n[0])!=null?r:null}function js(n,e){var a,r;let t=n.indexOf(e);return t===-1?(a=n[n.length-1])!=null?a:null:t-1>=0?n[t-1]:(r=n[n.length-1])!=null?r:null}function Eo(n,e){let t=e.getBoundingClientRect(),a=t.top+t.height/2,r=[];for(let i of n){if(i===e)continue;let o=i.getBoundingClientRect(),s=o.top+o.height/2,l=Math.min(t.height,o.height)/2;Math.abs(s-a)<=l&&r.push(i)}return r}function Vs(n){return n.map(e=>({el:e,x:e.getBoundingClientRect().left})).sort((e,t)=>e.x-t.x).map(e=>e.el)}function Ws(n){return n.map(e=>({el:e,x:e.getBoundingClientRect().left})).sort((e,t)=>t.x-e.x).map(e=>e.el)}var Us=n=>{var l,c;if(n.key==="/"){Ee(),wa=!0,Bs();return}if(!wa)return;if(n.key==="Escape"){Ee();return}if(!["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(n.key))return;let t=se||xa();if(!t||!Ta(t)){Ee();return}n.preventDefault(),n.stopPropagation(),se=t,Ca();let a=qs(t);if(a.length===0)return;let r=wo(t);r||(r=a[0],r.classList.add("b3-list-item--focus"));let i=Gs(a,r,n.key);if(i){ko(i);return}let o=null,s=n.key;if(s==="ArrowDown")o=Ks(a,r);else if(s==="ArrowUp")o=js(a,r);else if(s==="ArrowRight"){let m=Eo(a,r);m.length>0&&(o=(l=Vs(m)[0])!=null?l:null)}else if(s==="ArrowLeft"){let m=Eo(a,r);m.length>0&&(o=(c=Ws(m)[0])!=null?c:null)}o&&o!==r&&ko(o)};function xo(){typeof document!="undefined"&&($e||($e=Us,document.addEventListener("keydown",$e,{capture:!0})))}function To(){typeof document!="undefined"&&($e&&(document.removeEventListener("keydown",$e,{capture:!0}),$e=null),Ee())}var _a=class extends Co.Plugin{constructor(){super(...arguments);this.unsubscribeBarModeClick=null;this.unsubscribeTopbarFusionPlus=null;this.asriConfigClickHandler=null;this.themeModeObserver=null;this.themeModeChangeTimers=[];this.paletteDisableMouseUpHandler=null;this.paletteDisableDebounceTimer=null}async applyAllConfigs(t){await Promise.all([za(this,t).catch(()=>{}),ja(this,t).catch(()=>{}),Ua(this,t).catch(()=>{}),Za(this,t).catch(()=>{}),er(this,t).catch(()=>{}),ar(this,t).catch(()=>{}),or(this,t).catch(()=>{}),cr(this,t).catch(()=>{}),hr(this,t).catch(()=>{}),fr(this,t).catch(()=>{}),yr(this,t).catch(()=>{}),Er(this,t).catch(()=>{}),xr(this,t).catch(()=>{}),Ar(this,t).catch(()=>{}),Cr(this,t).catch(()=>{}),Sr(this,t).catch(()=>{}),qr(this,t).catch(()=>{}),ci(this,t).catch(()=>{}),mi(this,t).catch(()=>{}),di(this,t).catch(()=>{}),fi(this,t).catch(()=>{}),bi(this,t).catch(()=>{}),vi(this,t).catch(()=>{}),Ei(this,t).catch(()=>{}),Ti(this,t).catch(()=>{}),Ai(this,t).catch(()=>{}),Si(this,t).catch(()=>{}),Ri(this,t).catch(()=>{}),Fi(this,t).catch(()=>{}),Bi(this,t).catch(()=>{}),Gi(this,t).catch(()=>{}),Vi(this,t).catch(()=>{}),Yi(this,t).catch(()=>{}),Qi(this,t).catch(()=>{}),to(this,t).catch(()=>{}),ro(this,t).catch(()=>{}),so(this,t).catch(()=>{}),uo(this,t).catch(()=>{}),po(this,t).catch(()=>{}),bo(this,t).catch(()=>{}),Da(this,t).catch(()=>{})])}async onload(){this.unsubscribeBarModeClick=yo(this,()=>{}),this.unsubscribeTopbarFusionPlus=vo(this),this.asriConfigClickHandler=r=>{queueMicrotask(()=>{let i=r.target;if(!i||i.closest("#asri-enhance-amber")||i.closest("#asri-enhance-sakura")||i.closest("#asri-enhance-wilderness")||i.closest("#asri-enhance-midnight")||i.closest("#asri-enhance-salt")||i.closest("#asri-enhance-rosepine")||i.closest("#asri-enhance-topaz")||i.closest("#asri-enhance-oxygen")||i.closest("#asri-enhance-shade")||i.closest("#asri-enhance-gruvbox")||i.closest("#asri-enhance-glitch")||i.closest("#asri-enhance-nostalgia"))return;let o=i.closest(".asri-config");o&&o.id!=="topbarFusionPlus"&&o.id!=="asriChroma"&&(Yt.forEach(s=>{Ra(this,s,"config.json").catch(()=>{})}),Je(this,"config.json").catch(()=>{}))})},document.addEventListener("click",this.asriConfigClickHandler,!0),this.paletteDisableMouseUpHandler=r=>{queueMicrotask(()=>{var s,l;let i=r.target;if(!i)return;if(((s=i.id)==null?void 0:s.startsWith("prst-palette"))||i.closest("[id^='prst-palette']")!==null||i.id==="pickColor"||i.closest("#pickColor")!==null||i.id==="followSysAccent"||i.closest("#followSysAccent")!==null||i.id==="followCoverImgColor"||i.closest("#followCoverImgColor")!==null){this.paletteDisableDebounceTimer!==null&&clearTimeout(this.paletteDisableDebounceTimer);let c=null;if((l=i.id)!=null&&l.startsWith("prst-palette"))c=i.id.replace("prst-palette-","");else{let m=i.closest("[id^='prst-palette']");m&&(c=m.id.replace("prst-palette-",""))}this.paletteDisableDebounceTimer=window.setTimeout(()=>{Na(this,"config.json").then(()=>{Je(this,"config.json").then(()=>{if(c){let m=document.documentElement;m&&m.getAttribute("data-asri-palette")!==c&&m.setAttribute("data-asri-palette",c)}d(this,"config.json").then(m=>{this.applyAllConfigs(m).catch(()=>{})}).catch(()=>{})}).catch(()=>{})}).catch(()=>{}),this.paletteDisableDebounceTimer=null},200)}})},document.addEventListener("mouseup",this.paletteDisableMouseUpHandler,!1);let t=await d(this,"config.json"),a=document.documentElement;a&&(this.themeModeObserver=new MutationObserver(r=>{queueMicrotask(()=>{for(let i of r)if(i.type==="attributes"&&i.attributeName==="data-theme-mode"){this.themeModeChangeTimers.forEach(l=>{clearTimeout(l)}),this.themeModeChangeTimers=[],d(this,"config.json").then(l=>{this.applyAllConfigs(l).catch(()=>{})}).catch(()=>{});let o=window.setTimeout(()=>{d(this,"config.json").then(l=>{this.applyAllConfigs(l).catch(()=>{})}).catch(()=>{})},100);this.themeModeChangeTimers.push(o);let s=window.setTimeout(()=>{d(this,"config.json").then(l=>{this.applyAllConfigs(l).catch(()=>{})}).catch(()=>{})},500);this.themeModeChangeTimers.push(s)}})}),this.themeModeObserver.observe(a,{attributes:!0,attributeFilter:["data-theme-mode"]})),await this.applyAllConfigs(t),xo(),setTimeout(()=>{this.applyAllConfigs(t).catch(()=>{})},100),setTimeout(()=>{this.applyAllConfigs(t).catch(()=>{})},500)}onunload(){this.unsubscribeBarModeClick&&(this.unsubscribeBarModeClick(),this.unsubscribeBarModeClick=null),this.unsubscribeTopbarFusionPlus&&(this.unsubscribeTopbarFusionPlus(),this.unsubscribeTopbarFusionPlus=null),this.asriConfigClickHandler&&(document.removeEventListener("click",this.asriConfigClickHandler,!0),this.asriConfigClickHandler=null),this.themeModeObserver&&(this.themeModeObserver.disconnect(),this.themeModeObserver=null),this.themeModeChangeTimers.forEach(t=>{clearTimeout(t)}),this.themeModeChangeTimers=[],this.paletteDisableMouseUpHandler&&(document.removeEventListener("mouseup",this.paletteDisableMouseUpHandler,!0),this.paletteDisableMouseUpHandler=null),this.paletteDisableDebounceTimer!==null&&(clearTimeout(this.paletteDisableDebounceTimer),this.paletteDisableDebounceTimer=null),Hr(),To(),$t(),Kt(),jt()}async uninstall(){this.onunload(),await $a(this,"config.json").catch(()=>{})}};module.exports=_a;
